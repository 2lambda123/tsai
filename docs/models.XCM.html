---

title: XCM: An Explainable Convolutional Neural Network for Multivariate Time Series Classification


keywords: fastai
sidebar: home_sidebar

summary: "This is an unofficial PyTorch implementation by Ignacio Oguiza of  - oguiza@gmail.com based on Temporal Convolutional Network (Bai, 2018)."
description: "This is an unofficial PyTorch implementation by Ignacio Oguiza of  - oguiza@gmail.com based on Temporal Convolutional Network (Bai, 2018)."
nb_path: "nbs/114_models.XCM.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/114_models.XCM.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>References:</strong></p>
<ul>
<li>Fauvel, K., Lin, T., Masson, V., Fromont, Ã‰., &amp; Termier, A. (2020). XCM: An Explainable Convolutional Neural Network for Multivariate Time Series Classification. arXiv preprint arXiv:2009.04796.</li>
<li>Official XCM PyTorch implementation: not available as of Nov 27th, 2020</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="XCM" class="doc_header"><code>class</code> <code>XCM</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/XCM.py#L19" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>XCM</code>(<strong><code>c_in</code></strong>:<code>int</code>, <strong><code>c_out</code></strong>:<code>int</code>, <strong><code>seq_len</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>, <strong><code>nf</code></strong>:<code>int</code>=<em><code>128</code></em>, <strong><code>window_perc</code></strong>:<code>float</code>=<em><code>1.0</code></em>, <strong><code>flatten</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>custom_head</code></strong>:<code>callable</code>=<em><code>None</code></em>, <strong><code>concat_pool</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>fc_dropout</code></strong>:<code>float</code>=<em><code>0.0</code></em>, <strong><code>bn</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>y_range</code></strong>:<code>tuple</code>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.data.all</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">dsid</span> <span class="o">=</span> <span class="s1">&#39;NATOPS&#39;</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span> <span class="o">=</span> <span class="n">get_UCR_data</span><span class="p">(</span><span class="n">dsid</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">()]</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">get_ts_dls</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">,</span> <span class="n">tfms</span><span class="o">=</span><span class="n">tfms</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span>  <span class="n">XCM</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">vars</span><span class="p">,</span> <span class="n">dls</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="n">dls</span><span class="o">.</span><span class="n">len</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>

<span class="n">bs</span><span class="p">,</span> <span class="n">c_in</span><span class="p">,</span> <span class="n">seq_len</span> <span class="o">=</span> <span class="n">xb</span><span class="o">.</span><span class="n">shape</span>
<span class="n">c_out</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">yb</span><span class="p">))</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">XCM</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">fc_dropout</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">c_out</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">XCM</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">concat_pool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">c_out</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">XCM</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">c_out</span><span class="p">))</span>
<span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>XCM(
  (conv2dblock): Sequential(
    (0): Unsqueeze(dim=1)
    (1): Conv2dSame(
      (conv2d_same): Conv2d(1, 128, kernel_size=(1, 51), stride=(1, 1))
    )
    (2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): ReLU()
  )
  (conv2d1x1block): Sequential(
    (0): Conv2d(128, 1, kernel_size=(1, 1), stride=(1, 1))
    (1): ReLU()
    (2): Squeeze(dim=1)
  )
  (conv1dblock): Sequential(
    (0): Conv1d(24, 128, kernel_size=(51,), stride=(1,), padding=(25,))
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
  )
  (conv1d1x1block): Sequential(
    (0): Conv1d(128, 1, kernel_size=(1,), stride=(1,))
    (1): ReLU()
  )
  (concat): Concat(dim=1)
  (conv1d): Sequential(
    (0): Conv1d(25, 128, kernel_size=(51,), stride=(1,), padding=(25,))
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
  )
  (head): Sequential(
    (0): GAP1d(
      (gap): AdaptiveAvgPool1d(output_size=1)
      (flatten): Flatten(full=False)
    )
    (1): LinBnDrop(
      (0): Linear(in_features=128, out_features=6, bias=True)
    )
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">show_gradcam</span><span class="p">(</span><span class="n">xb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yb</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">seq_len</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">c_out</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)</span>
<span class="n">new_head</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">conv_lin_3d_head</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">XCM</span><span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">custom_head</span><span class="o">=</span><span class="n">new_head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">head</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>torch.Size([16, 2, 5])
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>create_conv_lin_3d_head(
  (0): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (1): Conv1d(128, 2, kernel_size=(1,), stride=(1,), bias=False)
  (2): Transpose(-1, -2)
  (3): BatchNorm1d(12, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (4): Transpose(-1, -2)
  (5): Linear(in_features=12, out_features=5, bias=False)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">seq_len</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">c_out</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">XCM</span><span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)</span>
<span class="n">change_model_head</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">create_pool_plus_head</span><span class="p">,</span> <span class="n">concat_pool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">head</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>torch.Size([16, 2])
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Sequential(
  (0): AdaptiveAvgPool1d(output_size=1)
  (1): Flatten(full=False)
  (2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (3): Linear(in_features=128, out_features=512, bias=False)
  (4): ReLU(inplace=True)
  (5): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (6): Linear(in_features=512, out_features=2, bias=False)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

