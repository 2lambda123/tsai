---

title: Metadatasets: a dataset of datasets


keywords: fastai
sidebar: home_sidebar

summary: "This functionality will allow you to create a dataset from data stores in multiple, smaller datasets."
description: "This functionality will allow you to create a dataset from data stores in multiple, smaller datasets."
nb_path: "nbs/002c_data.metadatasets.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/002c_data.metadatasets.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>I'd like to thank both Thomas Capelle (<a href="https://github.com/tcapelle">https://github.com/tcapelle</a>)  and Xander Dunn (<a href="https://github.com/xanderdunn">https://github.com/xanderdunn</a>) for their contributions to make this code possible. </li>
<li>This functionality allows you to use multiple numpy arrays instead of a single one, which may be very useful in many practical settings. I've tested it with 10k+ datasets and it works well. </li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TSMetaDataset" class="doc_header"><code>class</code> <code>TSMetaDataset</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/metadatasets.py#L12" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TSMetaDataset</code>(<strong><code>dataset_list</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>A dataset capable of indexing mutiple datasets at the same time</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TSMetaDatasets" class="doc_header"><code>class</code> <code>TSMetaDatasets</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/metadatasets.py#L62" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TSMetaDatasets</code>(<strong><code>metadataset</code></strong>, <strong><code>splits</code></strong>) :: <code>FilteredBase</code></p>
</blockquote>
<p>Base class for lists with subsets</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's create 3 datasets. In this case they will have different sizes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">,))</span>
    <span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">TSClassification</span><span class="p">(</span><span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="n">TSDatasets</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tfms</span><span class="o">=</span><span class="n">tfms</span><span class="p">)</span>
    <span class="n">dsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dset</span><span class="p">)</span>
<span class="n">dsets</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(#131) [(TSTensor(vars:5, len:50), TensorCategory(1)),(TSTensor(vars:5, len:50), TensorCategory(8)),(TSTensor(vars:5, len:50), TensorCategory(8)),(TSTensor(vars:5, len:50), TensorCategory(5)),(TSTensor(vars:5, len:50), TensorCategory(1)),(TSTensor(vars:5, len:50), TensorCategory(7)),(TSTensor(vars:5, len:50), TensorCategory(9)),(TSTensor(vars:5, len:50), TensorCategory(2)),(TSTensor(vars:5, len:50), TensorCategory(2)),(TSTensor(vars:5, len:50), TensorCategory(7))...],
 (#61) [(TSTensor(vars:5, len:50), TensorCategory(5)),(TSTensor(vars:5, len:50), TensorCategory(9)),(TSTensor(vars:5, len:50), TensorCategory(3)),(TSTensor(vars:5, len:50), TensorCategory(7)),(TSTensor(vars:5, len:50), TensorCategory(7)),(TSTensor(vars:5, len:50), TensorCategory(1)),(TSTensor(vars:5, len:50), TensorCategory(6)),(TSTensor(vars:5, len:50), TensorCategory(8)),(TSTensor(vars:5, len:50), TensorCategory(9)),(TSTensor(vars:5, len:50), TensorCategory(6))...],
 (#81) [(TSTensor(vars:5, len:50), TensorCategory(9)),(TSTensor(vars:5, len:50), TensorCategory(6)),(TSTensor(vars:5, len:50), TensorCategory(7)),(TSTensor(vars:5, len:50), TensorCategory(9)),(TSTensor(vars:5, len:50), TensorCategory(2)),(TSTensor(vars:5, len:50), TensorCategory(8)),(TSTensor(vars:5, len:50), TensorCategory(10)),(TSTensor(vars:5, len:50), TensorCategory(2)),(TSTensor(vars:5, len:50), TensorCategory(4)),(TSTensor(vars:5, len:50), TensorCategory(6))...]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metadataset</span> <span class="o">=</span> <span class="n">TSMetaDataset</span><span class="p">(</span><span class="n">dsets</span><span class="p">)</span>
<span class="n">metadataset</span><span class="p">,</span> <span class="n">metadataset</span><span class="o">.</span><span class="n">vars</span><span class="p">,</span> <span class="n">metadataset</span><span class="o">.</span><span class="n">len</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;__main__.TSMetaDataset at 0x7ff61aa4a210&gt;, 5, 50)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll apply splits now to create train and valid metadatasets:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">TimeSplitter</span><span class="p">()(</span><span class="n">metadataset</span><span class="p">)</span>
<span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABBwAAABTCAYAAAA82hSvAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8vihELAAAACXBIWXMAAAsTAAALEwEAmpwYAAAUV0lEQVR4nO3da1CU5/nH8R/sghyjHAwoGA8gRiDEghopAWqtlRg0yRj/0U6sONNxtO2LBJ06DnVqMyFNdGpTMzak05k2NdPxULU2BKIZa22ihhgxGjVEVOQMAkoAF5CF/b/IsBOERcQ9qd/PK/bZZ+/r2vXyZrj2fu7HIyoqyiIAAAAAAAA78nR1AgAAAAAA4P5DwwEAAAAAANgdDQcAAAAAAGB3NBwAAAAAAIDd0XAAAAAAAAB2R8MBAAAAAADYHQ0HAIBb8vDwUHp6ujZs2KA//vGPeu2115SVlaWHH354yGNkZmYqJydHkpScnKwtW7YMO5/k5GTl5uZKkmJiYpSXlydfX99hj/ddeXl5evzxxyVJubm5Sk5Otsu4veP98Ic/tNt4AAAAQ2V0dQIAAAzkRz/6kebMmaNdu3appqZGo0aN0rx587Ru3Tr99re/VUtLyx2NV1xcrJKSEuvjvLw8vf322zp9+vQd53b58mXl5OSoo6PjtucuX75cvr6+ysvLs3lOTk7OHb+focbbvHnzkPIEAACwN1Y4AADcUlpamj744AMVFxerrq5OJSUl2rZtmywWixITE+94vM7OTl2/ft0uuZnNZjU1NclisdzVOJ6e3/4abmpqUldXlz1S66e5uZmGAwAAcAlWOAAA3JKfn59CQkL6HDObzXrrrbd048YNSd9+m280GnX9+nWlpKSos7NTR44c0YEDB/qNl5ycrMWLFys7O9v67f/q1auVn5+v/Pz8fudPmTJFL7zwgkaPHq2KigpduHDB+lxMTIyys7P18ssvq729XTNmzND8+fMVGhqq5uZmFRYW6tixY1q+fLn18ojc3Fzl5OQoOztbFRUVCg4OVkxMjNauXdtvtUVoaKhefvllTZw4UQ0NDdq/f7/OnDljHefQoUP6z3/+I0kKCQlRbm6uXn31Vc2ZM6dfvO+e7+HhoczMTKWkpGjEiBEqLy/Xnj17VFlZKUnKzs7WlStX5Ofnp6SkJHV3d+vQoUMqLCwc/j8kAAB4YLHCAQDglj7//HNlZGRozZo1ysjIUHR0tIxGo8rLy9XY2Gg973vf+568vb21efNm7d27V0899ZSefPLJQcfu3dfhvffe06FDh/o9HxgYqNWrV+vChQt6/fXXdfz4cc2ZM2fAscaMGaOsrCwVFhbq1Vdf1UcffaQXX3xR48aN0z//+U8VFxfr/Pnz2rx5s/U16enpqqio6HPsu+bOnavi4mK98cYbOnfunFatWqWxY8fe9jOzFa/X/PnzlZqaqh07dmjTpk0qKyvTmjVrFBQUZD1n9uzZam5u1qZNm3T48GE988wzCg8Pv21sAACAW7HCAQDglnbu3Km6ujpNnz5dCxYskMFgUEdHh44fP67du3erp6dHktTS0qKdO3fKYrGorq5OEydOVHp6uj755BObYzc1NUmSWltb1d7e3u/51NRUXb9+XTt27JAkVVdXKzIyUo899li/c3s3sbxy5YquXr2q+vp6mUwm3bx5Uzdu3FBnZ6c8PT3V3Nxsfc3Fixf14Ycf2szvk08+0ZEjRyRJe/fuVWxsrJ588knt2rVr0M/MVjxJMhqNmjt3rnbu3KkvvvhCkrR//35NmTJFs2fP1t69e63vo3fFR0FBgTIyMhQREaG6urpBYwMAANyKhgMAwC319PTo8OHDOnz4sLy8vDRp0iTNnDlT6enpam1tVUFBgSSpoqKiz14KVVVVSklJuavYkZGRunz5cp9j5eXlAzYcSkpKdPHiRW3YsEGlpaW6cOGCTp06pfr6epvj19bWDhr/ypUr/R6HhoYO/Q0MIDQ0VD4+Pn0uDZG+/bzCwsL6PO5lsVjU1dUlb2/vu4oNAAAeTDQcAABuZ9KkSUpLS9Pf/vY3SVJXV5e+/vprff311zIYDHr00UetDYeB3O1mjgaDod+x3g0eb9XZ2ak//OEPGjdunKZOnarY2FgtXLhQf/7zn60rCe40v1ufNxgMunnz5oDnGo1D+1Xu5eUlSeru7u5z3Nvbu8/YvStHAAAA7hZ7OAAA3I7ZbNasWbMG3Lfg5s2bff5AjoiI6PP8pEmTbruC4HZqa2s1ceLEfuMOJCkpSRkZGaqsrNTBgwf15ptv6ty5c5o2bdqw40+YMKHf4+rqaknffja9zQNJQ95foaGhQd3d3f3eV3R0dJ9VDQAAAPZCwwEA4HYqKir05ZdfatWqVUpMTFRYWJiio6OVmZmp5ORk/e9//7OeGxISoueee05jxoxRamqqZs2aZd3/YDBdXV2KiIiQn59fv+eOHDmi0NBQLV68WBEREUpNTbXZQDCZTHr66aeVkpKi8PBwJSQkaMKECSorK7PGCQoKuqNLIr7//e/riSee0NixY7Vo0SIFBQXp448/lvRtMyQhIUHe3t4KCAjQvHnz+r2vgeJ1dHTo6NGjev755xUfH69x48bpJz/5iXx9fa1jAwAA2BOXVAAA3NI777yjOXPm6Omnn1ZoaKg6OjpUVlamrVu3qrS01Hre+fPn5e/vr3Xr1slkMmnfvn0qKiq67fjHjh3TU089JbPZrIMHD/Z57vr163r77bf1wgsvKC0tTaWlpfrXv/6ljIyMfuN89dVX2rdvn+bNm6dRo0aptbVVR44csTZFTp48qcTERP385z/XK6+8MqT3XlBQoLS0ND3yyCOqr6/Xtm3b1NbWJunbTSRXrFihzZs369q1ayosLOyz+mKweLt375YkrVixQl5eXiovL9fWrVtlMpmGlBcAAMCd8IiKirq7C10BAHCR5cuXy9fXV3l5ea5OBQAAALfgkgoAAAAAAGB3NBwAAAAAAIDdcUkFAAAAAACwO1Y4AAAAAAAAu3PaXSp8fHwUGRmp1tZWdXd3OyssAAAAAMAJDAaDAgMDVVVVpY6ODlenAzfgtIZDZGSkZs+e7axwAAAAAAAXOHz4sC5evOjqNOAGnNZwaG1tlSTt2JGphoYQZ4UFAAAA3Nqj773o6hQAuwi8EahZZ2dZ//YDnNZw6L2MoqEhRNXV4c4KCwAAALi1sIeuuzoFwK64hB692DQSAAAAAADYHQ0HAAAAAABgd067pAIAAAAAgHuJ0WiUr6+vq9NwS+3t7TKbzYOewwoHAAAAAABuERkZqZAQbnhgS0hIiCIjIwc9hxUOAAAAAAB8h9FoVFdXl+rr612dittqbW1VeHi4jEajzZUOrHAAAAAAAOA7fH19ZTKZXJ2G2zOZTINecjLkhkNWVpZSUlLskhQAAAAAALi3WSyWQZ+/7SUVcXFxiouL08yZM1VaWmq3xAAAAAAAwP3rtg2H8ePHy2g0qqWlxRn5AAAAAADgli5duujwGFFR0Q6P4Sy3bTgUFBRIksLDwx2eDAAAAAAAGJqXXnpJkydPliQZDAb19PRYL3P49NNPtX379iGNM3nyZGVlZSknJ8eu+TnkLhWZmZnKzMzsc+zGjRsqKSlxRDgAAAAAAB44b775pvXn7OxsXbhwQfn5+f3O8/T0VE9Pj81xSktL7d5skBzUcMjPz+/3JkNDQ/Xcc885IhwAAAAAAPiO5ORkzZo1S83NzRo/frw2btyo6dOna+HChRo1apSampq0f/9+ffHFF4qJidGKFSu0fv16ZWZmKiwsTB4eHpo6dapMJpP++te/6vLly3ecA7fFBAAAAADgPjR58mSVlJTolVdekZeXl37605/q3Xff1UsvvaSDBw9q2bJlA74uMTFRn332mdatW6eSkhItXLhwWPFpOAAAAAAAcB+qr6/X8ePHrXs7bN68WZcuXVJAQIA8PDzk7+8vT8/+bYGSkhKdOXNGZrNZp06dUnBw8LDiO+SSCgAAAAAA4Fo3btyw/myxWJSenq74+Hhdu3ZN9fX1Nl/X1tZm/bmnp0cGg2FY8YfccNiyZcuwAgAAAAAAANd64okn9Mgjj+jXv/61zGazIiMjlZyc7NCYrHAAAAAAAOA+ZzAY5OnpKS8vL40aNUoLFiyQJBmNjmsL0HAAAAAAAGAIoqKiXZ3CsH366aeKj4/XG2+8oYaGBu3du1cjR47UypUrdfDgQYfE9IiKirI4ZORb9N4W8623lqu6OtwZIQEAAAC3l3gyydUpAHYR1BKkuUVztW/fPjU2Nro6nbsSGBgoSWptbXVxJu7tdp8Td6kAAAAAAAB2R8MBAAAAAADYHQ0HAAAAAABgdzQcAAAAAACA3TntLhUGg0GSNHp0k7NCAgAAAG4vqCXI1SkAdhF449sNBHv/9gOc1nDo3b1yyZJ8Z4UEAAAA3F/RXFdnANhVYGCg6uvrXZ0G3IDTGg5VVVWaMGGCtm7dqu7ubmeFBWxav369fve737k6DYBahFuhHuEuqEW4E+pxaAwGgwIDA1VVVeXqVOAmnNZw6OjoUEhICJ0uuA1/f/97/v7AuD9Qi3An1CPcBbUId0I9Dt39/vfeyF0jHR7jm//7xuExnIVNIwEAAAAAuAfNnz9fv/nNb/odT0pK0tatW+Xj42PztdnZ2UpJSZEkbdu2TaGhoQOel5ubq5iYmGHlR8MBAAAAAIB7UFFRkcLCwjR27Ng+x5OSknT69Gl1dHQMaZxf/OIXDlnF47RLKgAAAAAAgP00NTXp0qVLmj59uv79739Lkry9vRUfH6933nlHwcHBWrZsmSZNmqTOzk4VFxdr165d6unp6TNOXl6eNmzYoIaGBiUlJWnRokXy8/NTUVGRPDw8hp2fU1c45Odzhwq4D+oR7oJahDuhHuEuqEW4E+oR7qyoqEhJSUnWxwkJCWpvb9f58+f1zDPPqKamRmvWrNHrr7+uhIQEPfbYYzbHCgoK0rJly/SPf/xDv/rVr2QymRQcHDzs3Gg44IFFPcJdUItwJ9Qj3AW1CHdCPcKdnTx5UsHBwRo3bpwkKTExUZ999pksFos+/PBDvf/++zIYDPL395fZbFZAQIDNsWbMmKFz587p7Nmzunnzpt5//321t7cPOzcuqQAAAAAA4B7V3t6uM2fOKCkpSVevXlV8fLw2bdokSYqIiNDq1avV3d2t6urq214eERISoqamJuvjnp4etba2Djs3Gg4AAAAAANzDioqKtHjxYlVVVenq1auqqqqSl5eXli9fri1btqisrEySlJOTM+g4LS0tfTagNBqNeuihh4adF3epAAAAAADgHnb27Fn5+PgoMzNTRUVFkiRPT095enrKy8tLPj4+Sk9P19ixY2U02l53cPLkScXFxSk2Nlbe3t5auHChvL29h50XKxwAAAAAABiCb/7vG1enMKCenh59/vnnSktLszYcOjs7tXPnTq1cuVKSdOzYMe3bt0+LFi3S6dOnBxynrq5O27dv19KlSxUQEKCPP/5Y1dXVw87LIyoqyjLsVwMAAAAAcJ8JDAyUpLvav+BBcLvPySkrHKKjo7V06VKNHj1a5eXl2r59u65eveqM0IBWrVqluLg46+O2tjatX7+euoRTZWVlqbS0VEePHpU0+LxIbcKRbq1FW3OkRC3CcWJjY7Vo0SKNHj1a165d0wcffKATJ04wN8IlbNUj8yNw9xzecPDx8dGqVau0Z88enTp1SnPnztXPfvYzvfbaa44ODUiSwsLCtHHjxj67rVKXcJa4uDjFxcVp5syZKi0tlTR4/VGbcJSBalEaeI6UmCfhOP7+/lq5cqV27dqlEydO6NFHH9XKlStVU1PD3AinG6wemR+Bu+fwTSMff/xxNTY26vjx4+ro6FBBQYHCw8M1ZswYR4cGJEkjR47UtWvX+hyjLuEs48ePl9FoVEtLi/XYYPVHbcJRBqpFaeA5UmKehONMnjxZTU1NOnbsmLq6uvTll1+qpqZG06ZNY26E09mqx6lTpzI/Anbg8BUOkZGRqqiosD7u7u5WfX29Hn74YdXW1jo6PB5wQUFBslgsWrt2rcaMGaO6ujrt3r2buoTTFBQUSJLCw8OtxwarP2oTjjJQLdqaI8vKyqhFOMzFixf1l7/8xfrY399foaGhmjVrlr766ivrceZGOIOtemxtbWV+BIbAw8NDFovtbSEd3nDw9fVVW1tbn2MdHR3y8fFxdGhAAQEBqqmp0Z49e1RdXa2UlBT98pe/1OnTp/t9y0ddwlkGmxeZM+FMtubIjRs3UotwmLa2NmttRUdHa9myZaqsrFRjY6NMJlOfc5kb4Wi26rG2tpb58QHX3t6ukJAQNo28DT8/PzU2Ntp83uENB5PJ1O++nSNGjOj3CwVwhMrKSv3+97+3Pv7vf/+r1NRURUdH6+zZs33OpS7hLIPNi8yZcKbB5khqEY7k4+OjJUuWaNq0aTpw4IAOHDigZ599lrkRLjFQPfb09DA/PuDMZrO8vLwUHh4uk8k06Lf4DyIPDw/5+fnJaDTKbDbbPM/hezjU1tYqMjLS+thgMGj06NGqrKx0dGhAsbGxSkhI6HPMYDDoo48+oi7hMoPNi8yZcCZbc2RnZye1CIfx8vLS2rVr9dBDD2njxo0qLCxUT08PcyNcwlY9Mj9CkqqqqtTY2EizYQAWi0WNjY2qqqoa9DyHr3A4deqUnn/+eSUkJKikpEQLFizQlStX1Nzc7OjQgEaMGKElS5aoublZtbW1SklJkbe3t06cOKFnn32WuoRLDDYvMmfCmWzNkaWlpTIYDNQiHGLGjBkyGo3605/+1OdbMeZGuIKtemR+RC+z2cxlFXfBIyoqyuHtmilTpmjp0qUKDg7WpUuX9O677/IfEk7z4x//WD/4wQ/k6+uriooK7dixQ7W1tdQlnCo7O1tFRUU6evSopMHnRWoTjnRrLdqaIyVqEY6xZMkSpaWl9fvG8O9//7uam5uZG+FUg9XjyJEjmR+Bu+SUhgMAAAAAAHiwOHwPBwAAAAAA8OCh4QAAAAAAAOyOhgMAAAAAALA7Gg4AAAAAAMDuaDgAAAAAAAC7o+EAAAAAAADsjoYDAAAAAACwOxoOAAAAAADA7mg4AAAAAAAAu/t/WydgX2ozr30AAAAASUVORK5CYII=
"
>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#218) [0,1,2,3,4,5,6,7,8,9...],
 (#55) [218,219,220,221,222,223,224,225,226,227...])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metadatasets</span> <span class="o">=</span> <span class="n">TSMetaDatasets</span><span class="p">(</span><span class="n">metadataset</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
<span class="n">metadatasets</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">metadatasets</span><span class="o">.</span><span class="n">valid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;__main__.TSMetaDataset at 0x7ff6168b5050&gt;,
 &lt;__main__.TSMetaDataset at 0x7ff6168b54d0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">metadatasets</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">metadatasets</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TSTensor(samples:64, vars:5, len:50),
 TensorCategory([ 9, 10,  8,  1,  5,  1, 10,  3,  2,  4,  3,  7,  5,  1,  4,  5,  5,  1,
          7,  5,  8,  5,  9,  3,  6,  4,  5,  6,  4,  2,  8,  9,  9,  7,  3,  1,
          6,  3,  8,  4,  9,  1,  6,  4,  3,  6,  8,  3,  6, 10,  9,  1,  4,  6,
          6,  5,  1,  9,  5,  8,  9,  6,  5,  6]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There also en easy way to map any particular sample in a batch to the original dataset and id:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">metadatasets</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">metadatasets</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
<span class="n">mappings</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">mapping_idxs</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">xbi</span><span class="p">,</span> <span class="n">ybi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">)):</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">mappings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">test_close</span><span class="p">(</span><span class="n">dsets</span><span class="p">[</span><span class="n">ds</span><span class="p">][</span><span class="n">idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">xbi</span><span class="p">)</span>
    <span class="n">test_close</span><span class="p">(</span><span class="n">dsets</span><span class="p">[</span><span class="n">ds</span><span class="p">][</span><span class="n">idx</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">ybi</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For example the 3rd sample in this batch would be:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">mapping_idxs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([  0, 124], dtype=int32)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

