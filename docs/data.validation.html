---

title: Data Validation


keywords: fastai
sidebar: home_sidebar

summary: "Functions required to perform cross-validation."
description: "Functions required to perform cross-validation."
nb_path: "nbs/000b_data.validation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/000b_data.validation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_overlap" class="doc_header"><code>check_overlap</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/validation.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_overlap</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="leakage_finder" class="doc_header"><code>leakage_finder</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/validation.py#L24" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>leakage_finder</code>(<strong>*<code>splits</code></strong>, <strong><code>verbose</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>You can pass splits as a tuple, or train, valid, ...</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="balance_idx" class="doc_header"><code>balance_idx</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/validation.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>balance_idx</code>(<strong><code>o</code></strong>, <strong><code>shuffle</code></strong>=<em><code>False</code></em>, <strong><code>random_state</code></strong>=<em><code>None</code></em>, <strong><code>verbose</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">check_overlap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">check_overlap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="p">[</span><span class="mi">9</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)))</span>
<span class="n">balanced_idx</span> <span class="o">=</span> <span class="n">balance_idx</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">balanced_idx</span><span class="p">]),</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">balanced_idx</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">l</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="n">balanced_idx</span> <span class="o">=</span> <span class="n">balance_idx</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">l</span><span class="p">)[</span><span class="n">balanced_idx</span><span class="p">]),</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">balanced_idx</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">balanced_idx</span> <span class="o">=</span> <span class="n">balance_idx</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">balanced_idx</span><span class="p">]),</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">balanced_idx</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">balanced_idx</span> <span class="o">=</span> <span class="n">balance_idx</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">balanced_idx</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">balanced_idx</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100_000</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100_000</span><span class="p">,</span> <span class="mi">200_000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">soft_labels</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">filter_pseudolabels</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="n">balanced_pseudolabels</span> <span class="o">=</span> <span class="kc">True</span>


<span class="n">pseudolabels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">pseudolabels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">pseudolabels</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">soft_labels</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">pseudolabels</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">hpl</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">pseudolabels</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">soft_labels</span> <span class="k">else</span> <span class="n">pseudolabels</span>

<span class="k">if</span> <span class="n">filter_pseudolabels</span> <span class="ow">and</span> <span class="n">pseudolabels</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
    <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">pseudolabels</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="n">filt_pl_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">error</span><span class="p">))[</span><span class="n">error</span> <span class="o">&lt;</span> <span class="n">filter_pseudolabels</span><span class="p">]</span>
    <span class="n">filt_pl</span> <span class="o">=</span> <span class="n">pseudolabels</span><span class="p">[</span><span class="n">error</span> <span class="o">&lt;</span> <span class="n">filter_pseudolabels</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">filt_pl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;no filtered pseudolabels&#39;</span>
    <span class="n">filt_hpl</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">filt_pl</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span> 
    <span class="n">filt_pl_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pseudolabels</span><span class="p">))</span>
    <span class="n">filt_pl</span> <span class="o">=</span> <span class="n">filt_hpl</span> <span class="o">=</span> <span class="n">pseudolabels</span>
<span class="n">pl_split</span> <span class="o">=</span> <span class="n">filt_pl_idx</span><span class="p">[</span><span class="n">balance_idx</span><span class="p">(</span><span class="n">filt_hpl</span><span class="p">)]</span> <span class="k">if</span> <span class="n">balanced_pseudolabels</span> <span class="k">else</span> <span class="n">filt_pl_idx</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">hpl</span><span class="p">[</span><span class="n">pl_split</span><span class="p">]</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">hpl</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="TrainValidTestSplitter" class="doc_header"><code>TrainValidTestSplitter</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/validation.py#L47" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TrainValidTestSplitter</code>(<strong><code>n_splits</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>valid_size</code></strong>:<code>Union</code>[<code>float</code>, <code>int</code>]=<em><code>0.2</code></em>, <strong><code>test_size</code></strong>:<code>Union</code>[<code>float</code>, <code>int</code>]=<em><code>0.0</code></em>, <strong><code>train_only</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>stratify</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>balance</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>shuffle</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>random_state</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>None</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> into random train, valid (and test optional) subsets.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_splits" class="doc_header"><code>get_splits</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/validation.py#L143" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_splits</code>(<strong><code>o</code></strong>, <strong><code>n_splits</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>valid_size</code></strong>:<code>float</code>=<em><code>0.2</code></em>, <strong><code>test_size</code></strong>:<code>float</code>=<em><code>0.0</code></em>, <strong><code>train_only</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>train_perc</code></strong>:<code>float</code>=<em><code>1.0</code></em>, <strong><code>balance</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>shuffle</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>stratify</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_splits</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>random_state</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>None</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Arguments:
o            : object to which splits will be applied, usually target.
n_splits     : number of folds. Must be an int &gt;= 1.
valid_size   : size of validation set. Only used if n_splits = 1. If n_splits &gt; 1 valid_size = (1. - test_size) / n_splits.
test_size    : size of test set. Default = 0.
train_only   : if True valid set == train set. This may be useful for debugging purposes.
train_perc   : percentage of the train set used. Default = 1. Useful for to get learning curves with different train sizes.
balance      : whether to balance data so that train always contain the same number of items per class.
shuffle      : whether to shuffle data before splitting into batches. Note that the samples within each split will be shuffle.
stratify     : whether to create folds preserving the percentage of samples for each class.
check_splits : whether to perform leakage and completion checks.
random_state : when shuffle is True, random_state affects the ordering of the indices. Pass an int for reproducible output.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">random_shuffle</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">700</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">300</span><span class="p">)))</span>
<span class="c1"># y = random_shuffle(concat(torch.zeros(700), torch.ones(300)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799],[800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_splits</span>                <span class="o">=</span> <span class="mi">5</span>

<span class="n">cv</span>                      <span class="o">=</span> <span class="kc">True</span>
<span class="n">valid_size</span>              <span class="o">=</span> <span class="mf">0.2</span>  
<span class="n">test_size</span>               <span class="o">=</span> <span class="mi">0</span>
<span class="n">train_only</span>              <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># set to True for debugging (valid = train)</span>
<span class="n">train_perc</span>              <span class="o">=</span> <span class="mf">1.</span>
<span class="n">stratify</span>                <span class="o">=</span> <span class="kc">True</span>
<span class="n">balance</span>                 <span class="o">=</span> <span class="kc">True</span>
<span class="n">shuffle</span>                 <span class="o">=</span> <span class="kc">True</span>
<span class="n">predefined_splits</span>       <span class="o">=</span> <span class="kc">None</span>


<span class="n">check_splits</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">23</span>

<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=</span><span class="n">valid_size</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="n">shuffle</span><span class="p">,</span> <span class="n">balance</span><span class="o">=</span><span class="n">balance</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">stratify</span><span class="p">,</span>
                    <span class="n">train_only</span><span class="o">=</span><span class="n">train_only</span><span class="p">,</span> <span class="n">train_perc</span><span class="o">=</span><span class="n">train_perc</span><span class="p">,</span> <span class="n">check_splits</span><span class="o">=</span><span class="n">check_splits</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">split</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">n_splits</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span><span class="p">[</span><span class="n">split</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">split</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.5, (#1120) [836,0,544,448,917,642,255,704,836,326...])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">valid_size</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">stratify</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">train_only</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">train_perc</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">check_splits</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=</span><span class="n">valid_size</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="n">shuffle</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">stratify</span><span class="p">,</span>
                    <span class="n">train_only</span><span class="o">=</span><span class="n">train_only</span><span class="p">,</span> <span class="n">train_perc</span><span class="o">=</span><span class="n">train_perc</span><span class="p">,</span> <span class="n">check_splits</span><span class="o">=</span><span class="n">check_splits</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">:</span> 
    <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>valid == train
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_splits</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">L</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">splits</span><span class="p">))[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>

<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_splits</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">L</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">splits</span><span class="p">))[</span><span class="mi">1</span><span class="p">]))),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_splits</span><span class="p">):</span> <span class="n">leakage_finder</span><span class="p">(</span><span class="o">*</span><span class="n">splits</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">),</span> <span class="n">n_splits</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
<span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
<span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">splits</span><span class="p">,</span> <span class="n">fastcore</span><span class="o">.</span><span class="n">foundation</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fastcore</span><span class="o">.</span><span class="n">foundation</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">splits</span><span class="p">,</span> <span class="n">fastcore</span><span class="o">.</span><span class="n">foundation</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fastcore</span><span class="o">.</span><span class="n">foundation</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">splits</span><span class="p">,</span> <span class="n">fastcore</span><span class="o">.</span><span class="n">foundation</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fastcore</span><span class="o">.</span><span class="n">foundation</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">splits</span><span class="p">,</span> <span class="n">fastcore</span><span class="o">.</span><span class="n">foundation</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fastcore</span><span class="o">.</span><span class="n">foundation</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#3) [[400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799],[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399],[800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">splits1</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">splits2</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">splits3</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">splits4</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splits1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">splits2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">test_ne</span><span class="p">(</span><span class="n">splits3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">splits4</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">leakage_finder</span><span class="p">(</span><span class="o">*</span><span class="n">splits</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">TrainValidTestSplitter</span><span class="p">(</span><span class="n">valid_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">125</span><span class="p">]:</span>
    <span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">train_perc</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">8</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">L</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span> <span class="o">+</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">2</span><span class="p">]]),</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#3) [[24, 25, 19, 3, 16, 50, 82, 44, 42, 73, 61, 89, 45, 29, 64, 37, 95, 65, 43, 88, 57, 62, 53, 47, 72, 46, 79, 63, 41, 97, 76, 96, 67, 56, 5, 6, 87, 92, 83, 12, 66, 38, 13, 22, 35, 78, 14, 7, 15, 99, 71, 70, 28, 80, 90, 30, 11, 23, 40, 33],[0, 39, 69, 31, 1, 85, 34, 2, 59, 81, 98, 54, 84, 48, 91, 9, 58, 60, 49, 10],[55, 8, 52, 68, 4, 93, 27, 20, 32, 75, 36, 77, 26, 74, 86, 51, 94, 21, 18, 17]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">L</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span> <span class="o">+</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># test_eq(splits[0] + splits[1] + splits[2], np.arange(100))</span>
<span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#3) [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59],[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79],[80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">valid_size</span><span class="o">=</span><span class="mf">0.213</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">17</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">get_splits</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">valid_size</span><span class="o">=</span><span class="mf">0.213</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">train_perc</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
<span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#3) [[4, 55, 29, 48, 15, 8, 1, 77, 36, 85, 34, 80],[62, 78, 67, 43, 95, 53, 2, 82, 5, 84, 72, 44, 47, 13, 27, 54, 26, 46, 12, 66, 51],[57, 74, 33, 16, 56, 6, 0, 37, 40, 22, 58, 92, 91, 49, 25, 30, 35]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_predefined_splits" class="doc_header"><code>get_predefined_splits</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/validation.py#L192" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_predefined_splits</code>(<strong>*<code>xs</code></strong>)</p>
</blockquote>
<p>xs is a list with X_train, X_valid, ...</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="combine_split_data" class="doc_header"><code>combine_split_data</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/validation.py#L201" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>combine_split_data</code>(<strong><code>xs</code></strong>, <strong><code>ys</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>xs is a list with X_train, X_valid, .... ys is None or a list with y_train, y_valid, ....</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span> <span class="o">=</span> <span class="n">combine_split_data</span><span class="p">([</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">],</span> <span class="p">[</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">test_type</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">test_type</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span> <span class="o">=</span> <span class="n">combine_split_data</span><span class="p">([</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">],</span> <span class="p">[</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X_valid</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">test_type</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">test_type</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2xy" class="doc_header"><code>df2xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/validation.py#L209" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2xy</code>(<strong><code>df</code></strong>, <strong><code>feat_col</code></strong>=<em><code>None</code></em>, <strong><code>target_col</code></strong>=<em><code>None</code></em>, <strong><code>data_cols</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindow" class="doc_header"><code>SlidingWindow</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/validation.py#L224" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindow</code>(<strong><code>window_length</code></strong>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a 1d or 2d input (np.ndarray, torch.Tensor or pd.DataFrame)</p>
<p>Args:
    window_length   = length of lookback window
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_length (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict. 0 for last step in the selected window. &gt; 0 for future steps. List for several steps.
    get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x
    get_y           = indices of columns that contain the target (ys). If None and horizon = 0, no y will be returned to avoid leakage.
    seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)</p>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#6) [(array([[0, 1, 2, 3, 4]]),),(array([[1, 2, 3, 4, 5]]),),(array([[2, 3, 4, 5, 6]]),),(array([[3, 4, 5, 6, 7]]),),(array([[4, 5, 6, 7, 8]]),),(array([[5, 6, 7, 8, 9]]),)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[3, 4, 5, 6, 7]]), 8)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
[(array([[3, 4, 5, 6, 7]]), 8), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[13, 14, 15, 16, 17]]), 18)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9), (array([[5, 6, 7, 8, 9]]), 10), (array([[ 6,  7,  8,  9, 10]]), 11), (array([[ 7,  8,  9, 10, 11]]), 12), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[ 9, 10, 11, 12, 13]]), 14), (array([[10, 11, 12, 13, 14]]), 15), (array([[11, 12, 13, 14, 15]]), 16), (array([[12, 13, 14, 15, 16]]), 17), (array([[13, 14, 15, 16, 17]]), 18), (array([[14, 15, 16, 17, 18]]), 19)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), array([  5,  50, 500])), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), array([  6,  60, 600])), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), array([  7,  70, 700])), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), array([  8,  80, 800])), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), array([  9,  90, 900]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0,  1,  2,  3,  4],
       [ 0, 10, 20, 30, 40]]), 500), (array([[ 1,  2,  3,  4,  5],
       [10, 20, 30, 40, 50]]), 600), (array([[ 2,  3,  4,  5,  6],
       [20, 30, 40, 50, 60]]), 700), (array([[ 3,  4,  5,  6,  7],
       [30, 40, 50, 60, 70]]), 800), (array([[ 4,  5,  6,  7,  8],
       [40, 50, 60, 70, 80]]), 900)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1000, 3)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0.37260959,  0.837867  ,  0.51731362,  0.98670284,  1.0468292 ],
       [-0.47209958, -0.45580347, -0.04455049, -0.24205716, -0.61402209]]), -1.0610134171484162), (array([[ 1.31315432,  0.96357684,  0.53975885,  0.43077976,  0.8115898 ],
       [-0.93827411, -0.46870424, -0.95325489, -1.04635624, -1.15367389]]), -0.45879094031869005), (array([[ 0.57455283,  0.97647956,  0.69805447,  0.23819889,  0.15159826],
       [-0.83008121, -0.67913736, -1.10992466, -1.13804105, -1.23751932]]), 0.636017765707389), (array([[-0.27746804,  0.02843711,  0.0771581 ,  0.23344052,  0.69422328],
       [-1.47535094, -1.40509507, -1.10828479, -1.39736563, -1.18660208]]), 1.6211961676756086), (array([[ 0.67308319,  0.69076937,  0.75283163,  0.45485997,  0.0225123 ],
       [-1.46257399, -1.93893486, -1.73275747, -1.43081056, -1.47427056]]), 1.2151819979065297), (array([[-0.07048988, -0.12948085,  0.32329457,  0.73683028,  0.73453525],
       [-1.30797484, -1.27908297, -1.67997286, -1.65276463, -1.68670198]]), 0.163418727840122), (array([[ 0.8899319 ,  0.43956753,  0.25774471,  0.39797896,  0.33649299],
       [-1.94761453, -1.7444411 , -1.96427719, -1.86850484, -1.74957088]]), 0.2946090672320699), (array([[ 0.16592211, -0.1902879 , -0.63539465, -0.81125922, -0.84062424],
       [-1.98447048, -2.38664177, -2.27705597, -2.1705865 , -2.3406637 ]]), 0.526520959217076), (array([[-1.31536928, -0.91327161, -1.34494442, -1.12586654, -0.89448495],
       [-2.34596592, -2.47134757, -2.96772474, -2.80631528, -2.31304359]]), 1.0947388636478839), (array([[-1.3098377 , -1.24594155, -0.92786697, -0.75068648, -0.41887336],
       [-2.23057047, -2.62784271, -2.28200376, -1.813049  , -1.59684639]]), 0.41476370829797715), (array([[ 0.05205986,  0.41925037,  0.02212406, -0.1066879 ,  0.10725616],
       [-1.44886256, -0.96520678, -0.92107603, -1.29996178, -1.40996139]]), 0.8483592723886667), (array([[-0.29286612, -0.58027244, -0.87096308, -1.33553081, -1.70442813],
       [-1.34850795, -1.3887848 , -1.70210916, -1.24254759, -1.62028901]]), 1.0763602262732985), (array([[-1.47484657, -1.46788473, -1.28850312, -1.53820875, -1.974889  ],
       [-1.86871053, -1.50051776, -1.05258281, -0.6962237 , -0.5391546 ]]), 1.9904051936387877), (array([[-1.93708578, -2.41635548, -2.01239327, -1.65944218, -1.80009266],
       [-0.27616642, -0.43201268, -0.1899821 , -0.44826447, -0.24216403]]), 0.3101358078371602), (array([[-2.20010892, -2.5555923 , -2.82736099, -2.93219816, -2.68423318],
       [ 0.20307454,  0.6481123 ,  0.33738846, -0.12331663,  0.21059217]]), -0.2508981850694887), (array([[-3.1244251 , -3.54511845, -3.21186122, -3.1210344 , -3.47324213],
       [ 0.5372974 ,  0.91272166,  1.2079042 ,  1.51201897,  1.22011423]]), -0.7756735493852679), (array([[-3.48793038, -3.31254759, -3.26120558, -3.31845503, -2.98698814],
       [ 0.7837313 ,  1.25357432,  1.00569498,  1.2357332 ,  1.52737063]]), -0.7257419332259496), (array([[-2.6485235 , -2.18503759, -2.54292548, -2.91652923, -3.24117371],
       [ 1.91660864,  2.4044854 ,  2.3770938 ,  2.45177606,  2.12846011]]), -0.9439894141905156), (array([[-3.48771065, -3.3309858 , -2.9834618 , -3.17144987, -3.07827917],
       [ 1.64108811,  1.65269548,  1.51976033,  1.12675402,  1.09570665]]), -1.161388392193622), (array([[-3.34889843, -3.79648666, -3.89117728, -4.28396639, -4.41367077],
       [ 1.40210403,  1.21694321,  0.87345399,  0.53883369,  0.95886499]]), -0.6998348342858898), (array([[-4.37644239, -4.00361484, -4.45850016, -4.27939033, -4.43977016],
       [ 1.36620123,  1.60553524,  1.26392953,  0.9287072 ,  1.01870862]]), -1.1508503225160558), (array([[-4.68794522, -4.56714753, -5.00876376, -5.22477765, -5.36797296],
       [ 1.27600593,  1.30770355,  1.3893428 ,  1.80836708,  1.80128557]]), -1.0203415998250953), (array([[-5.15043927, -5.06841388, -5.5283345 , -5.65680178, -5.35051938],
       [ 2.18793219,  2.3687871 ,  2.41884317,  2.40458924,  2.40085414]]), -0.6081381259872884), (array([[-5.44231592, -4.95309618, -4.98250999, -4.60607247, -4.53286589],
       [ 2.50916968,  2.80623652,  2.78762068,  2.4114514 ,  2.30151168]]), -2.1626924630229185), (array([[-4.34129461, -4.54543426, -4.06126255, -4.4483711 , -4.59292648],
       [ 2.40759118,  2.6084291 ,  2.8459963 ,  2.66258783,  2.49641939]]), -2.778500634107692), (array([[-4.35021549, -4.35585852, -4.40951951, -4.27157061, -4.19102046],
       [ 2.33705278,  2.00988231,  1.73661503,  1.7563283 ,  1.65831515]]), -3.5839913591930683), (array([[-4.07980238, -4.49917294, -4.56627402, -4.82852759, -4.93469748],
       [ 1.4082401 ,  0.98535012,  0.81222828,  0.48046464,  0.030081  ]]), -4.536751631555282), (array([[-4.59216186, -4.20613856, -3.83011523, -3.95887889, -3.73990196],
       [-0.296721  ,  0.18982022,  0.23185256, -0.18363013,  0.15276486]]), -4.876146746168919), (array([[-3.43168828, -3.89216627, -4.3878783 , -4.76399119, -5.18133544],
       [ 0.4712035 ,  0.11596788, -0.1371229 , -0.12882205, -0.05881966]]), -5.355562372058859), (array([[-4.80557072, -4.72481378, -4.91653015, -5.31033125, -4.9914535 ],
       [-0.41530288, -0.32449106, -0.03966032, -0.03575562, -0.23407474]]), -5.706176064581752), (array([[-4.79527357, -4.90383588, -4.89809921, -4.9413654 , -4.60562223],
       [-0.3145735 , -0.65494325, -0.52225035, -0.14700946, -0.2868711 ]]), -4.983550990161551), (array([[-4.67122988, -4.88539099, -5.06548674, -4.58284006, -4.28749742],
       [-0.15170664,  0.3401793 ,  0.0963508 ,  0.25233509,  0.54714723]]), -4.99441530313135), (array([[-4.07568435, -4.28399067, -4.51508561, -4.46065227, -4.24759078],
       [ 0.75764435,  0.45878831,  0.70489954,  1.19176634,  1.04254037]]), -4.674627882625445), (array([[-3.90750635, -4.12091662, -4.22924275, -4.55107838, -4.37363898],
       [ 1.06388898,  1.23771501,  0.99597574,  0.71773121,  1.01358659]]), -3.9374409443193135), (array([[-4.82201394, -5.00071154, -5.402916  , -5.38456325, -5.66861753],
       [ 1.31298771,  1.03782075,  0.86355504,  1.32853118,  1.59852458]]), -3.6951846504768713), (array([[-5.69426654, -5.74216449, -5.44487068, -5.4223526 , -5.15116431],
       [ 1.10408789,  1.43501923,  1.85949318,  1.66359578,  1.50712363]]), -3.4678900446535863), (array([[-5.45101203, -5.34438323, -5.693951  , -5.56781355, -5.4035143 ],
       [ 1.68349577,  2.07377139,  2.57158918,  2.60027146,  3.03142481]]), -3.2558777103184227), (array([[-5.03599408, -5.17426194, -5.28681843, -5.05652464, -5.24464138],
       [ 2.5798279 ,  2.31852119,  2.35112443,  2.2528967 ,  2.49093959]]), -3.3375797986383358), (array([[-5.07285951, -5.13935816, -5.47954032, -5.03929368, -5.50790209],
       [ 2.13652799,  1.86045254,  1.75236184,  1.35111089,  1.41658422]]), -3.735917092518843), (array([[-5.65323922, -5.88628865, -6.06034293, -6.46638219, -6.80734989],
       [ 1.33366217,  1.27556585,  1.11803187,  0.80459433,  0.44559153]]), -3.2593421840992414), (array([[-6.93369838, -7.28499943, -6.94512793, -6.50086008, -6.29993178],
       [ 0.87437471,  0.8231356 ,  0.8408439 ,  0.50796982,  0.55689284]]), -4.638285343890636), (array([[-6.02277145, -6.38423805, -6.65100644, -7.03304429, -7.16120475],
       [ 0.40172127,  0.53825664,  0.97959823,  0.64329745,  0.32978025]]), -4.715803206267119), (array([[-7.45086194, -7.85670451, -7.62199717, -7.65245531, -7.80969279],
       [ 0.64807794,  0.43112592,  0.69303902,  0.95908813,  1.16221081]]), -4.798862916856233), (array([[-7.6251198 , -7.21291043, -7.10971008, -6.68159096, -7.07260288],
       [ 0.95568435,  0.50487547,  0.40425076,  0.8931383 ,  0.94820612]]), -3.2762387679606126), (array([[-7.39743246, -7.17962149, -6.99712222, -7.09820018, -7.58613766],
       [ 1.04448126,  1.23050887,  0.98479045,  0.62205467,  1.00821882]]), -2.896139041387325), (array([[-7.69772377, -8.04586684, -8.05904416, -7.65137726, -7.21279368],
       [ 1.3329003 ,  1.48515729,  1.45283099,  1.02352149,  1.12928393]]), -4.046929810248766), (array([[-7.29375594, -7.28595119, -7.64025018, -7.64519918, -7.17618975],
       [ 1.11345407,  0.72728585,  1.08167688,  1.18395459,  0.7238483 ]]), -3.5404644493357624), (array([[-6.79413108, -6.51261553, -6.68914751, -6.27223363, -6.44924035],
       [ 0.93704359,  1.17359452,  1.01395116,  0.72105539,  0.43031373]]), -4.218052899118996), (array([[-6.0364671 , -5.62336743, -5.81545801, -6.28864027, -6.12298931],
       [ 0.32043873,  0.78340177,  1.15617879,  1.16781794,  1.40152718]]), -3.819796313742523), (array([[-6.11986725, -6.57768   , -6.71516809, -7.12252942, -6.7555437 ],
       [ 1.37494499,  0.90780302,  1.04130136,  1.45312817,  1.18605852]]), -3.7118763319746297), (array([[-6.46832315, -6.15242918, -6.30489812, -6.16243239, -5.87552082],
       [ 1.4596497 ,  1.46376898,  1.21017463,  1.06830237,  1.09854735]]), -5.773169007885356), (array([[-6.34220224, -6.70684461, -6.60422399, -6.40167608, -6.85677736],
       [ 1.00507261,  1.41514514,  1.51355511,  1.29044811,  1.14201811]]), -6.657936909747036), (array([[-6.96631273, -6.54725249, -6.15195112, -6.42706987, -6.34545879],
       [ 1.57430261,  1.44202538,  1.72411837,  1.78498956,  2.17603959]]), -7.137731428237092), (array([[-6.59964352, -6.14321459, -6.11972381, -5.87802034, -5.42935421],
       [ 1.93619908,  2.05490654,  2.4895668 ,  2.7965713 ,  2.69550064]]), -6.24784006799813), (array([[-5.59993909, -5.66290786, -5.21093748, -5.55801661, -5.83869412],
       [ 2.80230011,  2.57632619,  2.42272154,  2.296122  ,  2.18319712]]), -5.919961813339158), (array([[-5.98621118, -6.08518589, -5.73294472, -5.24992662, -4.78598288],
       [ 2.2700108 ,  2.42968449,  2.43678578,  2.8634304 ,  3.09648329]]), -4.735414361527345), (array([[-5.1787515 , -5.06920059, -4.60729848, -4.57390198, -4.32441409],
       [ 2.8026384 ,  3.17919885,  3.41536647,  3.07531178,  2.82087184]]), -4.072647375462587), (array([[-4.15015249, -4.16229708, -3.93259823, -4.20075531, -3.80891437],
       [ 2.72974467,  3.22107028,  3.59209407,  3.37958041,  3.84717141]]), -3.574278826184376), (array([[-4.0986164 , -3.80342599, -4.00370595, -3.65416491, -3.22651106],
       [ 4.03627957,  4.17959951,  4.27178905,  4.11629398,  4.07755792]]), -3.6461453279738065), (array([[-3.55996247, -3.91158852, -4.37326661, -4.80268783, -4.73805656],
       [ 3.85689403,  3.68230011,  4.08877187,  3.69542112,  4.16390458]]), -3.0265491406649474), (array([[-4.4263187 , -4.81825542, -5.24641713, -5.7182127 , -5.97975441],
       [ 3.90105326,  3.4813524 ,  3.90205706,  4.14948496,  4.11075021]]), -3.786129957337817), (array([[-5.61784792, -5.75839883, -6.2315235 , -6.14081752, -6.50146605],
       [ 3.73143622,  4.11531376,  3.69484807,  3.5696564 ,  3.78125256]]), -3.5468625336728827), (array([[-6.54203732, -6.87865534, -7.04373419, -7.22666754, -7.27780673],
       [ 3.91163456,  3.62700673,  3.36109115,  3.32039587,  3.33671761]]), -3.5269520364620823), (array([[-7.36714724, -7.43556503, -7.08831645, -7.5139083 , -7.20499431],
       [ 3.13477237,  3.41931873,  3.40696978,  3.41931235,  3.05744348]]), -3.0812960259127022), (array([[-7.60546175, -8.10306809, -7.97555338, -7.62321264, -7.58839542],
       [ 2.6978615 ,  2.8369597 ,  2.87445825,  2.6775464 ,  2.88503302]]), -3.531375705613578), (array([[-8.08487192, -8.07449836, -7.67362966, -8.04064307, -7.81703344],
       [ 2.56889891,  2.96465485,  2.58303831,  2.19248928,  1.96255925]]), -2.6013041817755385), (array([[-8.09799549, -8.51235913, -8.83828259, -8.82452217, -8.36813286],
       [ 1.50374418,  1.74325949,  2.13845856,  2.48664976,  2.08977159]]), -3.6059066486505698), (array([[-7.86826915, -8.32948577, -8.04246761, -7.59482999, -7.56276191],
       [ 2.55266604,  2.32342636,  2.64556953,  2.95642518,  2.98188032]]), -2.925462534128079), (array([[-7.79969353, -8.21451625, -8.25359018, -8.29600997, -8.08660287],
       [ 2.72638986,  2.59539676,  2.73568231,  2.76877692,  2.36637322]]), -2.325290995223659), (array([[-8.44927584, -8.22185457, -8.56433082, -8.68654543, -8.90132501],
       [ 2.4822841 ,  2.14452796,  2.28875087,  2.51580432,  2.2419198 ]]), -2.73677493846127), (array([[-8.62584343, -9.08084103, -9.285741  , -9.17151318, -9.3806663 ],
       [ 2.57015045,  2.23531905,  1.97645854,  2.17379973,  2.07709279]]), -1.5657388140185264), (array([[-9.21806282, -9.49116227, -9.63816374, -9.95737984, -9.71701332],
       [ 2.43928056,  2.74660079,  3.16115065,  2.69351204,  2.32377875]]), -1.6717030538545095), (array([[-10.11576241, -10.14180528,  -9.9403014 ,  -9.53814531,
         -9.46593152],
       [  2.55676976,   2.86907768,   2.88328066,   3.06506011,
          3.38688322]]), -2.436893782190326), (array([[-9.31371689, -9.77496494, -9.6970464 , -9.49386192, -9.79967632],
       [ 2.93242824,  3.37896532,  3.79051092,  4.22078519,  3.93907002]]), -1.9242312188693826), (array([[ -9.75577225,  -9.63170408,  -9.8620085 ,  -9.81109306,
        -10.24009798],
       [  3.75837803,   4.02710486,   4.37528988,   4.3499178 ,
          4.20502084]]), -1.3789907576132168), (array([[-10.07703711,  -9.66281311,  -9.90534522, -10.30882768,
        -10.61797075],
       [  3.91067808,   4.28420851,   4.72969038,   4.99802078,
          4.75929073]]), -2.232729303918148), (array([[-10.93084846, -11.19953415, -11.21242883, -11.69258501,
        -11.74755719],
       [  4.73888305,   5.22003615,   5.25528114,   5.289055  ,
          4.90560374]]), -2.282215181472988), (array([[-11.75663459, -11.27729101, -11.24381181, -11.29689955,
        -11.16156092],
       [  4.89519367,   5.10514408,   4.9146792 ,   5.12755331,
          5.23808868]]), -2.262520733420623), (array([[-11.21938432, -11.1945655 , -11.23809998, -11.28478101,
        -10.86036276],
       [  5.56755888,   6.05044622,   6.08811041,   5.66899939,
          5.18744802]]), -2.233482067124794), (array([[-10.99353536, -10.90359382, -10.57428365, -10.72639625,
        -10.99916035],
       [  4.74786727,   4.69181893,   4.47351927,   4.2943784 ,
          4.00000928]]), -2.679323613827468), (array([[-11.36828282, -11.07292568, -11.53661941, -11.69868255,
        -11.35915561],
       [  3.72266076,   3.67581074,   3.60285879,   3.85426632,
          3.95054775]]), -3.1555384425631905), (array([[-11.80861147, -11.92326328, -12.2743792 , -12.02393711,
        -11.62642082],
       [  3.78389501,   4.24553492,   4.36984713,   4.6173896 ,
          4.54475305]]), -3.6173660724095593), (array([[-11.83036455, -11.60319284, -11.82452872, -11.98628882,
        -11.66810403],
       [  4.96376008,   5.36574394,   5.48943591,   5.11140904,
          5.53827328]]), -3.3940005218077895), (array([[-11.77612255, -12.05393576, -12.45033664, -12.48062883,
        -12.07015163],
       [  5.79094058,   5.85063001,   6.29234025,   6.48632656,
          6.53654801]]), -3.7589954700356074), (array([[-11.8465477 , -11.77580547, -12.20442915, -12.16799364,
        -12.2126412 ],
       [  6.52273001,   6.44744068,   6.51828388,   6.7164736 ,
          6.4663716 ]]), -4.437833829111281), (array([[-12.4031867 , -12.18466819, -12.49344705, -12.37691363,
        -12.05085091],
       [  6.85014422,   6.40498517,   6.8130043 ,   7.11443432,
          7.4501598 ]]), -5.590545073288348), (array([[-11.83767907, -12.19856022, -12.32007564, -12.21430581,
        -12.31141206],
       [  7.08404503,   7.11614361,   7.14020716,   7.00314303,
          7.4860615 ]]), -5.606396140126974), (array([[-12.42073082, -12.69446178, -13.0178487 , -12.95618852,
        -12.92858375],
       [  7.93662407,   8.30781794,   7.81545621,   7.80845837,
          8.24006849]]), -5.562155662895371), (array([[-13.35811789, -13.62697529, -13.54800609, -13.50207133,
        -13.42048612],
       [  7.99098964,   8.11993085,   8.34422361,   8.75871242,
          8.44442454]]), -5.851234085223864), (array([[-13.03208756, -12.6267854 , -12.75751822, -13.02270443,
        -13.43765862],
       [  8.38979263,   8.84594229,   8.49839558,   8.33276628,
          8.63572371]]), -4.545097940374008), (array([[-13.50058108, -13.14715436, -13.29936456, -12.87495334,
        -13.06721457],
       [  8.51254306,   8.8793398 ,   9.34955038,   9.33034743,
          9.00443739]]), -4.7595503623588735), (array([[-13.39414231, -13.01074299, -12.75662168, -13.1520121 ,
        -12.75033037],
       [  9.21795744,   8.87786411,   9.05522555,   9.30886759,
          9.11439577]]), -4.584496517973535), (array([[-12.75448927, -12.79246786, -13.00377683, -12.55280172,
        -12.74881297],
       [  8.72113924,   8.43978419,   8.29542133,   8.65542069,
          8.49301717]]), -4.445199279482197), (array([[-12.83905732, -12.44029631, -12.09418824, -12.34491056,
        -11.98580153],
       [  8.57015344,   8.12516575,   8.14618074,   7.81940969,
          7.72999626]]), -4.147751969507767), (array([[-11.85548024, -12.02533389, -11.62029604, -11.29101333,
        -11.51051168],
       [  7.84092566,   8.02407076,   8.01111255,   7.65912105,
          7.34098368]]), -3.94825930954692), (array([[-11.7778487 , -12.12647995, -12.33912805, -12.2942183 ,
        -12.378985  ],
       [  7.71134553,   8.04831768,   8.21445431,   8.00724812,
          8.4203809 ]]), -3.979478659131931), (array([[-12.78164006, -12.57972623, -12.40569126, -12.62916733,
        -13.08125734],
       [  8.73665212,   8.59105038,   8.25410379,   8.33410938,
          8.51672314]]), -4.592056369389862), (array([[-13.3742723 , -12.99181901, -13.23271979, -13.13811601,
        -13.20778954],
       [  8.4868286 ,   8.75176926,   8.99280782,   9.4913097 ,
          9.90225992]]), -3.408564565943739), (array([[-13.29568687, -13.02924146, -12.87668236, -12.46262361,
        -12.65053531],
       [  9.86328286,  10.11319613,  10.53741593,  10.59937953,
         10.46817608]]), -3.0347384632032623), (array([[-12.39004849, -12.52114815, -12.97657943, -12.90451143,
        -12.57290548],
       [ 10.65285991,  10.82038278,  10.51113328,  10.5077337 ,
         10.23243967]]), -3.690295714091053), (array([[-12.56256687, -13.00324365, -13.24680289, -12.75086542,
        -13.03464657],
       [  9.75697066,   9.9315765 ,  10.36496109,  10.50644752,
         10.23492821]]), -3.340393618792932), (array([[-13.20738666, -13.23434426, -13.00045509, -12.54949769,
        -12.06880778],
       [ 10.46805411,  10.4445479 ,  10.40900301,  10.77364702,
         10.6362687 ]]), -3.5151960230788575), (array([[-11.87247871, -11.63976261, -11.1807535 , -11.34197691,
        -11.28868285],
       [ 10.83370729,  10.79268005,  11.07736167,  10.5927501 ,
         11.00671019]]), -4.021501675298701), (array([[-11.70705679, -12.1653949 , -12.3043464 , -12.07682348,
        -11.84624327],
       [ 10.76735415,  11.24282731,  10.99584399,  10.83445423,
         10.64730559]]), -4.646743611006249), (array([[-11.54275625, -11.33388319, -11.71443463, -11.73886145,
        -11.23914784],
       [ 10.66635746,  10.65677581,  10.91943204,  11.18218235,
         11.54572395]]), -5.676861450471493), (array([[-10.96559619, -10.46787912,  -9.98604016,  -9.56152294,
         -9.49872849],
       [ 12.0091981 ,  12.46602199,  12.00949242,  12.04242714,
         11.72994669]]), -5.970076404704831), (array([[ -9.73443018,  -9.57491905,  -9.82505602,  -9.87038856,
        -10.05453522],
       [ 11.65100233,  11.88945759,  11.73154435,  11.80462323,
         11.4939097 ]]), -5.522852512467885), (array([[-10.34792331, -10.35772429, -10.82299046, -11.07257404,
        -10.93915446],
       [ 11.81112556,  11.85109948,  11.49127245,  11.3947708 ,
         11.85584381]]), -6.192530870193729), (array([[-11.0043542 , -10.80515487, -10.3134726 ,  -9.9810801 ,
        -10.01312248],
       [ 11.85244921,  11.79073795,  11.98520268,  12.3072332 ,
         12.70501   ]]), -6.058915250314385), (array([[-10.27974993, -10.30069342,  -9.82844743,  -9.8611468 ,
         -9.77227914],
       [ 13.03864915,  13.03822294,  13.15457774,  12.72215083,
         13.11619238]]), -6.272508624091007), (array([[-10.21471688, -10.17957631, -10.47140846, -10.2660834 ,
        -10.76089265],
       [ 13.56180857,  13.8457491 ,  13.81891106,  14.21022825,
         14.2897898 ]]), -6.0986029353483415), (array([[-11.06841793, -11.29733661, -10.81276145, -10.89384344,
        -11.31504619],
       [ 14.71059284,  14.67612493,  14.46260156,  14.45414157,
         14.86796194]]), -6.8934279196477375), (array([[-11.76814116, -12.15958359, -12.48185179, -12.42819201,
        -12.76427769],
       [ 15.03074689,  15.24783542,  15.43168522,  15.91416169,
         15.63301141]]), -6.966616124957592), (array([[-12.47909932, -12.65387805, -12.58899667, -12.78505228,
        -12.45131449],
       [ 15.16134606,  14.83473349,  15.16043667,  15.50949867,
         15.85381937]]), -7.837389515094806), (array([[-12.59915587, -12.73788735, -13.20258166, -13.29333462,
        -12.87551453],
       [ 15.48903633,  15.95172837,  15.5666857 ,  15.51924143,
         15.95179692]]), -8.14799100950325), (array([[-13.28085593, -13.63296899, -13.59662989, -13.11135077,
        -12.72338943],
       [ 15.58836275,  15.54026102,  15.74431169,  15.47017301,
         15.64763118]]), -8.210097019272581), (array([[-12.65152493, -13.04870223, -12.93074258, -12.49227228,
        -12.25127183],
       [ 15.40888491,  15.49430393,  15.34413126,  15.72180513,
         15.84071954]]), -7.676892318214778), (array([[-12.18538453, -12.36680854, -12.72535085, -13.01571551,
        -12.81100831],
       [ 15.63426225,  15.66234059,  15.6368775 ,  15.28581697,
         15.35570716]]), -6.712380532352997), (array([[-12.89894318, -13.0197343 , -12.62852502, -12.56679355,
        -12.86826292],
       [ 15.71743165,  15.97182398,  15.95267838,  16.16290953,
         16.19323797]]), -6.299242023661867), (array([[-13.28725416, -12.81263437, -12.68799068, -12.18942556,
        -12.16161419],
       [ 16.02044266,  15.59847469,  15.64762965,  15.94374526,
         16.22389968]]), -6.892158901724246), (array([[-11.72111141, -11.54397628, -11.29571621, -10.94695449,
        -10.92286729],
       [ 16.3245975 ,  16.70881629,  16.6727433 ,  17.1242298 ,
         17.05709858]]), -5.634023149607439), (array([[-10.79849189, -10.36343152, -10.18878806,  -9.90173996,
         -9.52561985],
       [ 16.98332998,  17.25538414,  17.68011185,  17.70521364,
         17.552973  ]]), -4.637982939383955), (array([[-9.39864459, -8.97866006, -9.38811095, -9.00568363, -8.64316121],
       [17.73722402, 17.53048064, 17.10240204, 16.97789489, 17.26659918]]), -4.841308895648571), (array([[-8.33576871, -8.66555397, -8.47490461, -8.73254897, -8.52388409],
       [17.35366296, 17.61896977, 17.42644908, 17.82064773, 17.61837384]]), -5.286417357765864), (array([[-8.54757318, -8.13991127, -8.45439285, -8.13966868, -8.60705587],
       [17.18306774, 16.94012161, 16.91310356, 17.2356036 , 17.05898598]]), -5.7837047361412175), (array([[-8.91807599, -8.7305008 , -9.10607784, -9.00658127, -9.3857413 ],
       [17.17817012, 17.48184654, 17.77991865, 17.87394924, 17.81286686]]), -5.327854120458978), (array([[-9.21965893, -8.77603199, -9.20151083, -8.78630639, -8.64989441],
       [17.99302154, 18.00215897, 17.98646396, 18.35799785, 18.59482323]]), -4.8706868536354815), (array([[-8.74708931, -8.57215117, -8.30610206, -8.26744324, -8.40751875],
       [18.86148379, 18.4997118 , 18.75528526, 18.79510578, 18.91289803]]), -5.448469645809787), (array([[-8.07363384, -7.81949766, -7.77674477, -8.23023261, -8.62287339],
       [19.10285562, 18.83788769, 19.2147205 , 19.14131878, 19.02601254]]), -4.980509553442257), (array([[-8.87770307, -8.88460206, -8.61440402, -8.29820565, -8.72144008],
       [18.61223455, 19.10423642, 19.21811245, 19.58764749, 19.15555959]]), -4.174818505539397), (array([[-8.31110945, -8.67675861, -8.91904323, -9.2850908 , -9.12887533],
       [18.87385208, 18.57327445, 19.0145976 , 18.76188771, 19.15089337]]), -4.280095391073016), (array([[-9.62424254, -9.64595877, -9.19724787, -8.87185586, -8.75246088],
       [19.1386    , 19.6020673 , 19.5928548 , 19.23934904, 19.72695787]]), -4.259455464645914), (array([[-8.5036835 , -8.2162752 , -8.36678284, -8.62047383, -8.19658632],
       [19.76926333, 19.99852821, 20.33882032, 19.84775571, 19.50071691]]), -4.883333673399605), (array([[-8.18702051, -7.87599986, -7.82899446, -7.78478964, -7.34043897],
       [19.27412045, 19.62641754, 19.90586796, 19.84248943, 20.28345649]]), -3.5814342117330966), (array([[-7.14254207, -7.46434824, -7.3005874 , -7.75817799, -7.27167579],
       [19.82405857, 20.25202232, 20.45204437, 20.67450812, 20.80180926]]), -3.2042024456773612), (array([[-7.08991798, -6.8048654 , -7.03964044, -7.35576305, -6.87191214],
       [20.98395227, 20.88296582, 20.64842666, 20.50014077, 20.88745538]]), -3.237178932251052), (array([[-6.42668467, -6.13012984, -5.64990948, -5.58347289, -5.94175242],
       [20.89393103, 21.33740265, 21.75661983, 21.31256938, 21.73575044]]), -3.943676606177912), (array([[-5.67307937, -5.98748599, -6.02911572, -6.51681486, -6.67131486],
       [21.84097015, 21.45056   , 21.37776387, 21.10090327, 21.43616896]]), -3.898004575872235), (array([[-6.54745623, -6.94801979, -6.74541348, -6.65048873, -6.60472104],
       [21.92046629, 22.16940085, 22.15611088, 22.55830018, 22.30734256]]), -3.0026382959716345), (array([[-6.81988928, -6.60604336, -6.68460683, -6.79464652, -6.97876018],
       [22.80615625, 22.81149871, 22.75935704, 22.3657004 , 22.33469247]]), -3.219381434596463), (array([[-6.52323313, -6.62141426, -6.74762568, -6.72706983, -7.21163332],
       [22.06605601, 22.42902626, 22.8509761 , 23.23640292, 23.2035918 ]]), -2.8578081411549565), (array([[-6.80766289, -6.39975161, -5.96868195, -5.93869996, -5.94254728],
       [23.02603562, 22.79787238, 22.61042715, 22.34412866, 22.00724549]]), -2.5959113175611153), (array([[-5.72847369, -5.55016296, -5.91395368, -5.99678307, -5.74408351],
       [21.63991873, 21.78308838, 22.24679863, 21.87218687, 22.22907063]]), -2.4632408373802774), (array([[-5.78831574, -6.11155895, -6.17971034, -5.98233767, -6.35347548],
       [22.05427834, 22.00754486, 21.77580807, 21.83354824, 21.7031274 ]]), -3.000589664876604), (array([[-6.38975804, -6.72796969, -6.87582079, -6.60647999, -6.26017197],
       [22.09018561, 22.4702464 , 22.22577744, 22.04421841, 22.43173225]]), -2.070411860529741), (array([[-5.79005254, -5.52051413, -5.96933168, -5.94110377, -6.33478212],
       [22.48164508, 22.24736483, 22.0696147 , 22.31223346, 21.96300795]]), -2.3639575366140484), (array([[-6.34400853, -6.65802442, -6.31670368, -6.26107308, -6.2765239 ],
       [21.8314536 , 22.08062682, 21.96986787, 22.32719052, 22.25642605]]), -2.697268775969194), (array([[-6.7070853 , -6.41575254, -6.09303956, -5.77008389, -6.11030455],
       [22.06546285, 22.19573224, 22.69200446, 22.82526441, 23.00081254]]), -2.950318364815348), (array([[-5.9931289 , -5.74646468, -6.01580398, -5.52576695, -5.38977331],
       [23.37437083, 23.869677  , 24.20137395, 23.71544993, 24.12298818]]), -3.0724207236531402), (array([[-5.17312594, -5.43252053, -5.77488494, -5.40148972, -5.29003871],
       [24.44442686, 24.68578486, 24.71719516, 24.76173005, 25.15281825]]), -3.8375384300417887), (array([[-4.88944175, -5.10018988, -5.39676801, -4.93702717, -4.99303605],
       [24.797521  , 24.83497051, 24.81873487, 25.20283176, 25.43553183]]), -3.3725139817503225), (array([[-4.68647546, -4.22434878, -4.1468811 , -4.05151547, -3.87917405],
       [25.33139892, 24.87164011, 25.12484054, 25.42965332, 25.50157997]]), -2.790188360838153), (array([[-3.66046526, -3.52311504, -3.3500585 , -3.49161274, -3.96623111],
       [25.6680121 , 25.33486672, 25.55780806, 25.28167903, 24.94854914]]), -3.3147318239672003), (array([[-3.82726791, -3.66844952, -3.8902729 , -3.75662243, -3.81403643],
       [24.47870947, 24.24106561, 24.57204586, 24.61958882, 24.88102171]]), -3.9114504169484214), (array([[-4.16203455, -4.35031923, -3.90398244, -4.26267471, -4.42401244],
       [24.58899241, 24.98041931, 24.58254544, 24.93492786, 25.28112509]]), -3.9696539923236682), (array([[-4.43176681, -4.7420897 , -4.85754168, -5.16805208, -5.28391093],
       [24.93921991, 24.92507299, 24.620513  , 25.08536785, 24.70867556]]), -5.630093374047688), (array([[-5.51393223, -5.11502173, -5.15010317, -5.26782947, -5.36752744],
       [24.91943562, 24.59719265, 24.99075052, 25.07156078, 24.7112509 ]]), -6.183728961392504), (array([[-5.73215687, -6.16211456, -5.76924735, -5.49486956, -5.24818273],
       [24.72475131, 25.13870829, 25.34014448, 25.50652094, 25.60448378]]), -6.689181741224197), (array([[-5.54392784, -5.80447126, -5.49983029, -5.62695492, -5.20842523],
       [25.20522456, 25.07814431, 25.38230257, 25.25044411, 24.8978128 ]]), -6.059335847804836), (array([[-4.76561042, -4.49991146, -4.1701655 , -3.80306306, -4.18744499],
       [24.89520933, 24.43674377, 24.51587358, 24.86440523, 25.31594215]]), -5.303273877448236), (array([[-4.23953927, -3.94726265, -3.67182313, -3.54304036, -3.92650787],
       [25.0260017 , 25.19152091, 24.76553731, 24.2842559 , 24.4734418 ]]), -5.536142548046295), (array([[-3.89215605, -3.49560904, -3.79172571, -3.71878283, -3.94302156],
       [24.59506138, 24.70961916, 24.34361321, 24.62196916, 25.05503629]]), -6.017582285978747), (array([[-3.55620453, -3.26697332, -3.05831966, -2.80039487, -3.11255193],
       [24.65790245, 24.57116626, 24.66708664, 24.22826944, 24.34027774]]), -6.466020897034435), (array([[-2.84459167, -2.88617295, -3.13328183, -2.83295346, -2.36441016],
       [24.75331421, 25.01802372, 25.24464986, 24.77721947, 24.81178429]]), -6.722536107638847), (array([[-2.09436058, -1.62058997, -1.13369298, -0.79895063, -0.97285452],
       [25.04420498, 25.28374989, 24.87481571, 24.43254976, 24.12291664]]), -7.551714884906835), (array([[-0.96565264, -1.25381588, -1.432033  , -1.52859324, -1.46738434],
       [24.40001178, 24.00735998, 24.11133318, 23.64486412, 23.31924158]]), -7.941883545298654), (array([[-1.37165943, -1.22433245, -1.65417258, -1.92363899, -2.07349326],
       [23.45850267, 23.57269405, 23.57801883, 23.1139471 , 23.17634048]]), -8.13934230203747), (array([[-1.93921052, -2.3471782 , -2.76717507, -3.25413439, -2.99116674],
       [23.32112213, 23.00039729, 22.86067125, 22.98564203, 23.00339143]]), -8.359992507190086), (array([[-2.51397769, -2.49270297, -2.53625925, -2.97551743, -3.47443996],
       [22.56600512, 22.37307005, 22.18878783, 21.99969961, 21.84766597]]), -7.960788952923622), (array([[-3.78691083, -3.29911387, -3.34703315, -3.31298597, -3.67388165],
       [21.62496307, 22.01342738, 22.47924739, 22.33720864, 22.67633268]]), -7.780454741205453), (array([[-3.29524748, -3.29300945, -3.18327349, -3.59572686, -3.53644232],
       [23.14677447, 23.4818626 , 23.06558929, 22.9831716 , 23.20068438]]), -7.6762995718943445), (array([[-3.99166175, -4.32893436, -3.99070568, -3.70340572, -4.03587868],
       [22.93834414, 23.02700967, 23.36169202, 23.56857711, 23.69584829]]), -7.604664328035952), (array([[-3.98498693, -4.22765627, -4.48542218, -4.43566542, -4.66760733],
       [23.64169223, 23.16168013, 23.40735731, 23.57432676, 23.10198227]]), -6.568350983353652), (array([[-4.39818492, -4.38530037, -4.22447385, -3.78538425, -3.34411599],
       [23.50891296, 23.76185047, 24.1554807 , 24.52780273, 24.85789822]]), -6.19262765304702), (array([[-3.13468082, -3.51524078, -3.79879431, -3.78110325, -3.41151129],
       [25.02914794, 24.77464917, 24.34223406, 24.42764871, 24.17764443]]), -5.46310031892285), (array([[-3.34183324, -3.61893672, -3.29676007, -2.80630849, -3.07364776],
       [24.53540549, 24.52964003, 24.59842951, 24.35702558, 24.20540278]]), -6.051187063799889), (array([[-2.98687011, -2.90175401, -3.27531671, -3.67613024, -3.80195376],
       [24.37914378, 24.50157504, 24.18270408, 23.95427605, 23.56496286]]), -5.493738389014599), (array([[-3.98966685, -4.15217973, -4.21769424, -3.95707084, -4.36561478],
       [23.76255339, 23.33654524, 23.09244217, 23.07588277, 23.32655415]]), -5.348724152614961), (array([[-4.48804608, -4.31767492, -4.65003699, -4.50509254, -4.96764441],
       [23.3059766 , 23.7463175 , 24.20182645, 24.68991947, 24.84636513]]), -5.758086059379452), (array([[-5.35373271, -5.59257518, -5.47199333, -5.6245789 , -5.72411666],
       [25.08191235, 25.47544087, 25.40433603, 25.8718623 , 25.66723622]]), -5.480029839165996), (array([[-6.08823813, -6.1943644 , -5.97568914, -6.22946832, -6.33475194],
       [25.81757672, 25.61302831, 25.56607362, 26.01061393, 26.46191336]]), -4.882579505228651), (array([[-6.82642115, -6.94589101, -7.29422809, -7.7483686 , -7.59835944],
       [26.41499531, 26.8574832 , 27.26842068, 26.85303366, 26.58087871]]), -4.143147094429535), (array([[-7.94010266, -7.52235564, -7.92336365, -7.70377981, -7.38878834],
       [26.28384736, 25.88910941, 26.0716203 , 26.09077223, 25.6433296 ]]), -4.543960204026287), (array([[-7.19337136, -7.48453455, -7.33182499, -7.12605449, -7.15795505],
       [26.02637021, 25.78747475, 25.85592599, 25.81334444, 25.48097027]]), -4.9026066637977115), (array([[-7.37306773, -7.16301857, -6.89303563, -7.3183528 , -6.86939884],
       [25.43984798, 25.57748334, 26.01767461, 25.51888896, 25.63329669]]), -3.8753491615648685), (array([[-6.55828465, -6.49710737, -6.41058647, -6.82026799, -6.60478739],
       [25.48737243, 25.29235759, 25.58349629, 25.1620456 , 25.29981762]]), -3.563467940594194), (array([[-6.22371523, -5.90380383, -5.48944313, -5.71682191, -5.89562367],
       [25.31212025, 25.75336541, 25.46328783, 25.29471055, 25.71019702]]), -3.0714865800766478), (array([[-6.02447622, -6.43762574, -6.42328971, -6.67571857, -6.43735386],
       [25.33447932, 25.60234169, 25.56892798, 25.19691536, 25.5983231 ]]), -3.1618095116219744), (array([[-5.97379532, -5.81440919, -5.72053681, -6.19540778, -6.56473877],
       [25.29213473, 25.28401032, 25.54410105, 25.69014322, 25.67609818]]), -3.6082238044160304), (array([[-6.17676798, -5.92761372, -6.04689852, -6.42780651, -6.2077221 ],
       [25.31799051, 24.85370245, 25.14961202, 25.51531038, 25.91364943]]), -3.531866553776203), (array([[-5.74084509, -5.52073332, -5.2918041 , -5.23402908, -4.75518768],
       [25.45706107, 25.37942991, 25.28369952, 25.64797335, 25.18891076]]), -4.275288398323815), (array([[-4.89862273, -4.46524812, -4.69378172, -5.08281321, -4.89987064],
       [25.16049187, 25.55170713, 25.18081479, 24.9946815 , 24.71154608]]), -4.875594173550148), (array([[-4.69453776, -5.06747141, -5.35257861, -5.2967547 , -5.01537673],
       [25.17493928, 24.84210998, 25.07847074, 25.03466147, 25.2437131 ]]), -5.5832196220003), (array([[-5.2441835 , -5.53254535, -5.70990346, -5.34342245, -5.0670883 ],
       [25.4695713 , 25.66457792, 25.67843487, 25.44187683, 25.18943364]]), -6.547477174716793), (array([[-4.94427927, -4.787274  , -4.88587245, -5.35012292, -5.33872995],
       [25.27013746, 25.54310636, 25.50019719, 25.36021325, 25.35792317]]), -6.899053627056906), (array([[-5.50175529, -5.05215754, -5.38754666, -5.16908857, -5.57894423],
       [25.64557811, 26.09841536, 26.1787319 , 26.22835949, 26.36845532]]), -6.742839166577289), (array([[-5.61307689, -5.86834841, -6.16127792, -6.24356487, -6.64964963],
       [26.57976976, 26.73430651, 26.69795713, 26.97065404, 27.31965228]]), -6.508480219055803), (array([[-6.98540757, -7.1246031 , -7.53861298, -7.77955352, -8.21031575],
       [27.11120245, 27.42249471, 27.35501815, 26.99728212, 27.09285966]]), -6.552017531493048), (array([[-7.75979162, -7.60401386, -7.603477  , -7.19388643, -7.51820445],
       [27.15246311, 27.34055826, 27.53604311, 27.20760292, 26.87530065]]), -6.051657646853806), (array([[-7.17252577, -7.22120963, -6.84585722, -6.91956627, -7.17360009],
       [26.78566996, 27.03481938, 27.0561976 , 27.22907041, 27.06325342]]), -6.6988202537642385)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 3)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.450940</td>
      <td>-0.079363</td>
      <td>0.048017</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.565227</td>
      <td>-0.531070</td>
      <td>0.396526</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.522570</td>
      <td>-0.168394</td>
      <td>-0.007147</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.687103</td>
      <td>-0.383624</td>
      <td>-0.421329</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.227753</td>
      <td>-0.407378</td>
      <td>-0.612325</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>5.121781</td>
      <td>-0.799442</td>
      <td>-2.942670</td>
    </tr>
    <tr>
      <th>96</th>
      <td>4.651383</td>
      <td>-0.539178</td>
      <td>-3.004295</td>
    </tr>
    <tr>
      <th>97</th>
      <td>4.601473</td>
      <td>-0.486023</td>
      <td>-3.379333</td>
    </tr>
    <tr>
      <th>98</th>
      <td>4.622005</td>
      <td>-0.916231</td>
      <td>-3.149263</td>
    </tr>
    <tr>
      <th>99</th>
      <td>4.565455</td>
      <td>-0.886969</td>
      <td>-3.056059</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 3 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0.45093954,  0.56522721,  0.52256993,  0.6871029 ,  0.22775284],
       [-0.07936342, -0.53107008, -0.16839444, -0.38362401, -0.40737833]]), -0.6123250394182402), (array([[ 0.56522721,  0.52256993,  0.6871029 ,  0.22775284,  0.02982811],
       [-0.53107008, -0.16839444, -0.38362401, -0.40737833, -0.55089894]]), -0.7972566368623125), (array([[ 0.52256993,  0.6871029 ,  0.22775284,  0.02982811, -0.24221765],
       [-0.16839444, -0.38362401, -0.40737833, -0.55089894, -0.70311528]]), -0.5504236118656242), (array([[ 0.6871029 ,  0.22775284,  0.02982811, -0.24221765, -0.12556322],
       [-0.38362401, -0.40737833, -0.55089894, -0.70311528, -0.25393438]]), -0.4994975091311765), (array([[ 0.22775284,  0.02982811, -0.24221765, -0.12556322,  0.06174746],
       [-0.40737833, -0.55089894, -0.70311528, -0.25393438, -0.67202147]]), -0.08860360735659378), (array([[ 0.02982811, -0.24221765, -0.12556322,  0.06174746,  0.08199054],
       [-0.55089894, -0.70311528, -0.25393438, -0.67202147, -0.41404434]]), -0.2758006584559204), (array([[-0.24221765, -0.12556322,  0.06174746,  0.08199054, -0.18172228],
       [-0.70311528, -0.25393438, -0.67202147, -0.41404434, -0.58489504]]), 0.09031566845260275), (array([[-0.12556322,  0.06174746,  0.08199054, -0.18172228, -0.43910701],
       [-0.25393438, -0.67202147, -0.41404434, -0.58489504, -0.13109045]]), 0.14125921025638233), (array([[ 0.06174746,  0.08199054, -0.18172228, -0.43910701, -0.86771375],
       [-0.67202147, -0.41404434, -0.58489504, -0.13109045, -0.2841066 ]]), -0.12836368629075867), (array([[ 0.08199054, -0.18172228, -0.43910701, -0.86771375, -0.70978852],
       [-0.41404434, -0.58489504, -0.13109045, -0.2841066 , -0.27750284]]), -0.1712556849530481), (array([[-0.18172228, -0.43910701, -0.86771375, -0.70978852, -0.71232681],
       [-0.58489504, -0.13109045, -0.2841066 , -0.27750284, -0.31910022]]), -0.6700590207026536), (array([[-0.43910701, -0.86771375, -0.70978852, -0.71232681, -0.95899578],
       [-0.13109045, -0.2841066 , -0.27750284, -0.31910022,  0.09119878]]), -0.9648672938221693), (array([[-0.86771375, -0.70978852, -0.71232681, -0.95899578, -1.00838489],
       [-0.2841066 , -0.27750284, -0.31910022,  0.09119878, -0.1834282 ]]), -0.6648623810971889), (array([[-0.70978852, -0.71232681, -0.95899578, -1.00838489, -1.20812889],
       [-0.27750284, -0.31910022,  0.09119878, -0.1834282 ,  0.01768472]]), -0.790401173589271), (array([[-0.71232681, -0.95899578, -1.00838489, -1.20812889, -0.81042319],
       [-0.31910022,  0.09119878, -0.1834282 ,  0.01768472,  0.22161529]]), -1.1522125809628654), (array([[-0.95899578, -1.00838489, -1.20812889, -0.81042319, -1.10891437],
       [ 0.09119878, -0.1834282 ,  0.01768472,  0.22161529, -0.25057094]]), -0.8155970095053443), (array([[-1.00838489, -1.20812889, -0.81042319, -1.10891437, -1.46944899],
       [-0.1834282 ,  0.01768472,  0.22161529, -0.25057094, -0.4646524 ]]), -1.091907660094138), (array([[-1.20812889, -0.81042319, -1.10891437, -1.46944899, -1.52877286],
       [ 0.01768472,  0.22161529, -0.25057094, -0.4646524 , -0.65833687]]), -1.1453981737136751), (array([[-0.81042319, -1.10891437, -1.46944899, -1.52877286, -1.20863969],
       [ 0.22161529, -0.25057094, -0.4646524 , -0.65833687, -0.4071057 ]]), -1.2437432949141427), (array([[-1.10891437, -1.46944899, -1.52877286, -1.20863969, -0.88090743],
       [-0.25057094, -0.4646524 , -0.65833687, -0.4071057 , -0.03532818]]), -0.9335847855409803), (array([[-1.46944899, -1.52877286, -1.20863969, -0.88090743, -1.04875603],
       [-0.4646524 , -0.65833687, -0.4071057 , -0.03532818,  0.12287224]]), -1.0911389030368932), (array([[-1.52877286, -1.20863969, -0.88090743, -1.04875603, -0.6579692 ],
       [-0.65833687, -0.4071057 , -0.03532818,  0.12287224, -0.19599252]]), -1.0468878428467034), (array([[-1.20863969, -0.88090743, -1.04875603, -0.6579692 , -0.61075907],
       [-0.4071057 , -0.03532818,  0.12287224, -0.19599252,  0.04555569]]), -1.53721612385503), (array([[-0.88090743, -1.04875603, -0.6579692 , -0.61075907, -0.11258004],
       [-0.03532818,  0.12287224, -0.19599252,  0.04555569, -0.14987611]]), -1.725229809575413), (array([[-1.04875603, -0.6579692 , -0.61075907, -0.11258004, -0.38223653],
       [ 0.12287224, -0.19599252,  0.04555569, -0.14987611, -0.11898166]]), -1.7242405567932693), (array([[-0.6579692 , -0.61075907, -0.11258004, -0.38223653, -0.3261389 ],
       [-0.19599252,  0.04555569, -0.14987611, -0.11898166, -0.11417138]]), -1.720355713620969), (array([[-0.61075907, -0.11258004, -0.38223653, -0.3261389 , -0.26064058],
       [ 0.04555569, -0.14987611, -0.11898166, -0.11417138, -0.3472448 ]]), -1.2624608624706615), (array([[-0.11258004, -0.38223653, -0.3261389 , -0.26064058, -0.73365698],
       [-0.14987611, -0.11898166, -0.11417138, -0.3472448 , -0.54048323]]), -1.447862126796644), (array([[-0.38223653, -0.3261389 , -0.26064058, -0.73365698, -0.79791666],
       [-0.11898166, -0.11417138, -0.3472448 , -0.54048323, -0.92232442]]), -1.1794746719856857), (array([[-0.3261389 , -0.26064058, -0.73365698, -0.79791666, -0.48386464],
       [-0.11417138, -0.3472448 , -0.54048323, -0.92232442, -0.5570916 ]]), -1.4984596565583659), (array([[-0.26064058, -0.73365698, -0.79791666, -0.48386464, -0.03222901],
       [-0.3472448 , -0.54048323, -0.92232442, -0.5570916 , -0.46168689]]), -1.671617979726358), (array([[-0.73365698, -0.79791666, -0.48386464, -0.03222901,  0.41653119],
       [-0.54048323, -0.92232442, -0.5570916 , -0.46168689, -0.38848604]]), -1.374401714404634), (array([[-0.79791666, -0.48386464, -0.03222901,  0.41653119, -0.07601084],
       [-0.92232442, -0.5570916 , -0.46168689, -0.38848604, -0.73701928]]), -1.097450794508421), (array([[-0.48386464, -0.03222901,  0.41653119, -0.07601084, -0.05826335],
       [-0.5570916 , -0.46168689, -0.38848604, -0.73701928, -1.18364322]]), -1.3219729756455147), (array([[-0.03222901,  0.41653119, -0.07601084, -0.05826335,  0.24618051],
       [-0.46168689, -0.38848604, -0.73701928, -1.18364322, -1.43620132]]), -1.3239362366246719), (array([[ 0.41653119, -0.07601084, -0.05826335,  0.24618051,  0.62711561],
       [-0.38848604, -0.73701928, -1.18364322, -1.43620132, -1.83537638]]), -1.527027813476924), (array([[-0.07601084, -0.05826335,  0.24618051,  0.62711561,  1.10893231],
       [-0.73701928, -1.18364322, -1.43620132, -1.83537638, -1.9439923 ]]), -1.51007910535055), (array([[-0.05826335,  0.24618051,  0.62711561,  1.10893231,  1.5724398 ],
       [-1.18364322, -1.43620132, -1.83537638, -1.9439923 , -1.86352299]]), -1.124239681064524), (array([[ 0.24618051,  0.62711561,  1.10893231,  1.5724398 ,  1.0919984 ],
       [-1.43620132, -1.83537638, -1.9439923 , -1.86352299, -2.27399632]]), -1.5740388116836237), (array([[ 0.62711561,  1.10893231,  1.5724398 ,  1.0919984 ,  0.64083911],
       [-1.83537638, -1.9439923 , -1.86352299, -2.27399632, -1.88502263]]), -1.1380887829834523), (array([[ 1.10893231,  1.5724398 ,  1.0919984 ,  0.64083911,  0.84702302],
       [-1.9439923 , -1.86352299, -2.27399632, -1.88502263, -2.17003512]]), -0.8938398052309259), (array([[ 1.5724398 ,  1.0919984 ,  0.64083911,  0.84702302,  1.14383146],
       [-1.86352299, -2.27399632, -1.88502263, -2.17003512, -2.21142895]]), -0.5719362749782115), (array([[ 1.0919984 ,  0.64083911,  0.84702302,  1.14383146,  1.30485147],
       [-2.27399632, -1.88502263, -2.17003512, -2.21142895, -2.56026911]]), -0.9699206983539523), (array([[ 0.64083911,  0.84702302,  1.14383146,  1.30485147,  1.5985732 ],
       [-1.88502263, -2.17003512, -2.21142895, -2.56026911, -2.53877417]]), -1.1467501728332823), (array([[ 0.84702302,  1.14383146,  1.30485147,  1.5985732 ,  1.84269518],
       [-2.17003512, -2.21142895, -2.56026911, -2.53877417, -2.84532259]]), -1.0213110432329469), (array([[ 1.14383146,  1.30485147,  1.5985732 ,  1.84269518,  2.11887339],
       [-2.21142895, -2.56026911, -2.53877417, -2.84532259, -3.065191  ]]), -1.5122581818741914), (array([[ 1.30485147,  1.5985732 ,  1.84269518,  2.11887339,  1.9308898 ],
       [-2.56026911, -2.53877417, -2.84532259, -3.065191  , -2.60016573]]), -1.989274337638487), (array([[ 1.5985732 ,  1.84269518,  2.11887339,  1.9308898 ,  1.57374289],
       [-2.53877417, -2.84532259, -3.065191  , -2.60016573, -2.2800008 ]]), -2.227118947806132), (array([[ 1.84269518,  2.11887339,  1.9308898 ,  1.57374289,  1.88784762],
       [-2.84532259, -3.065191  , -2.60016573, -2.2800008 , -2.14572781]]), -2.4715668911814044), (array([[ 2.11887339,  1.9308898 ,  1.57374289,  1.88784762,  1.98587253],
       [-3.065191  , -2.60016573, -2.2800008 , -2.14572781, -2.12783091]]), -2.269542984399882), (array([[ 1.9308898 ,  1.57374289,  1.88784762,  1.98587253,  2.30174388],
       [-2.60016573, -2.2800008 , -2.14572781, -2.12783091, -2.38505874]]), -2.0189136101363463), (array([[ 1.57374289,  1.88784762,  1.98587253,  2.30174388,  2.68896214],
       [-2.2800008 , -2.14572781, -2.12783091, -2.38505874, -2.45992629]]), -2.2034291534737993), (array([[ 1.88784762,  1.98587253,  2.30174388,  2.68896214,  2.47076328],
       [-2.14572781, -2.12783091, -2.38505874, -2.45992629, -2.37370421]]), -2.3028318217322816), (array([[ 1.98587253,  2.30174388,  2.68896214,  2.47076328,  2.38773104],
       [-2.12783091, -2.38505874, -2.45992629, -2.37370421, -2.14706035]]), -1.9282761941373991), (array([[ 2.30174388,  2.68896214,  2.47076328,  2.38773104,  2.61713217],
       [-2.38505874, -2.45992629, -2.37370421, -2.14706035, -2.42225606]]), -2.2473755432175175), (array([[ 2.68896214,  2.47076328,  2.38773104,  2.61713217,  2.34852455],
       [-2.45992629, -2.37370421, -2.14706035, -2.42225606, -2.38144072]]), -2.102393997508051), (array([[ 2.47076328,  2.38773104,  2.61713217,  2.34852455,  2.06288788],
       [-2.37370421, -2.14706035, -2.42225606, -2.38144072, -1.98532136]]), -1.945530368883765), (array([[ 2.38773104,  2.61713217,  2.34852455,  2.06288788,  2.19977123],
       [-2.14706035, -2.42225606, -2.38144072, -1.98532136, -1.6488374 ]]), -1.6045109128765205), (array([[ 2.61713217,  2.34852455,  2.06288788,  2.19977123,  1.87324865],
       [-2.42225606, -2.38144072, -1.98532136, -1.6488374 , -1.93854902]]), -2.0572072953672724), (array([[ 2.34852455,  2.06288788,  2.19977123,  1.87324865,  2.00390486],
       [-2.38144072, -1.98532136, -1.6488374 , -1.93854902, -1.68625941]]), -1.7861467619187175), (array([[ 2.06288788,  2.19977123,  1.87324865,  2.00390486,  2.45621342],
       [-1.98532136, -1.6488374 , -1.93854902, -1.68625941, -1.2389302 ]]), -1.3380577846450128), (array([[ 2.19977123,  1.87324865,  2.00390486,  2.45621342,  2.5941222 ],
       [-1.6488374 , -1.93854902, -1.68625941, -1.2389302 , -0.75827474]]), -0.857390131823525), (array([[ 1.87324865,  2.00390486,  2.45621342,  2.5941222 ,  2.17276389],
       [-1.93854902, -1.68625941, -1.2389302 , -0.75827474, -1.11957752]]), -0.9462039522140382), (array([[ 2.00390486,  2.45621342,  2.5941222 ,  2.17276389,  2.56476586],
       [-1.68625941, -1.2389302 , -0.75827474, -1.11957752, -1.26351698]]), -0.8820577391637944), (array([[ 2.45621342,  2.5941222 ,  2.17276389,  2.56476586,  2.15536171],
       [-1.2389302 , -0.75827474, -1.11957752, -1.26351698, -0.76739464]]), -0.783933421975013), (array([[ 2.5941222 ,  2.17276389,  2.56476586,  2.15536171,  2.53855211],
       [-0.75827474, -1.11957752, -1.26351698, -0.76739464, -0.99013278]]), -1.1458224415359766), (array([[ 2.17276389,  2.56476586,  2.15536171,  2.53855211,  2.9330973 ],
       [-1.11957752, -1.26351698, -0.76739464, -0.99013278, -0.75465257]]), -1.0907329588741255), (array([[ 2.56476586,  2.15536171,  2.53855211,  2.9330973 ,  3.35529126],
       [-1.26351698, -0.76739464, -0.99013278, -0.75465257, -0.37465069]]), -1.5365503420688946), (array([[ 2.15536171,  2.53855211,  2.9330973 ,  3.35529126,  2.88863836],
       [-0.76739464, -0.99013278, -0.75465257, -0.37465069,  0.0841909 ]]), -1.73370126193853), (array([[ 2.53855211,  2.9330973 ,  3.35529126,  2.88863836,  2.46682495],
       [-0.99013278, -0.75465257, -0.37465069,  0.0841909 ,  0.35140427]]), -1.3776670856367086), (array([[ 2.9330973 ,  3.35529126,  2.88863836,  2.46682495,  2.47445969],
       [-0.75465257, -0.37465069,  0.0841909 ,  0.35140427,  0.02997354]]), -1.7085905522143188), (array([[ 3.35529126,  2.88863836,  2.46682495,  2.47445969,  2.97111105],
       [-0.37465069,  0.0841909 ,  0.35140427,  0.02997354, -0.3487123 ]]), -1.779525766111353), (array([[ 2.88863836,  2.46682495,  2.47445969,  2.97111105,  2.96841943],
       [ 0.0841909 ,  0.35140427,  0.02997354, -0.3487123 ,  0.04431986]]), -2.1673020271754773), (array([[ 2.46682495,  2.47445969,  2.97111105,  2.96841943,  3.00693012],
       [ 0.35140427,  0.02997354, -0.3487123 ,  0.04431986,  0.24151639]]), -2.661842078070922), (array([[ 2.47445969,  2.97111105,  2.96841943,  3.00693012,  2.6434838 ],
       [ 0.02997354, -0.3487123 ,  0.04431986,  0.24151639,  0.57008521]]), -2.8996263672379916), (array([[ 2.97111105,  2.96841943,  3.00693012,  2.6434838 ,  3.07539294],
       [-0.3487123 ,  0.04431986,  0.24151639,  0.57008521,  0.85936631]]), -2.551639640649128), (array([[2.96841943, 3.00693012, 2.6434838 , 3.07539294, 3.51771905],
       [0.04431986, 0.24151639, 0.57008521, 0.85936631, 0.67503424]]), -2.1541340674887475), (array([[3.00693012, 2.6434838 , 3.07539294, 3.51771905, 3.27730681],
       [0.24151639, 0.57008521, 0.85936631, 0.67503424, 0.26808168]]), -2.119698891857294), (array([[2.6434838 , 3.07539294, 3.51771905, 3.27730681, 3.39624627],
       [0.57008521, 0.85936631, 0.67503424, 0.26808168, 0.42589151]]), -2.349546209907128), (array([[3.07539294, 3.51771905, 3.27730681, 3.39624627, 3.8619691 ],
       [0.85936631, 0.67503424, 0.26808168, 0.42589151, 0.69036772]]), -2.2376241369082366), (array([[3.51771905, 3.27730681, 3.39624627, 3.8619691 , 3.98256414],
       [0.67503424, 0.26808168, 0.42589151, 0.69036772, 0.51361306]]), -1.9763758124900246), (array([[3.27730681, 3.39624627, 3.8619691 , 3.98256414, 4.28715734],
       [0.26808168, 0.42589151, 0.69036772, 0.51361306, 0.06740703]]), -2.129588933550755), (array([[3.39624627, 3.8619691 , 3.98256414, 4.28715734, 4.34472141],
       [0.42589151, 0.69036772, 0.51361306, 0.06740703, 0.23443379]]), -2.344825627244972), (array([[3.8619691 , 3.98256414, 4.28715734, 4.34472141, 3.88159302],
       [0.69036772, 0.51361306, 0.06740703, 0.23443379, 0.42865487]]), -2.0510368576548483), (array([[3.98256414, 4.28715734, 4.34472141, 3.88159302, 3.97372232],
       [0.51361306, 0.06740703, 0.23443379, 0.42865487, 0.01404333]]), -2.3654709957759676), (array([[ 4.28715734,  4.34472141,  3.88159302,  3.97372232,  3.95814452],
       [ 0.06740703,  0.23443379,  0.42865487,  0.01404333, -0.46003376]]), -2.371137357314489), (array([[ 4.34472141,  3.88159302,  3.97372232,  3.95814452,  4.44333551],
       [ 0.23443379,  0.42865487,  0.01404333, -0.46003376, -0.15064681]]), -2.3609112018784444), (array([[ 3.88159302,  3.97372232,  3.95814452,  4.44333551,  4.88045015],
       [ 0.42865487,  0.01404333, -0.46003376, -0.15064681, -0.52181889]]), -2.3867790250844605), (array([[ 3.97372232,  3.95814452,  4.44333551,  4.88045015,  4.99762043],
       [ 0.01404333, -0.46003376, -0.15064681, -0.52181889, -0.45850427]]), -2.447630982810877), (array([[ 3.95814452,  4.44333551,  4.88045015,  4.99762043,  4.56171171],
       [-0.46003376, -0.15064681, -0.52181889, -0.45850427, -0.07811753]]), -2.157062980472999), (array([[ 4.44333551,  4.88045015,  4.99762043,  4.56171171,  5.00978284],
       [-0.15064681, -0.52181889, -0.45850427, -0.07811753, -0.42022546]]), -2.5385119253957695), (array([[ 4.88045015,  4.99762043,  4.56171171,  5.00978284,  5.12178078],
       [-0.52181889, -0.45850427, -0.07811753, -0.42022546, -0.7994424 ]]), -2.94267021853886), (array([[ 4.99762043,  4.56171171,  5.00978284,  5.12178078,  4.65138331],
       [-0.45850427, -0.07811753, -0.42022546, -0.7994424 , -0.53917771]]), -3.004295297740131), (array([[ 4.56171171,  5.00978284,  5.12178078,  4.65138331,  4.60147273],
       [-0.07811753, -0.42022546, -0.7994424 , -0.53917771, -0.48602326]]), -3.3793327711787873), (array([[ 5.00978284,  5.12178078,  4.65138331,  4.60147273,  4.62200545],
       [-0.42022546, -0.7994424 , -0.53917771, -0.48602326, -0.91623123]]), -3.149263335435539), (array([[ 5.12178078,  4.65138331,  4.60147273,  4.62200545,  4.56545458],
       [-0.7994424 , -0.53917771, -0.48602326, -0.91623123, -0.88696891]]), -3.0560592070893904)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.457024</td>
      <td>0.260131</td>
      <td>0.376726</td>
      <td>0.315398</td>
      <td>-0.181542</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.881217</td>
      <td>0.622510</td>
      <td>0.026848</td>
      <td>0.346502</td>
      <td>-0.321103</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.066345</td>
      <td>0.634793</td>
      <td>-0.432956</td>
      <td>-0.005597</td>
      <td>0.143361</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.309965</td>
      <td>0.649062</td>
      <td>-0.099378</td>
      <td>-0.196240</td>
      <td>0.381161</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.008075</td>
      <td>0.948012</td>
      <td>0.077149</td>
      <td>-0.478900</td>
      <td>-0.100931</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1.966447</td>
      <td>0.658435</td>
      <td>1.323134</td>
      <td>2.429247</td>
      <td>-3.346599</td>
    </tr>
    <tr>
      <th>96</th>
      <td>1.621995</td>
      <td>1.001670</td>
      <td>1.565957</td>
      <td>2.682984</td>
      <td>-3.313887</td>
    </tr>
    <tr>
      <th>97</th>
      <td>1.428081</td>
      <td>0.594941</td>
      <td>1.192556</td>
      <td>2.425054</td>
      <td>-3.173126</td>
    </tr>
    <tr>
      <th>98</th>
      <td>1.504971</td>
      <td>0.267231</td>
      <td>1.602113</td>
      <td>2.440307</td>
      <td>-3.185286</td>
    </tr>
    <tr>
      <th>99</th>
      <td>1.986499</td>
      <td>0.682667</td>
      <td>1.266755</td>
      <td>2.851613</td>
      <td>-3.195599</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[-0.45702387, -0.8812171 , -1.06634466, -1.30996493, -1.00807496],
       [ 0.26013056,  0.62251027,  0.63479316,  0.64906217,  0.94801167],
       [ 0.37672584,  0.02684818, -0.43295627, -0.09937805,  0.07714853],
       [ 0.31539801,  0.34650237, -0.00559674, -0.19624013, -0.47889999]]), -0.10093073254185703), (array([[-0.8812171 , -1.06634466, -1.30996493, -1.00807496, -0.62353694],
       [ 0.62251027,  0.63479316,  0.64906217,  0.94801167,  0.70023757],
       [ 0.02684818, -0.43295627, -0.09937805,  0.07714853,  0.25369689],
       [ 0.34650237, -0.00559674, -0.19624013, -0.47889999, -0.25468658]]), -0.0885995422592546), (array([[-1.06634466, -1.30996493, -1.00807496, -0.62353694, -0.92511232],
       [ 0.63479316,  0.64906217,  0.94801167,  0.70023757,  1.07405838],
       [-0.43295627, -0.09937805,  0.07714853,  0.25369689,  0.74063379],
       [-0.00559674, -0.19624013, -0.47889999, -0.25468658, -0.62969819]]), 0.3989613828913807), (array([[-1.30996493, -1.00807496, -0.62353694, -0.92511232, -0.4853745 ],
       [ 0.64906217,  0.94801167,  0.70023757,  1.07405838,  0.60214343],
       [-0.09937805,  0.07714853,  0.25369689,  0.74063379,  0.65234401],
       [-0.19624013, -0.47889999, -0.25468658, -0.62969819, -0.43368925]]), 0.524497654751311), (array([[-1.00807496, -0.62353694, -0.92511232, -0.4853745 , -0.93602071],
       [ 0.94801167,  0.70023757,  1.07405838,  0.60214343,  0.59394526],
       [ 0.07714853,  0.25369689,  0.74063379,  0.65234401,  0.86890952],
       [-0.47889999, -0.25468658, -0.62969819, -0.43368925, -0.12541609]]), 0.3626744227875752), (array([[-0.62353694, -0.92511232, -0.4853745 , -0.93602071, -0.84271917],
       [ 0.70023757,  1.07405838,  0.60214343,  0.59394526,  0.65187427],
       [ 0.25369689,  0.74063379,  0.65234401,  0.86890952,  0.55693921],
       [-0.25468658, -0.62969819, -0.43368925, -0.12541609, -0.1202045 ]]), 0.5044677666918177), (array([[-0.92511232, -0.4853745 , -0.93602071, -0.84271917, -1.0127883 ],
       [ 1.07405838,  0.60214343,  0.59394526,  0.65187427,  0.63406438],
       [ 0.74063379,  0.65234401,  0.86890952,  0.55693921,  0.81656999],
       [-0.62969819, -0.43368925, -0.12541609, -0.1202045 , -0.41276979]]), 0.44912081578663654), (array([[-0.4853745 , -0.93602071, -0.84271917, -1.0127883 , -1.2511057 ],
       [ 0.60214343,  0.59394526,  0.65187427,  0.63406438,  0.64700265],
       [ 0.65234401,  0.86890952,  0.55693921,  0.81656999,  0.49055681],
       [-0.43368925, -0.12541609, -0.1202045 , -0.41276979, -0.16017889]]), 0.6063065354309719), (array([[-0.93602071, -0.84271917, -1.0127883 , -1.2511057 , -1.74482093],
       [ 0.59394526,  0.65187427,  0.63406438,  0.64700265,  0.81159927],
       [ 0.86890952,  0.55693921,  0.81656999,  0.49055681,  0.93270714],
       [-0.12541609, -0.1202045 , -0.41276979, -0.16017889, -0.25875221]]), 0.5345035712136246), (array([[-0.84271917, -1.0127883 , -1.2511057 , -1.74482093, -1.5552799 ],
       [ 0.65187427,  0.63406438,  0.64700265,  0.81159927,  0.42888959],
       [ 0.55693921,  0.81656999,  0.49055681,  0.93270714,  1.40070978],
       [-0.1202045 , -0.41276979, -0.16017889, -0.25875221, -0.4564288 ]]), 0.47883568037073676), (array([[-1.01278830e+00, -1.25110570e+00, -1.74482093e+00,
        -1.55527990e+00, -1.18410299e+00],
       [ 6.34064382e-01,  6.47002649e-01,  8.11599270e-01,
         4.28889591e-01,  4.66575240e-01],
       [ 8.16569995e-01,  4.90556812e-01,  9.32707140e-01,
         1.40070978e+00,  1.30970065e+00],
       [-4.12769786e-01, -1.60178893e-01, -2.58752214e-01,
        -4.56428799e-01,  1.15058835e-03]]), 0.291977925961487), (array([[-1.25110570e+00, -1.74482093e+00, -1.55527990e+00,
        -1.18410299e+00, -1.66906232e+00],
       [ 6.47002649e-01,  8.11599270e-01,  4.28889591e-01,
         4.66575240e-01,  4.85828829e-01],
       [ 4.90556812e-01,  9.32707140e-01,  1.40070978e+00,
         1.30970065e+00,  1.45968686e+00],
       [-1.60178893e-01, -2.58752214e-01, -4.56428799e-01,
         1.15058835e-03, -2.60380610e-01]]), 0.1657069629960496), (array([[-1.74482093e+00, -1.55527990e+00, -1.18410299e+00,
        -1.66906232e+00, -2.08695017e+00],
       [ 8.11599270e-01,  4.28889591e-01,  4.66575240e-01,
         4.85828829e-01,  6.59163405e-01],
       [ 9.32707140e-01,  1.40070978e+00,  1.30970065e+00,
         1.45968686e+00,  1.34918676e+00],
       [-2.58752214e-01, -4.56428799e-01,  1.15058835e-03,
        -2.60380610e-01, -1.34388895e-01]]), -0.08161014267775346), (array([[-1.55527990e+00, -1.18410299e+00, -1.66906232e+00,
        -2.08695017e+00, -2.30567189e+00],
       [ 4.28889591e-01,  4.66575240e-01,  4.85828829e-01,
         6.59163405e-01,  9.40624997e-01],
       [ 1.40070978e+00,  1.30970065e+00,  1.45968686e+00,
         1.34918676e+00,  1.08445877e+00],
       [-4.56428799e-01,  1.15058835e-03, -2.60380610e-01,
        -1.34388895e-01, -7.65059068e-03]]), -0.31662220355894166), (array([[-1.18410299e+00, -1.66906232e+00, -2.08695017e+00,
        -2.30567189e+00, -2.59423278e+00],
       [ 4.66575240e-01,  4.85828829e-01,  6.59163405e-01,
         9.40624997e-01,  1.38804048e+00],
       [ 1.30970065e+00,  1.45968686e+00,  1.34918676e+00,
         1.08445877e+00,  1.41179261e+00],
       [ 1.15058835e-03, -2.60380610e-01, -1.34388895e-01,
        -7.65059068e-03, -3.66509336e-01]]), -0.7740518355050797), (array([[-1.66906232, -2.08695017, -2.30567189, -2.59423278, -2.25826739],
       [ 0.48582883,  0.65916341,  0.940625  ,  1.38804048,  1.84941362],
       [ 1.45968686,  1.34918676,  1.08445877,  1.41179261,  1.86361327],
       [-0.26038061, -0.1343889 , -0.00765059, -0.36650934,  0.08920372]]), -1.1079934401220737), (array([[-2.08695017, -2.30567189, -2.59423278, -2.25826739, -1.94250711],
       [ 0.65916341,  0.940625  ,  1.38804048,  1.84941362,  1.41459373],
       [ 1.34918676,  1.08445877,  1.41179261,  1.86361327,  1.87806879],
       [-0.1343889 , -0.00765059, -0.36650934,  0.08920372, -0.19458965]]), -0.752038154067038), (array([[-2.30567189, -2.59423278, -2.25826739, -1.94250711, -1.49032249],
       [ 0.940625  ,  1.38804048,  1.84941362,  1.41459373,  1.18651787],
       [ 1.08445877,  1.41179261,  1.86361327,  1.87806879,  1.87105368],
       [-0.00765059, -0.36650934,  0.08920372, -0.19458965, -0.02574022]]), -1.1103574140889036), (array([[-2.59423278, -2.25826739, -1.94250711, -1.49032249, -1.67064662],
       [ 1.38804048,  1.84941362,  1.41459373,  1.18651787,  1.25904353],
       [ 1.41179261,  1.86361327,  1.87806879,  1.87105368,  1.90118622],
       [-0.36650934,  0.08920372, -0.19458965, -0.02574022,  0.42608487]]), -1.219486192033957), (array([[-2.25826739, -1.94250711, -1.49032249, -1.67064662, -1.37787994],
       [ 1.84941362,  1.41459373,  1.18651787,  1.25904353,  1.07109538],
       [ 1.86361327,  1.87806879,  1.87105368,  1.90118622,  2.31519163],
       [ 0.08920372, -0.19458965, -0.02574022,  0.42608487,  0.28582524]]), -0.7277280137767699), (array([[-1.94250711, -1.49032249, -1.67064662, -1.37787994, -0.89636401],
       [ 1.41459373,  1.18651787,  1.25904353,  1.07109538,  0.57918177],
       [ 1.87806879,  1.87105368,  1.90118622,  2.31519163,  2.41908586],
       [-0.19458965, -0.02574022,  0.42608487,  0.28582524, -0.01788943]]), -0.6363922329877048), (array([[-1.49032249, -1.67064662, -1.37787994, -0.89636401, -0.95392317],
       [ 1.18651787,  1.25904353,  1.07109538,  0.57918177,  1.05641229],
       [ 1.87105368,  1.90118622,  2.31519163,  2.41908586,  2.56022798],
       [-0.02574022,  0.42608487,  0.28582524, -0.01788943,  0.14332537]]), -0.783247815666644), (array([[-1.67064662, -1.37787994, -0.89636401, -0.95392317, -1.17984308],
       [ 1.25904353,  1.07109538,  0.57918177,  1.05641229,  0.9841678 ],
       [ 1.90118622,  2.31519163,  2.41908586,  2.56022798,  2.86708811],
       [ 0.42608487,  0.28582524, -0.01788943,  0.14332537,  0.25296089]]), -1.04426723699589), (array([[-1.37787994, -0.89636401, -0.95392317, -1.17984308, -1.56073391],
       [ 1.07109538,  0.57918177,  1.05641229,  0.9841678 ,  1.09528612],
       [ 2.31519163,  2.41908586,  2.56022798,  2.86708811,  2.53766892],
       [ 0.28582524, -0.01788943,  0.14332537,  0.25296089,  0.2513189 ]]), -1.4582249331565833), (array([[-0.89636401, -0.95392317, -1.17984308, -1.56073391, -1.10823523],
       [ 0.57918177,  1.05641229,  0.9841678 ,  1.09528612,  0.93399747],
       [ 2.41908586,  2.56022798,  2.86708811,  2.53766892,  2.36864462],
       [-0.01788943,  0.14332537,  0.25296089,  0.2513189 , -0.04244919]]), -1.4733848054618743), (array([[-0.95392317, -1.17984308, -1.56073391, -1.10823523, -0.71425137],
       [ 1.05641229,  0.9841678 ,  1.09528612,  0.93399747,  0.98979679],
       [ 2.56022798,  2.86708811,  2.53766892,  2.36864462,  2.79589277],
       [ 0.14332537,  0.25296089,  0.2513189 , -0.04244919,  0.27756616]]), -1.9239693493452625), (array([[-1.17984308, -1.56073391, -1.10823523, -0.71425137, -1.07939505],
       [ 0.9841678 ,  1.09528612,  0.93399747,  0.98979679,  1.24513069],
       [ 2.86708811,  2.53766892,  2.36864462,  2.79589277,  3.21491642],
       [ 0.25296089,  0.2513189 , -0.04244919,  0.27756616,  0.00542819]]), -2.191770225467195), (array([[-1.56073391, -1.10823523, -0.71425137, -1.07939505, -0.9221867 ],
       [ 1.09528612,  0.93399747,  0.98979679,  1.24513069,  1.25842471],
       [ 2.53766892,  2.36864462,  2.79589277,  3.21491642,  2.80235423],
       [ 0.2513189 , -0.04244919,  0.27756616,  0.00542819,  0.33919275]]), -2.2105519255440793), (array([[-1.10823523, -0.71425137, -1.07939505, -0.9221867 , -0.52145136],
       [ 0.93399747,  0.98979679,  1.24513069,  1.25842471,  0.82347378],
       [ 2.36864462,  2.79589277,  3.21491642,  2.80235423,  2.66975432],
       [-0.04244919,  0.27756616,  0.00542819,  0.33919275,  0.15450232]]), -2.1974078931569627), (array([[-0.71425137, -1.07939505, -0.9221867 , -0.52145136, -0.34007411],
       [ 0.98979679,  1.24513069,  1.25842471,  0.82347378,  0.84509794],
       [ 2.79589277,  3.21491642,  2.80235423,  2.66975432,  2.46176224],
       [ 0.27756616,  0.00542819,  0.33919275,  0.15450232, -0.19786368]]), -1.9519987739142377), (array([[-1.07939505, -0.9221867 , -0.52145136, -0.34007411, -0.46058241],
       [ 1.24513069,  1.25842471,  0.82347378,  0.84509794,  1.27564678],
       [ 3.21491642,  2.80235423,  2.66975432,  2.46176224,  2.51432498],
       [ 0.00542819,  0.33919275,  0.15450232, -0.19786368, -0.33296572]]), -1.8298310602484098), (array([[-0.9221867 , -0.52145136, -0.34007411, -0.46058241, -0.87940114],
       [ 1.25842471,  0.82347378,  0.84509794,  1.27564678,  1.15309509],
       [ 2.80235423,  2.66975432,  2.46176224,  2.51432498,  2.27609387],
       [ 0.33919275,  0.15450232, -0.19786368, -0.33296572, -0.29522671]]), -1.4418724472600635), (array([[-0.52145136, -0.34007411, -0.46058241, -0.87940114, -0.4239064 ],
       [ 0.82347378,  0.84509794,  1.27564678,  1.15309509,  0.68442948],
       [ 2.66975432,  2.46176224,  2.51432498,  2.27609387,  1.83788657],
       [ 0.15450232, -0.19786368, -0.33296572, -0.29522671,  0.12343043]]), -1.466402722455336), (array([[-0.34007411, -0.46058241, -0.87940114, -0.4239064 , -0.33699598],
       [ 0.84509794,  1.27564678,  1.15309509,  0.68442948,  0.655622  ],
       [ 2.46176224,  2.51432498,  2.27609387,  1.83788657,  1.38778362],
       [-0.19786368, -0.33296572, -0.29522671,  0.12343043,  0.4919143 ]]), -1.9153556406690728), (array([[-0.46058241, -0.87940114, -0.4239064 , -0.33699598,  0.10873248],
       [ 1.27564678,  1.15309509,  0.68442948,  0.655622  ,  1.11366997],
       [ 2.51432498,  2.27609387,  1.83788657,  1.38778362,  1.2598256 ],
       [-0.33296572, -0.29522671,  0.12343043,  0.4919143 ,  0.5082353 ]]), -2.28083114225972), (array([[-0.87940114, -0.4239064 , -0.33699598,  0.10873248,  0.21184819],
       [ 1.15309509,  0.68442948,  0.655622  ,  1.11366997,  0.68594369],
       [ 2.27609387,  1.83788657,  1.38778362,  1.2598256 ,  1.57400641],
       [-0.29522671,  0.12343043,  0.4919143 ,  0.5082353 ,  0.20266647]]), -2.457068954858677), (array([[-0.4239064 , -0.33699598,  0.10873248,  0.21184819,  0.41795076],
       [ 0.68442948,  0.655622  ,  1.11366997,  0.68594369,  0.33553434],
       [ 1.83788657,  1.38778362,  1.2598256 ,  1.57400641,  1.82775381],
       [ 0.12343043,  0.4919143 ,  0.5082353 ,  0.20266647,  0.31266218]]), -2.6562917932625836), (array([[-0.33699598,  0.10873248,  0.21184819,  0.41795076,  0.60101781],
       [ 0.655622  ,  1.11366997,  0.68594369,  0.33553434,  0.02972551],
       [ 1.38778362,  1.2598256 ,  1.57400641,  1.82775381,  1.85736588],
       [ 0.4919143 ,  0.5082353 ,  0.20266647,  0.31266218,  0.61384275]]), -2.4914767910308475), (array([[ 0.10873248,  0.21184819,  0.41795076,  0.60101781,  0.36713936],
       [ 1.11366997,  0.68594369,  0.33553434,  0.02972551, -0.19690031],
       [ 1.2598256 ,  1.57400641,  1.82775381,  1.85736588,  1.4353241 ],
       [ 0.5082353 ,  0.20266647,  0.31266218,  0.61384275,  0.88203113]]), -2.348431963587013), (array([[ 0.21184819,  0.41795076,  0.60101781,  0.36713936,  0.62725564],
       [ 0.68594369,  0.33553434,  0.02972551, -0.19690031,  0.23426238],
       [ 1.57400641,  1.82775381,  1.85736588,  1.4353241 ,  1.06497457],
       [ 0.20266647,  0.31266218,  0.61384275,  0.88203113,  0.52553154]]), -2.2902321149643816), (array([[ 0.41795076,  0.60101781,  0.36713936,  0.62725564,  0.58296305],
       [ 0.33553434,  0.02972551, -0.19690031,  0.23426238,  0.28419834],
       [ 1.82775381,  1.85736588,  1.4353241 ,  1.06497457,  1.23034811],
       [ 0.31266218,  0.61384275,  0.88203113,  0.52553154,  0.62333346]]), -1.8881453799248522), (array([[ 0.60101781,  0.36713936,  0.62725564,  0.58296305,  0.74279841],
       [ 0.02972551, -0.19690031,  0.23426238,  0.28419834,  0.66952119],
       [ 1.85736588,  1.4353241 ,  1.06497457,  1.23034811,  1.65287058],
       [ 0.61384275,  0.88203113,  0.52553154,  0.62333346,  0.21155534]]), -2.360185910675619), (array([[ 0.36713936,  0.62725564,  0.58296305,  0.74279841,  0.35719233],
       [-0.19690031,  0.23426238,  0.28419834,  0.66952119,  0.41138884],
       [ 1.4353241 ,  1.06497457,  1.23034811,  1.65287058,  1.38426926],
       [ 0.88203113,  0.52553154,  0.62333346,  0.21155534,  0.15187493]]), -2.82868557814696), (array([[ 0.62725564,  0.58296305,  0.74279841,  0.35719233,  0.22884388],
       [ 0.23426238,  0.28419834,  0.66952119,  0.41138884,  0.68210558],
       [ 1.06497457,  1.23034811,  1.65287058,  1.38426926,  1.56056333],
       [ 0.52553154,  0.62333346,  0.21155534,  0.15187493, -0.01531477]]), -3.002303819750998), (array([[ 0.58296305,  0.74279841,  0.35719233,  0.22884388,  0.37211699],
       [ 0.28419834,  0.66952119,  0.41138884,  0.68210558,  0.66227959],
       [ 1.23034811,  1.65287058,  1.38426926,  1.56056333,  1.47694386],
       [ 0.62333346,  0.21155534,  0.15187493, -0.01531477,  0.05068926]]), -2.5303303021474375), (array([[ 0.74279841,  0.35719233,  0.22884388,  0.37211699, -0.08262842],
       [ 0.66952119,  0.41138884,  0.68210558,  0.66227959,  0.82957036],
       [ 1.65287058,  1.38426926,  1.56056333,  1.47694386,  1.61398266],
       [ 0.21155534,  0.15187493, -0.01531477,  0.05068926,  0.36143609]]), -2.071616818062092), (array([[ 0.35719233,  0.22884388,  0.37211699, -0.08262842, -0.37955661],
       [ 0.41138884,  0.68210558,  0.66227959,  0.82957036,  1.0382231 ],
       [ 1.38426926,  1.56056333,  1.47694386,  1.61398266,  1.56912154],
       [ 0.15187493, -0.01531477,  0.05068926,  0.36143609, -0.05698105]]), -2.4673793481805744), (array([[ 0.22884388,  0.37211699, -0.08262842, -0.37955661, -0.18486623],
       [ 0.68210558,  0.66227959,  0.82957036,  1.0382231 ,  1.33563197],
       [ 1.56056333,  1.47694386,  1.61398266,  1.56912154,  1.8449045 ],
       [-0.01531477,  0.05068926,  0.36143609, -0.05698105,  0.38979839]]), -2.4267842410429052), (array([[ 0.37211699, -0.08262842, -0.37955661, -0.18486623,  0.04551415],
       [ 0.66227959,  0.82957036,  1.0382231 ,  1.33563197,  1.6964805 ],
       [ 1.47694386,  1.61398266,  1.56912154,  1.8449045 ,  1.85494805],
       [ 0.05068926,  0.36143609, -0.05698105,  0.38979839,  0.66444122]]), -1.9808104200933259), (array([[-0.08262842, -0.37955661, -0.18486623,  0.04551415,  0.41008295],
       [ 0.82957036,  1.0382231 ,  1.33563197,  1.6964805 ,  1.59029804],
       [ 1.61398266,  1.56912154,  1.8449045 ,  1.85494805,  2.13104316],
       [ 0.36143609, -0.05698105,  0.38979839,  0.66444122,  0.612829  ]]), -1.734771323104269), (array([[-0.37955661, -0.18486623,  0.04551415,  0.41008295,  0.29243355],
       [ 1.0382231 ,  1.33563197,  1.6964805 ,  1.59029804,  1.31334833],
       [ 1.56912154,  1.8449045 ,  1.85494805,  2.13104316,  2.35334261],
       [-0.05698105,  0.38979839,  0.66444122,  0.612829  ,  0.75262939]]), -1.9184113496418702), (array([[-0.18486623,  0.04551415,  0.41008295,  0.29243355,  0.23960526],
       [ 1.33563197,  1.6964805 ,  1.59029804,  1.31334833,  1.33584277],
       [ 1.8449045 ,  1.85494805,  2.13104316,  2.35334261,  2.46141792],
       [ 0.38979839,  0.66444122,  0.612829  ,  0.75262939,  1.00582712]]), -1.5047088903620884), (array([[0.04551415, 0.41008295, 0.29243355, 0.23960526, 0.0966754 ],
       [1.6964805 , 1.59029804, 1.31334833, 1.33584277, 1.69243086],
       [1.85494805, 2.13104316, 2.35334261, 2.46141792, 2.82871217],
       [0.66444122, 0.612829  , 0.75262939, 1.00582712, 1.41457097]]), -1.514829873948154), (array([[0.41008295, 0.29243355, 0.23960526, 0.0966754 , 0.0109381 ],
       [1.59029804, 1.31334833, 1.33584277, 1.69243086, 1.92667678],
       [2.13104316, 2.35334261, 2.46141792, 2.82871217, 2.34368219],
       [0.612829  , 0.75262939, 1.00582712, 1.41457097, 1.72967313]]), -1.20900993950462), (array([[0.29243355, 0.23960526, 0.0966754 , 0.0109381 , 0.3022459 ],
       [1.31334833, 1.33584277, 1.69243086, 1.92667678, 1.80727205],
       [2.35334261, 2.46141792, 2.82871217, 2.34368219, 1.89566216],
       [0.75262939, 1.00582712, 1.41457097, 1.72967313, 1.32770001]]), -1.429195825865555), (array([[ 0.23960526,  0.0966754 ,  0.0109381 ,  0.3022459 , -0.1138463 ],
       [ 1.33584277,  1.69243086,  1.92667678,  1.80727205,  1.96688808],
       [ 2.46141792,  2.82871217,  2.34368219,  1.89566216,  1.39832629],
       [ 1.00582712,  1.41457097,  1.72967313,  1.32770001,  1.00669918]]), -1.7884801278709592), (array([[ 0.0966754 ,  0.0109381 ,  0.3022459 , -0.1138463 ,  0.33276288],
       [ 1.69243086,  1.92667678,  1.80727205,  1.96688808,  1.68042448],
       [ 2.82871217,  2.34368219,  1.89566216,  1.39832629,  1.29974844],
       [ 1.41457097,  1.72967313,  1.32770001,  1.00669918,  1.14970632]]), -2.197329596260456), (array([[ 0.0109381 ,  0.3022459 , -0.1138463 ,  0.33276288,  0.62708048],
       [ 1.92667678,  1.80727205,  1.96688808,  1.68042448,  1.49295315],
       [ 2.34368219,  1.89566216,  1.39832629,  1.29974844,  1.60823787],
       [ 1.72967313,  1.32770001,  1.00669918,  1.14970632,  0.68276606]]), -1.8017436087636338), (array([[ 0.3022459 , -0.1138463 ,  0.33276288,  0.62708048,  0.89764576],
       [ 1.80727205,  1.96688808,  1.68042448,  1.49295315,  1.7633147 ],
       [ 1.89566216,  1.39832629,  1.29974844,  1.60823787,  1.10887136],
       [ 1.32770001,  1.00669918,  1.14970632,  0.68276606,  0.80485431]]), -1.9911224286763987), (array([[-0.1138463 ,  0.33276288,  0.62708048,  0.89764576,  1.18678419],
       [ 1.96688808,  1.68042448,  1.49295315,  1.7633147 ,  2.02479811],
       [ 1.39832629,  1.29974844,  1.60823787,  1.10887136,  1.5323322 ],
       [ 1.00669918,  1.14970632,  0.68276606,  0.80485431,  0.77310011]]), -2.3241185783469436), (array([[0.33276288, 0.62708048, 0.89764576, 1.18678419, 1.2028143 ],
       [1.68042448, 1.49295315, 1.7633147 , 2.02479811, 2.40012319],
       [1.29974844, 1.60823787, 1.10887136, 1.5323322 , 1.06064847],
       [1.14970632, 0.68276606, 0.80485431, 0.77310011, 0.55403455]]), -2.412397783499289), (array([[0.62708048, 0.89764576, 1.18678419, 1.2028143 , 1.23018328],
       [1.49295315, 1.7633147 , 2.02479811, 2.40012319, 2.45196978],
       [1.60823787, 1.10887136, 1.5323322 , 1.06064847, 1.31742404],
       [0.68276606, 0.80485431, 0.77310011, 0.55403455, 0.5973333 ]]), -2.3469359522930686), (array([[0.89764576, 1.18678419, 1.2028143 , 1.23018328, 1.28007841],
       [1.7633147 , 2.02479811, 2.40012319, 2.45196978, 2.80106115],
       [1.10887136, 1.5323322 , 1.06064847, 1.31742404, 1.49342242],
       [0.80485431, 0.77310011, 0.55403455, 0.5973333 , 0.68619368]]), -1.9492397452379828), (array([[1.18678419, 1.2028143 , 1.23018328, 1.28007841, 1.40953341],
       [2.02479811, 2.40012319, 2.45196978, 2.80106115, 2.36031353],
       [1.5323322 , 1.06064847, 1.31742404, 1.49342242, 1.76235148],
       [0.77310011, 0.55403455, 0.5973333 , 0.68619368, 0.40190412]]), -1.5210163052614463), (array([[1.2028143 , 1.23018328, 1.28007841, 1.40953341, 1.53503724],
       [2.40012319, 2.45196978, 2.80106115, 2.36031353, 2.07088312],
       [1.06064847, 1.31742404, 1.49342242, 1.76235148, 1.65889281],
       [0.55403455, 0.5973333 , 0.68619368, 0.40190412, 0.72239312]]), -1.6947267088624334), (array([[1.23018328, 1.28007841, 1.40953341, 1.53503724, 1.33397349],
       [2.45196978, 2.80106115, 2.36031353, 2.07088312, 1.65089481],
       [1.31742404, 1.49342242, 1.76235148, 1.65889281, 1.80496275],
       [0.5973333 , 0.68619368, 0.40190412, 0.72239312, 0.70197236]]), -2.063566583666319), (array([[1.28007841, 1.40953341, 1.53503724, 1.33397349, 0.87072261],
       [2.80106115, 2.36031353, 2.07088312, 1.65089481, 1.39398449],
       [1.49342242, 1.76235148, 1.65889281, 1.80496275, 1.80432031],
       [0.68619368, 0.40190412, 0.72239312, 0.70197236, 0.3248581 ]]), -2.4607596167671795), (array([[1.40953341, 1.53503724, 1.33397349, 0.87072261, 0.74243496],
       [2.36031353, 2.07088312, 1.65089481, 1.39398449, 1.0483149 ],
       [1.76235148, 1.65889281, 1.80496275, 1.80432031, 2.2947466 ],
       [0.40190412, 0.72239312, 0.70197236, 0.3248581 , 0.45959608]]), -2.3435566902164706), (array([[1.53503724, 1.33397349, 0.87072261, 0.74243496, 0.80140492],
       [2.07088312, 1.65089481, 1.39398449, 1.0483149 , 0.98532577],
       [1.65889281, 1.80496275, 1.80432031, 2.2947466 , 2.37766526],
       [0.72239312, 0.70197236, 0.3248581 , 0.45959608, 0.75686365]]), -2.348505950772676), (array([[1.33397349, 0.87072261, 0.74243496, 0.80140492, 0.86573191],
       [1.65089481, 1.39398449, 1.0483149 , 0.98532577, 1.09737197],
       [1.80496275, 1.80432031, 2.2947466 , 2.37766526, 2.80117524],
       [0.70197236, 0.3248581 , 0.45959608, 0.75686365, 0.33383434]]), -2.237281534457659), (array([[0.87072261, 0.74243496, 0.80140492, 0.86573191, 1.13766632],
       [1.39398449, 1.0483149 , 0.98532577, 1.09737197, 1.32363815],
       [1.80432031, 2.2947466 , 2.37766526, 2.80117524, 2.82085112],
       [0.3248581 , 0.45959608, 0.75686365, 0.33383434, 0.46270668]]), -1.848273031534955), (array([[0.74243496, 0.80140492, 0.86573191, 1.13766632, 0.66946787],
       [1.0483149 , 0.98532577, 1.09737197, 1.32363815, 0.9296718 ],
       [2.2947466 , 2.37766526, 2.80117524, 2.82085112, 2.59915479],
       [0.45959608, 0.75686365, 0.33383434, 0.46270668, 0.56706871]]), -2.3413758380765533), (array([[0.80140492, 0.86573191, 1.13766632, 0.66946787, 1.06184159],
       [0.98532577, 1.09737197, 1.32363815, 0.9296718 , 1.12514804],
       [2.37766526, 2.80117524, 2.82085112, 2.59915479, 2.2172347 ],
       [0.75686365, 0.33383434, 0.46270668, 0.56706871, 0.93281336]]), -2.3334399490630915), (array([[0.86573191, 1.13766632, 0.66946787, 1.06184159, 0.64116922],
       [1.09737197, 1.32363815, 0.9296718 , 1.12514804, 0.81396799],
       [2.80117524, 2.82085112, 2.59915479, 2.2172347 , 2.1256762 ],
       [0.33383434, 0.46270668, 0.56706871, 0.93281336, 0.46856575]]), -2.0669440523051454), (array([[1.13766632, 0.66946787, 1.06184159, 0.64116922, 0.61392621],
       [1.32363815, 0.9296718 , 1.12514804, 0.81396799, 0.43358805],
       [2.82085112, 2.59915479, 2.2172347 , 2.1256762 , 2.61709517],
       [0.46270668, 0.56706871, 0.93281336, 0.46856575, 0.82890665]]), -2.552403426960685), (array([[0.66946787, 1.06184159, 0.64116922, 0.61392621, 0.91301795],
       [0.9296718 , 1.12514804, 0.81396799, 0.43358805, 0.44283918],
       [2.59915479, 2.2172347 , 2.1256762 , 2.61709517, 2.34750264],
       [0.56706871, 0.93281336, 0.46856575, 0.82890665, 1.10563687]]), -2.242295408553534), (array([[1.06184159, 0.64116922, 0.61392621, 0.91301795, 1.18574396],
       [1.12514804, 0.81396799, 0.43358805, 0.44283918, 0.08683523],
       [2.2172347 , 2.1256762 , 2.61709517, 2.34750264, 2.48172255],
       [0.93281336, 0.46856575, 0.82890665, 1.10563687, 0.72702198]]), -2.4511670575025253), (array([[0.64116922, 0.61392621, 0.91301795, 1.18574396, 1.12141641],
       [0.81396799, 0.43358805, 0.44283918, 0.08683523, 0.41822661],
       [2.1256762 , 2.61709517, 2.34750264, 2.48172255, 2.67270093],
       [0.46856575, 0.82890665, 1.10563687, 0.72702198, 0.42184509]]), -2.1965451174651482), (array([[0.61392621, 0.91301795, 1.18574396, 1.12141641, 1.37609389],
       [0.43358805, 0.44283918, 0.08683523, 0.41822661, 0.7338318 ],
       [2.61709517, 2.34750264, 2.48172255, 2.67270093, 2.50364527],
       [0.82890665, 1.10563687, 0.72702198, 0.42184509, 0.6834188 ]]), -2.1368606561992536), (array([[0.91301795, 1.18574396, 1.12141641, 1.37609389, 1.17562365],
       [0.44283918, 0.08683523, 0.41822661, 0.7338318 , 0.78992493],
       [2.34750264, 2.48172255, 2.67270093, 2.50364527, 2.17862976],
       [1.10563687, 0.72702198, 0.42184509, 0.6834188 , 0.60761904]]), -2.4804186158973716), (array([[1.18574396, 1.12141641, 1.37609389, 1.17562365, 1.49030016],
       [0.08683523, 0.41822661, 0.7338318 , 0.78992493, 0.74782119],
       [2.48172255, 2.67270093, 2.50364527, 2.17862976, 2.32253831],
       [0.72702198, 0.42184509, 0.6834188 , 0.60761904, 0.79580316]]), -2.909753495554468), (array([[1.12141641, 1.37609389, 1.17562365, 1.49030016, 1.09694342],
       [0.41822661, 0.7338318 , 0.78992493, 0.74782119, 0.32173264],
       [2.67270093, 2.50364527, 2.17862976, 2.32253831, 1.91950294],
       [0.42184509, 0.6834188 , 0.60761904, 0.79580316, 1.26004544]]), -2.787170505447836), (array([[ 1.37609389,  1.17562365,  1.49030016,  1.09694342,  0.77028853],
       [ 0.7338318 ,  0.78992493,  0.74782119,  0.32173264, -0.06324489],
       [ 2.50364527,  2.17862976,  2.32253831,  1.91950294,  1.89712495],
       [ 0.6834188 ,  0.60761904,  0.79580316,  1.26004544,  1.55370741]]), -2.666818684953629), (array([[ 1.17562365,  1.49030016,  1.09694342,  0.77028853,  1.19362348],
       [ 0.78992493,  0.74782119,  0.32173264, -0.06324489, -0.47857605],
       [ 2.17862976,  2.32253831,  1.91950294,  1.89712495,  1.7976454 ],
       [ 0.60761904,  0.79580316,  1.26004544,  1.55370741,  1.91871964]]), -2.8182183890099277), (array([[ 1.49030016,  1.09694342,  0.77028853,  1.19362348,  1.04343746],
       [ 0.74782119,  0.32173264, -0.06324489, -0.47857605, -0.15311031],
       [ 2.32253831,  1.91950294,  1.89712495,  1.7976454 ,  2.22545046],
       [ 0.79580316,  1.26004544,  1.55370741,  1.91871964,  1.90250009]]), -2.8847252952120366), (array([[ 1.09694342,  0.77028853,  1.19362348,  1.04343746,  1.47558737],
       [ 0.32173264, -0.06324489, -0.47857605, -0.15311031, -0.60827595],
       [ 1.91950294,  1.89712495,  1.7976454 ,  2.22545046,  2.28902156],
       [ 1.26004544,  1.55370741,  1.91871964,  1.90250009,  2.06834833]]), -3.0226126254102117), (array([[ 0.77028853,  1.19362348,  1.04343746,  1.47558737,  1.38019248],
       [-0.06324489, -0.47857605, -0.15311031, -0.60827595, -0.42865269],
       [ 1.89712495,  1.7976454 ,  2.22545046,  2.28902156,  1.85282172],
       [ 1.55370741,  1.91871964,  1.90250009,  2.06834833,  2.51838632]]), -2.8793219049610377), (array([[ 1.19362348,  1.04343746,  1.47558737,  1.38019248,  1.69111394],
       [-0.47857605, -0.15311031, -0.60827595, -0.42865269, -0.47474831],
       [ 1.7976454 ,  2.22545046,  2.28902156,  1.85282172,  1.86112405],
       [ 1.91871964,  1.90250009,  2.06834833,  2.51838632,  2.87928042]]), -2.830373974360018), (array([[ 1.04343746,  1.47558737,  1.38019248,  1.69111394,  2.00590261],
       [-0.15311031, -0.60827595, -0.42865269, -0.47474831, -0.49068611],
       [ 2.22545046,  2.28902156,  1.85282172,  1.86112405,  1.77021994],
       [ 1.90250009,  2.06834833,  2.51838632,  2.87928042,  2.59267361]]), -2.9680578771282886), (array([[ 1.47558737,  1.38019248,  1.69111394,  2.00590261,  2.46669281],
       [-0.60827595, -0.42865269, -0.47474831, -0.49068611, -0.0941768 ],
       [ 2.28902156,  1.85282172,  1.86112405,  1.77021994,  1.74496083],
       [ 2.06834833,  2.51838632,  2.87928042,  2.59267361,  2.26147969]]), -2.486597598418146), (array([[ 1.38019248,  1.69111394,  2.00590261,  2.46669281,  2.0060942 ],
       [-0.42865269, -0.47474831, -0.49068611, -0.0941768 ,  0.36737777],
       [ 1.85282172,  1.86112405,  1.77021994,  1.74496083,  1.68789457],
       [ 2.51838632,  2.87928042,  2.59267361,  2.26147969,  2.06663124]]), -2.849688751383032), (array([[ 1.69111394,  2.00590261,  2.46669281,  2.0060942 ,  1.96644728],
       [-0.47474831, -0.49068611, -0.0941768 ,  0.36737777,  0.65843457],
       [ 1.86112405,  1.77021994,  1.74496083,  1.68789457,  1.32313377],
       [ 2.87928042,  2.59267361,  2.26147969,  2.06663124,  2.42924749]]), -3.3465993191002994), (array([[ 2.00590261,  2.46669281,  2.0060942 ,  1.96644728,  1.62199472],
       [-0.49068611, -0.0941768 ,  0.36737777,  0.65843457,  1.00167035],
       [ 1.77021994,  1.74496083,  1.68789457,  1.32313377,  1.56595724],
       [ 2.59267361,  2.26147969,  2.06663124,  2.42924749,  2.68298363]]), -3.3138866661452706), (array([[ 2.46669281,  2.0060942 ,  1.96644728,  1.62199472,  1.42808132],
       [-0.0941768 ,  0.36737777,  0.65843457,  1.00167035,  0.59494092],
       [ 1.74496083,  1.68789457,  1.32313377,  1.56595724,  1.19255592],
       [ 2.26147969,  2.06663124,  2.42924749,  2.68298363,  2.42505352]]), -3.173125676408137), (array([[2.0060942 , 1.96644728, 1.62199472, 1.42808132, 1.50497138],
       [0.36737777, 0.65843457, 1.00167035, 0.59494092, 0.26723139],
       [1.68789457, 1.32313377, 1.56595724, 1.19255592, 1.60211334],
       [2.06663124, 2.42924749, 2.68298363, 2.42505352, 2.44030707]]), -3.1852855902459587), (array([[1.96644728, 1.62199472, 1.42808132, 1.50497138, 1.98649875],
       [0.65843457, 1.00167035, 0.59494092, 0.26723139, 0.68266744],
       [1.32313377, 1.56595724, 1.19255592, 1.60211334, 1.26675462],
       [2.42924749, 2.68298363, 2.42505352, 2.44030707, 2.85161306]]), -3.195598958813249)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>0.179711</td>
      <td>0.578744</td>
      <td>0.796693</td>
      <td>0.320477</td>
      <td>0.192614</td>
      <td>0.273881</td>
      <td>-0.091231</td>
      <td>0.096489</td>
      <td>0.128674</td>
      <td>-0.065056</td>
      <td>...</td>
      <td>-4.114216</td>
      <td>-4.577579</td>
      <td>-4.928586</td>
      <td>-5.071857</td>
      <td>-5.108447</td>
      <td>-5.190610</td>
      <td>-5.679092</td>
      <td>-5.959187</td>
      <td>-6.415132</td>
      <td>-5.957932</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.237522</td>
      <td>0.117444</td>
      <td>-0.283863</td>
      <td>-0.275400</td>
      <td>0.030556</td>
      <td>0.487678</td>
      <td>0.277272</td>
      <td>-0.148653</td>
      <td>0.177882</td>
      <td>-0.181913</td>
      <td>...</td>
      <td>1.618087</td>
      <td>2.034389</td>
      <td>2.267174</td>
      <td>2.503338</td>
      <td>2.512144</td>
      <td>2.774796</td>
      <td>3.195900</td>
      <td>3.001272</td>
      <td>2.908509</td>
      <td>3.241066</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.315069</td>
      <td>-0.592266</td>
      <td>-0.682319</td>
      <td>-0.325183</td>
      <td>-0.597872</td>
      <td>-0.313120</td>
      <td>-0.216896</td>
      <td>-0.495109</td>
      <td>-0.079914</td>
      <td>0.016719</td>
      <td>...</td>
      <td>-0.418831</td>
      <td>-0.907780</td>
      <td>-0.679829</td>
      <td>-0.551442</td>
      <td>-0.137118</td>
      <td>0.140876</td>
      <td>-0.346529</td>
      <td>0.019336</td>
      <td>-0.477779</td>
      <td>-0.192954</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>-0.369673</td>
      <td>-0.451059</td>
      <td>-0.664551</td>
      <td>-0.735336</td>
      <td>-1.042069</td>
      <td>-0.906921</td>
      <td>-0.718636</td>
      <td>-1.045171</td>
      <td>-1.266443</td>
      <td>-1.400775</td>
      <td>...</td>
      <td>-2.034609</td>
      <td>-1.630308</td>
      <td>-1.704264</td>
      <td>-1.825942</td>
      <td>-1.631296</td>
      <td>-1.184910</td>
      <td>-1.652691</td>
      <td>-1.329222</td>
      <td>-1.370406</td>
      <td>-1.199968</td>
    </tr>
    <tr>
      <th>target</th>
      <td>-0.230271</td>
      <td>-0.159757</td>
      <td>-0.387333</td>
      <td>-0.394828</td>
      <td>-0.402125</td>
      <td>-0.759011</td>
      <td>-0.646134</td>
      <td>-1.049000</td>
      <td>-0.725431</td>
      <td>-0.722680</td>
      <td>...</td>
      <td>-1.054961</td>
      <td>-1.136360</td>
      <td>-0.645204</td>
      <td>-0.725390</td>
      <td>-0.427184</td>
      <td>-0.675811</td>
      <td>-0.633820</td>
      <td>-0.569744</td>
      <td>-0.226827</td>
      <td>-0.257044</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0.17971132,  0.57874431,  0.79669322,  0.3204774 ,  0.19261395],
       [-0.2375219 ,  0.11744356, -0.28386343, -0.27540049,  0.03055594],
       [-0.3150687 , -0.59226572, -0.68231936, -0.32518325, -0.59787174],
       [-0.36967257, -0.45105946, -0.66455082, -0.7353359 , -1.04206939]]), -0.40212495446422836), (array([[ 0.57874431,  0.79669322,  0.3204774 ,  0.19261395,  0.27388113],
       [ 0.11744356, -0.28386343, -0.27540049,  0.03055594,  0.48767776],
       [-0.59226572, -0.68231936, -0.32518325, -0.59787174, -0.31312008],
       [-0.45105946, -0.66455082, -0.7353359 , -1.04206939, -0.90692086]]), -0.7590105232268873), (array([[ 0.79669322,  0.3204774 ,  0.19261395,  0.27388113, -0.09123105],
       [-0.28386343, -0.27540049,  0.03055594,  0.48767776,  0.27727164],
       [-0.68231936, -0.32518325, -0.59787174, -0.31312008, -0.21689579],
       [-0.66455082, -0.7353359 , -1.04206939, -0.90692086, -0.71863558]]), -0.6461341936547856), (array([[ 0.3204774 ,  0.19261395,  0.27388113, -0.09123105,  0.09648887],
       [-0.27540049,  0.03055594,  0.48767776,  0.27727164, -0.14865303],
       [-0.32518325, -0.59787174, -0.31312008, -0.21689579, -0.49510899],
       [-0.7353359 , -1.04206939, -0.90692086, -0.71863558, -1.04517061]]), -1.0489998235477591), (array([[ 0.19261395,  0.27388113, -0.09123105,  0.09648887,  0.12867434],
       [ 0.03055594,  0.48767776,  0.27727164, -0.14865303,  0.17788243],
       [-0.59787174, -0.31312008, -0.21689579, -0.49510899, -0.07991442],
       [-1.04206939, -0.90692086, -0.71863558, -1.04517061, -1.26644251]]), -0.7254307412213488), (array([[ 0.27388113, -0.09123105,  0.09648887,  0.12867434, -0.06505635],
       [ 0.48767776,  0.27727164, -0.14865303,  0.17788243, -0.18191321],
       [-0.31312008, -0.21689579, -0.49510899, -0.07991442,  0.01671919],
       [-0.90692086, -0.71863558, -1.04517061, -1.26644251, -1.40077541]]), -0.7226803325694617), (array([[-0.09123105,  0.09648887,  0.12867434, -0.06505635, -0.32286861],
       [ 0.27727164, -0.14865303,  0.17788243, -0.18191321, -0.50277554],
       [-0.21689579, -0.49510899, -0.07991442,  0.01671919, -0.09664332],
       [-0.71863558, -1.04517061, -1.26644251, -1.40077541, -1.25235382]]), -0.3995580326967654), (array([[ 0.09648887,  0.12867434, -0.06505635, -0.32286861, -0.0371227 ],
       [-0.14865303,  0.17788243, -0.18191321, -0.50277554, -0.50769267],
       [-0.49510899, -0.07991442,  0.01671919, -0.09664332,  0.15337024],
       [-1.04517061, -1.26644251, -1.40077541, -1.25235382, -0.75741087]]), -0.1384716325312496), (array([[ 0.12867434, -0.06505635, -0.32286861, -0.0371227 ,  0.32025624],
       [ 0.17788243, -0.18191321, -0.50277554, -0.50769267, -0.57769175],
       [-0.07991442,  0.01671919, -0.09664332,  0.15337024, -0.20499848],
       [-1.26644251, -1.40077541, -1.25235382, -0.75741087, -0.27078407]]), -0.42223784263573294), (array([[-0.06505635, -0.32286861, -0.0371227 ,  0.32025624, -0.03177296],
       [-0.18191321, -0.50277554, -0.50769267, -0.57769175, -0.29938577],
       [ 0.01671919, -0.09664332,  0.15337024, -0.20499848,  0.17606669],
       [-1.40077541, -1.25235382, -0.75741087, -0.27078407, -0.4106268 ]]), -0.5804101861689319), (array([[-0.32286861, -0.0371227 ,  0.32025624, -0.03177296, -0.23133578],
       [-0.50277554, -0.50769267, -0.57769175, -0.29938577,  0.17995662],
       [-0.09664332,  0.15337024, -0.20499848,  0.17606669,  0.64396706],
       [-1.25235382, -0.75741087, -0.27078407, -0.4106268 , -0.47942471]]), -0.47155867075545455), (array([[-0.0371227 ,  0.32025624, -0.03177296, -0.23133578, -0.68630397],
       [-0.50769267, -0.57769175, -0.29938577,  0.17995662,  0.59956966],
       [ 0.15337024, -0.20499848,  0.17606669,  0.64396706,  1.06215378],
       [-0.75741087, -0.27078407, -0.4106268 , -0.47942471, -0.54243708]]), -0.8721760362344855), (array([[ 0.32025624, -0.03177296, -0.23133578, -0.68630397, -0.74899106],
       [-0.57769175, -0.29938577,  0.17995662,  0.59956966,  1.01730193],
       [-0.20499848,  0.17606669,  0.64396706,  1.06215378,  1.16694679],
       [-0.27078407, -0.4106268 , -0.47942471, -0.54243708, -0.51149056]]), -0.8812216105002804), (array([[-0.03177296, -0.23133578, -0.68630397, -0.74899106, -0.78637484],
       [-0.29938577,  0.17995662,  0.59956966,  1.01730193,  1.08213978],
       [ 0.17606669,  0.64396706,  1.06215378,  1.16694679,  1.058266  ],
       [-0.4106268 , -0.47942471, -0.54243708, -0.51149056, -0.58204083]]), -0.5291751268965733), (array([[-0.23133578, -0.68630397, -0.74899106, -0.78637484, -0.89185092],
       [ 0.17995662,  0.59956966,  1.01730193,  1.08213978,  1.46749633],
       [ 0.64396706,  1.06215378,  1.16694679,  1.058266  ,  0.83992687],
       [-0.47942471, -0.54243708, -0.51149056, -0.58204083, -0.86811058]]), -0.9581050907296788), (array([[-0.68630397, -0.74899106, -0.78637484, -0.89185092, -1.05562938],
       [ 0.59956966,  1.01730193,  1.08213978,  1.46749633,  1.34276937],
       [ 1.06215378,  1.16694679,  1.058266  ,  0.83992687,  0.7327485 ],
       [-0.54243708, -0.51149056, -0.58204083, -0.86811058, -0.46558492]]), -0.7950680072454885), (array([[-0.74899106, -0.78637484, -0.89185092, -1.05562938, -1.13108495],
       [ 1.01730193,  1.08213978,  1.46749633,  1.34276937,  1.40544643],
       [ 1.16694679,  1.058266  ,  0.83992687,  0.7327485 ,  0.28798115],
       [-0.51149056, -0.58204083, -0.86811058, -0.46558492, -0.16887164]]), -0.7777265445651957), (array([[-0.78637484, -0.89185092, -1.05562938, -1.13108495, -1.45570516],
       [ 1.08213978,  1.46749633,  1.34276937,  1.40544643,  1.89340478],
       [ 1.058266  ,  0.83992687,  0.7327485 ,  0.28798115,  0.06173778],
       [-0.58204083, -0.86811058, -0.46558492, -0.16887164, -0.13943627]]), -1.2517176169702142), (array([[-0.89185092, -1.05562938, -1.13108495, -1.45570516, -1.58095232],
       [ 1.46749633,  1.34276937,  1.40544643,  1.89340478,  2.21382547],
       [ 0.83992687,  0.7327485 ,  0.28798115,  0.06173778, -0.33055437],
       [-0.86811058, -0.46558492, -0.16887164, -0.13943627, -0.02639261]]), -1.4204453839600313), (array([[-1.05562938, -1.13108495, -1.45570516, -1.58095232, -1.47304149],
       [ 1.34276937,  1.40544643,  1.89340478,  2.21382547,  2.32147875],
       [ 0.7327485 ,  0.28798115,  0.06173778, -0.33055437, -0.79293924],
       [-0.46558492, -0.16887164, -0.13943627, -0.02639261, -0.07260279]]), -1.2920270946310637), (array([[-1.13108495, -1.45570516, -1.58095232, -1.47304149, -1.85709608],
       [ 1.40544643,  1.89340478,  2.21382547,  2.32147875,  2.21987923],
       [ 0.28798115,  0.06173778, -0.33055437, -0.79293924, -0.32985276],
       [-0.16887164, -0.13943627, -0.02639261, -0.07260279, -0.49158697]]), -1.7554692759908352), (array([[-1.45570516, -1.58095232, -1.47304149, -1.85709608, -1.61893899],
       [ 1.89340478,  2.21382547,  2.32147875,  2.21987923,  2.03626164],
       [ 0.06173778, -0.33055437, -0.79293924, -0.32985276, -0.63951269],
       [-0.13943627, -0.02639261, -0.07260279, -0.49158697, -0.26041625]]), -1.6478480687480919), (array([[-1.58095232, -1.47304149, -1.85709608, -1.61893899, -1.93628238],
       [ 2.21382547,  2.32147875,  2.21987923,  2.03626164,  1.79154432],
       [-0.33055437, -0.79293924, -0.32985276, -0.63951269, -1.0712061 ],
       [-0.02639261, -0.07260279, -0.49158697, -0.26041625, -0.12038555]]), -2.0202708635546704), (array([[-1.47304149, -1.85709608, -1.61893899, -1.93628238, -2.20117634],
       [ 2.32147875,  2.21987923,  2.03626164,  1.79154432,  1.94766576],
       [-0.79293924, -0.32985276, -0.63951269, -1.0712061 , -1.16319897],
       [-0.07260279, -0.49158697, -0.26041625, -0.12038555,  0.07204307]]), -2.197657550471971), (array([[-1.85709608, -1.61893899, -1.93628238, -2.20117634, -2.48252462],
       [ 2.21987923,  2.03626164,  1.79154432,  1.94766576,  1.70336477],
       [-0.32985276, -0.63951269, -1.0712061 , -1.16319897, -1.41670935],
       [-0.49158697, -0.26041625, -0.12038555,  0.07204307,  0.06798486]]), -2.527209684868242), (array([[-1.61893899, -1.93628238, -2.20117634, -2.48252462, -2.83608527],
       [ 2.03626164,  1.79154432,  1.94766576,  1.70336477,  1.98085392],
       [-0.63951269, -1.0712061 , -1.16319897, -1.41670935, -1.6351052 ],
       [-0.26041625, -0.12038555,  0.07204307,  0.06798486, -0.05297998]]), -2.830154721059619), (array([[-1.93628238, -2.20117634, -2.48252462, -2.83608527, -3.17530046],
       [ 1.79154432,  1.94766576,  1.70336477,  1.98085392,  1.8309174 ],
       [-1.0712061 , -1.16319897, -1.41670935, -1.6351052 , -1.99759733],
       [-0.12038555,  0.07204307,  0.06798486, -0.05297998,  0.39663943]]), -3.071654236307297), (array([[-2.20117634, -2.48252462, -2.83608527, -3.17530046, -2.75254809],
       [ 1.94766576,  1.70336477,  1.98085392,  1.8309174 ,  1.37489944],
       [-1.16319897, -1.41670935, -1.6351052 , -1.99759733, -2.24255958],
       [ 0.07204307,  0.06798486, -0.05297998,  0.39663943,  0.24490826]]), -3.2233226043257432), (array([[-2.48252462, -2.83608527, -3.17530046, -2.75254809, -2.61520258],
       [ 1.70336477,  1.98085392,  1.8309174 ,  1.37489944,  1.31034309],
       [-1.41670935, -1.6351052 , -1.99759733, -2.24255958, -2.30026724],
       [ 0.06798486, -0.05297998,  0.39663943,  0.24490826,  0.48692618]]), -2.804764622532476), (array([[-2.83608527, -3.17530046, -2.75254809, -2.61520258, -2.4359063 ],
       [ 1.98085392,  1.8309174 ,  1.37489944,  1.31034309,  1.27034888],
       [-1.6351052 , -1.99759733, -2.24255958, -2.30026724, -2.40543435],
       [-0.05297998,  0.39663943,  0.24490826,  0.48692618,  0.50194091]]), -2.6219958853007284), (array([[-3.17530046, -2.75254809, -2.61520258, -2.4359063 , -2.39039682],
       [ 1.8309174 ,  1.37489944,  1.31034309,  1.27034888,  1.55842566],
       [-1.99759733, -2.24255958, -2.30026724, -2.40543435, -2.48184312],
       [ 0.39663943,  0.24490826,  0.48692618,  0.50194091,  0.99299822]]), -2.4984175853465755), (array([[-2.75254809, -2.61520258, -2.4359063 , -2.39039682, -2.13820703],
       [ 1.37489944,  1.31034309,  1.27034888,  1.55842566,  1.90196344],
       [-2.24255958, -2.30026724, -2.40543435, -2.48184312, -2.04329828],
       [ 0.24490826,  0.48692618,  0.50194091,  0.99299822,  0.93115236]]), -2.3962303130064253), (array([[-2.61520258, -2.4359063 , -2.39039682, -2.13820703, -2.37694874],
       [ 1.31034309,  1.27034888,  1.55842566,  1.90196344,  1.72387791],
       [-2.30026724, -2.40543435, -2.48184312, -2.04329828, -2.36149447],
       [ 0.48692618,  0.50194091,  0.99299822,  0.93115236,  0.9160979 ]]), -2.5666863497063415), (array([[-2.4359063 , -2.39039682, -2.13820703, -2.37694874, -2.41936316],
       [ 1.27034888,  1.55842566,  1.90196344,  1.72387791,  1.36960068],
       [-2.40543435, -2.48184312, -2.04329828, -2.36149447, -2.27018287],
       [ 0.50194091,  0.99299822,  0.93115236,  0.9160979 ,  1.39410624]]), -2.723833061937504), (array([[-2.39039682, -2.13820703, -2.37694874, -2.41936316, -2.39848527],
       [ 1.55842566,  1.90196344,  1.72387791,  1.36960068,  0.9799962 ],
       [-2.48184312, -2.04329828, -2.36149447, -2.27018287, -1.82339531],
       [ 0.99299822,  0.93115236,  0.9160979 ,  1.39410624,  1.651601  ]]), -2.994192746647931), (array([[-2.13820703, -2.37694874, -2.41936316, -2.39848527, -2.47366808],
       [ 1.90196344,  1.72387791,  1.36960068,  0.9799962 ,  0.9501345 ],
       [-2.04329828, -2.36149447, -2.27018287, -1.82339531, -1.88983319],
       [ 0.93115236,  0.9160979 ,  1.39410624,  1.651601  ,  1.6652776 ]]), -2.9473553045553964), (array([[-2.37694874, -2.41936316, -2.39848527, -2.47366808, -2.12303514],
       [ 1.72387791,  1.36960068,  0.9799962 ,  0.9501345 ,  1.25489942],
       [-2.36149447, -2.27018287, -1.82339531, -1.88983319, -1.92464078],
       [ 0.9160979 ,  1.39410624,  1.651601  ,  1.6652776 ,  2.1242502 ]]), -2.8245103602009554), (array([[-2.41936316, -2.39848527, -2.47366808, -2.12303514, -2.60221801],
       [ 1.36960068,  0.9799962 ,  0.9501345 ,  1.25489942,  1.19530672],
       [-2.27018287, -1.82339531, -1.88983319, -1.92464078, -1.89589387],
       [ 1.39410624,  1.651601  ,  1.6652776 ,  2.1242502 ,  1.77684276]]), -2.6767131269714612), (array([[-2.39848527, -2.47366808, -2.12303514, -2.60221801, -2.94984964],
       [ 0.9799962 ,  0.9501345 ,  1.25489942,  1.19530672,  1.2965088 ],
       [-1.82339531, -1.88983319, -1.92464078, -1.89589387, -2.21577207],
       [ 1.651601  ,  1.6652776 ,  2.1242502 ,  1.77684276,  1.34056994]]), -2.345298299644807), (array([[-2.47366808, -2.12303514, -2.60221801, -2.94984964, -2.56210581],
       [ 0.9501345 ,  1.25489942,  1.19530672,  1.2965088 ,  1.06048847],
       [-1.88983319, -1.92464078, -1.89589387, -2.21577207, -2.5445793 ],
       [ 1.6652776 ,  2.1242502 ,  1.77684276,  1.34056994,  0.99854048]]), -2.0630501158761128), (array([[-2.12303514, -2.60221801, -2.94984964, -2.56210581, -2.80881173],
       [ 1.25489942,  1.19530672,  1.2965088 ,  1.06048847,  1.26426714],
       [-1.92464078, -1.89589387, -2.21577207, -2.5445793 , -2.56023501],
       [ 2.1242502 ,  1.77684276,  1.34056994,  0.99854048,  0.72247972]]), -2.4633603847948136), (array([[-2.60221801, -2.94984964, -2.56210581, -2.80881173, -2.92020256],
       [ 1.19530672,  1.2965088 ,  1.06048847,  1.26426714,  1.30049526],
       [-1.89589387, -2.21577207, -2.5445793 , -2.56023501, -2.26481902],
       [ 1.77684276,  1.34056994,  0.99854048,  0.72247972,  0.22319478]]), -2.5363578278450354), (array([[-2.94984964, -2.56210581, -2.80881173, -2.92020256, -2.76669138],
       [ 1.2965088 ,  1.06048847,  1.26426714,  1.30049526,  0.90700715],
       [-2.21577207, -2.5445793 , -2.56023501, -2.26481902, -2.54756221],
       [ 1.34056994,  0.99854048,  0.72247972,  0.22319478, -0.15172611]]), -2.740332865272648), (array([[-2.56210581, -2.80881173, -2.92020256, -2.76669138, -3.08091387],
       [ 1.06048847,  1.26426714,  1.30049526,  0.90700715,  1.35315152],
       [-2.5445793 , -2.56023501, -2.26481902, -2.54756221, -2.9773702 ],
       [ 0.99854048,  0.72247972,  0.22319478, -0.15172611, -0.19377463]]), -2.482833832703382), (array([[-2.80881173, -2.92020256, -2.76669138, -3.08091387, -3.25297694],
       [ 1.26426714,  1.30049526,  0.90700715,  1.35315152,  1.82022378],
       [-2.56023501, -2.26481902, -2.54756221, -2.9773702 , -2.78593074],
       [ 0.72247972,  0.22319478, -0.15172611, -0.19377463, -0.67087517]]), -2.3006218125665194), (array([[-2.92020256, -2.76669138, -3.08091387, -3.25297694, -3.5271554 ],
       [ 1.30049526,  0.90700715,  1.35315152,  1.82022378,  1.93210899],
       [-2.26481902, -2.54756221, -2.9773702 , -2.78593074, -2.77967762],
       [ 0.22319478, -0.15172611, -0.19377463, -0.67087517, -0.9145441 ]]), -2.1252860738516244), (array([[-2.76669138, -3.08091387, -3.25297694, -3.5271554 , -3.79331358],
       [ 0.90700715,  1.35315152,  1.82022378,  1.93210899,  1.7358099 ],
       [-2.54756221, -2.9773702 , -2.78593074, -2.77967762, -2.60053924],
       [-0.15172611, -0.19377463, -0.67087517, -0.9145441 , -0.72456088]]), -1.9795467295702818), (array([[-3.08091387, -3.25297694, -3.5271554 , -3.79331358, -3.83593939],
       [ 1.35315152,  1.82022378,  1.93210899,  1.7358099 ,  2.11918018],
       [-2.9773702 , -2.78593074, -2.77967762, -2.60053924, -2.59623834],
       [-0.19377463, -0.67087517, -0.9145441 , -0.72456088, -1.05342693]]), -1.6205625510356352), (array([[-3.25297694, -3.5271554 , -3.79331358, -3.83593939, -3.62189683],
       [ 1.82022378,  1.93210899,  1.7358099 ,  2.11918018,  2.18917143],
       [-2.78593074, -2.77967762, -2.60053924, -2.59623834, -2.21327675],
       [-0.67087517, -0.9145441 , -0.72456088, -1.05342693, -1.25483688]]), -1.8152348779723466), (array([[-3.5271554 , -3.79331358, -3.83593939, -3.62189683, -3.52497865],
       [ 1.93210899,  1.7358099 ,  2.11918018,  2.18917143,  2.20133053],
       [-2.77967762, -2.60053924, -2.59623834, -2.21327675, -2.60242256],
       [-0.9145441 , -0.72456088, -1.05342693, -1.25483688, -1.0043404 ]]), -1.3464767205518164), (array([[-3.79331358, -3.83593939, -3.62189683, -3.52497865, -3.24227871],
       [ 1.7358099 ,  2.11918018,  2.18917143,  2.20133053,  2.0884378 ],
       [-2.60053924, -2.59623834, -2.21327675, -2.60242256, -2.14655089],
       [-0.72456088, -1.05342693, -1.25483688, -1.0043404 , -0.8559984 ]]), -1.4119496711333144), (array([[-3.83593939, -3.62189683, -3.52497865, -3.24227871, -2.98218306],
       [ 2.11918018,  2.18917143,  2.20133053,  2.0884378 ,  2.01660236],
       [-2.59623834, -2.21327675, -2.60242256, -2.14655089, -1.88089275],
       [-1.05342693, -1.25483688, -1.0043404 , -0.8559984 , -0.79931672]]), -1.223098585784117), (array([[-3.62189683, -3.52497865, -3.24227871, -2.98218306, -2.86101864],
       [ 2.18917143,  2.20133053,  2.0884378 ,  2.01660236,  1.5690693 ],
       [-2.21327675, -2.60242256, -2.14655089, -1.88089275, -1.67861511],
       [-1.25483688, -1.0043404 , -0.8559984 , -0.79931672, -0.3473168 ]]), -1.403743199777912), (array([[-3.52497865, -3.24227871, -2.98218306, -2.86101864, -2.5725131 ],
       [ 2.20133053,  2.0884378 ,  2.01660236,  1.5690693 ,  1.73130093],
       [-2.60242256, -2.14655089, -1.88089275, -1.67861511, -1.44147447],
       [-1.0043404 , -0.8559984 , -0.79931672, -0.3473168 , -0.26533069]]), -1.6099786697578315), (array([[-3.24227871, -2.98218306, -2.86101864, -2.5725131 , -2.1866445 ],
       [ 2.0884378 ,  2.01660236,  1.5690693 ,  1.73130093,  1.68549856],
       [-2.14655089, -1.88089275, -1.67861511, -1.44147447, -1.35654748],
       [-0.8559984 , -0.79931672, -0.3473168 , -0.26533069, -0.39104209]]), -1.2833501731049055), (array([[-2.98218306, -2.86101864, -2.5725131 , -2.1866445 , -2.13005681],
       [ 2.01660236,  1.5690693 ,  1.73130093,  1.68549856,  1.86553795],
       [-1.88089275, -1.67861511, -1.44147447, -1.35654748, -1.71160542],
       [-0.79931672, -0.3473168 , -0.26533069, -0.39104209, -0.32456416]]), -0.9200066642174276), (array([[-2.86101864, -2.5725131 , -2.1866445 , -2.13005681, -2.26608037],
       [ 1.5690693 ,  1.73130093,  1.68549856,  1.86553795,  1.78426966],
       [-1.67861511, -1.44147447, -1.35654748, -1.71160542, -1.58444607],
       [-0.3473168 , -0.26533069, -0.39104209, -0.32456416, -0.6489518 ]]), -1.0492136574351667), (array([[-2.5725131 , -2.1866445 , -2.13005681, -2.26608037, -2.60011369],
       [ 1.73130093,  1.68549856,  1.86553795,  1.78426966,  1.90608121],
       [-1.44147447, -1.35654748, -1.71160542, -1.58444607, -1.09417624],
       [-0.26533069, -0.39104209, -0.32456416, -0.6489518 , -0.321252  ]]), -0.789456216083735), (array([[-2.1866445 , -2.13005681, -2.26608037, -2.60011369, -3.03364679],
       [ 1.68549856,  1.86553795,  1.78426966,  1.90608121,  1.86101453],
       [-1.35654748, -1.71160542, -1.58444607, -1.09417624, -0.71665919],
       [-0.39104209, -0.32456416, -0.6489518 , -0.321252  , -0.63594137]]), -0.5006500414221695), (array([[-2.13005681, -2.26608037, -2.60011369, -3.03364679, -3.19180796],
       [ 1.86553795,  1.78426966,  1.90608121,  1.86101453,  1.66221021],
       [-1.71160542, -1.58444607, -1.09417624, -0.71665919, -0.45785892],
       [-0.32456416, -0.6489518 , -0.321252  , -0.63594137, -0.74863628]]), -0.3613644436427662), (array([[-2.26608037, -2.60011369, -3.03364679, -3.19180796, -2.81942828],
       [ 1.78426966,  1.90608121,  1.86101453,  1.66221021,  1.64341433],
       [-1.58444607, -1.09417624, -0.71665919, -0.45785892, -0.7942415 ],
       [-0.6489518 , -0.321252  , -0.63594137, -0.74863628, -1.05463724]]), -0.11616033581557228), (array([[-2.60011369, -3.03364679, -3.19180796, -2.81942828, -2.4989288 ],
       [ 1.90608121,  1.86101453,  1.66221021,  1.64341433,  1.69711679],
       [-1.09417624, -0.71665919, -0.45785892, -0.7942415 , -0.72798553],
       [-0.321252  , -0.63594137, -0.74863628, -1.05463724, -1.25724895]]), 0.33997062806223544), (array([[-3.03364679, -3.19180796, -2.81942828, -2.4989288 , -2.45601718],
       [ 1.86101453,  1.66221021,  1.64341433,  1.69711679,  1.22143629],
       [-0.71665919, -0.45785892, -0.7942415 , -0.72798553, -0.724417  ],
       [-0.63594137, -0.74863628, -1.05463724, -1.25724895, -1.51099369]]), 0.5292367353499192), (array([[-3.19180796, -2.81942828, -2.4989288 , -2.45601718, -2.04315175],
       [ 1.66221021,  1.64341433,  1.69711679,  1.22143629,  1.45865465],
       [-0.45785892, -0.7942415 , -0.72798553, -0.724417  , -0.71259894],
       [-0.74863628, -1.05463724, -1.25724895, -1.51099369, -1.1216863 ]]), 0.17905916964046964), (array([[-2.81942828, -2.4989288 , -2.45601718, -2.04315175, -1.8003225 ],
       [ 1.64341433,  1.69711679,  1.22143629,  1.45865465,  1.27694606],
       [-0.7942415 , -0.72798553, -0.724417  , -0.71259894, -0.62479947],
       [-1.05463724, -1.25724895, -1.51099369, -1.1216863 , -1.37759408]]), -0.2881784087520787), (array([[-2.4989288 , -2.45601718, -2.04315175, -1.8003225 , -2.00767453],
       [ 1.69711679,  1.22143629,  1.45865465,  1.27694606,  1.19099819],
       [-0.72798553, -0.724417  , -0.71259894, -0.62479947, -0.64594328],
       [-1.25724895, -1.51099369, -1.1216863 , -1.37759408, -1.13647673]]), -0.7274847705550098), (array([[-2.45601718, -2.04315175, -1.8003225 , -2.00767453, -2.18083993],
       [ 1.22143629,  1.45865465,  1.27694606,  1.19099819,  1.21687783],
       [-0.724417  , -0.71259894, -0.62479947, -0.64594328, -0.90347367],
       [-1.51099369, -1.1216863 , -1.37759408, -1.13647673, -0.80113097]]), -0.6609713996331451), (array([[-2.04315175, -1.8003225 , -2.00767453, -2.18083993, -1.7517819 ],
       [ 1.45865465,  1.27694606,  1.19099819,  1.21687783,  0.79210817],
       [-0.71259894, -0.62479947, -0.64594328, -0.90347367, -0.98002261],
       [-1.1216863 , -1.37759408, -1.13647673, -0.80113097, -0.80036852]]), -1.0645558298882218), (array([[-1.8003225 , -2.00767453, -2.18083993, -1.7517819 , -1.83110441],
       [ 1.27694606,  1.19099819,  1.21687783,  0.79210817,  1.06997598],
       [-0.62479947, -0.64594328, -0.90347367, -0.98002261, -1.16077648],
       [-1.37759408, -1.13647673, -0.80113097, -0.80036852, -1.02398832]]), -1.09080849021433), (array([[-2.00767453, -2.18083993, -1.7517819 , -1.83110441, -1.34914588],
       [ 1.19099819,  1.21687783,  0.79210817,  1.06997598,  1.04432533],
       [-0.64594328, -0.90347367, -0.98002261, -1.16077648, -1.09609546],
       [-1.13647673, -0.80113097, -0.80036852, -1.02398832, -1.22203849]]), -1.2459631892216114), (array([[-2.18083993, -1.7517819 , -1.83110441, -1.34914588, -1.42766062],
       [ 1.21687783,  0.79210817,  1.06997598,  1.04432533,  0.82449811],
       [-0.90347367, -0.98002261, -1.16077648, -1.09609546, -0.88540334],
       [-0.80113097, -0.80036852, -1.02398832, -1.22203849, -1.08630093]]), -1.5270467663895606), (array([[-1.7517819 , -1.83110441, -1.34914588, -1.42766062, -1.81437805],
       [ 0.79210817,  1.06997598,  1.04432533,  0.82449811,  1.07983482],
       [-0.98002261, -1.16077648, -1.09609546, -0.88540334, -0.76615081],
       [-0.80036852, -1.02398832, -1.22203849, -1.08630093, -1.22199237]]), -1.7472724161850381), (array([[-1.83110441, -1.34914588, -1.42766062, -1.81437805, -1.65921694],
       [ 1.06997598,  1.04432533,  0.82449811,  1.07983482,  0.9142542 ],
       [-1.16077648, -1.09609546, -0.88540334, -0.76615081, -0.40629254],
       [-1.02398832, -1.22203849, -1.08630093, -1.22199237, -1.44196473]]), -1.9717054319421976), (array([[-1.34914588, -1.42766062, -1.81437805, -1.65921694, -1.96454253],
       [ 1.04432533,  0.82449811,  1.07983482,  0.9142542 ,  1.09063191],
       [-1.09609546, -0.88540334, -0.76615081, -0.40629254, -0.37754734],
       [-1.22203849, -1.08630093, -1.22199237, -1.44196473, -1.15839843]]), -1.9766592452381846), (array([[-1.42766062, -1.81437805, -1.65921694, -1.96454253, -2.38085442],
       [ 0.82449811,  1.07983482,  0.9142542 ,  1.09063191,  1.14472314],
       [-0.88540334, -0.76615081, -0.40629254, -0.37754734, -0.58179802],
       [-1.08630093, -1.22199237, -1.44196473, -1.15839843, -1.44510925]]), -2.0461988413394847), (array([[-1.81437805, -1.65921694, -1.96454253, -2.38085442, -2.27102682],
       [ 1.07983482,  0.9142542 ,  1.09063191,  1.14472314,  0.8193359 ],
       [-0.76615081, -0.40629254, -0.37754734, -0.58179802, -0.17389808],
       [-1.22199237, -1.44196473, -1.15839843, -1.44510925, -1.07922454]]), -1.5496957184137528), (array([[-1.65921694, -1.96454253, -2.38085442, -2.27102682, -2.37691925],
       [ 0.9142542 ,  1.09063191,  1.14472314,  0.8193359 ,  1.26847401],
       [-0.40629254, -0.37754734, -0.58179802, -0.17389808, -0.07183039],
       [-1.44196473, -1.15839843, -1.44510925, -1.07922454, -0.80156566]]), -1.1536627890935787), (array([[-1.96454253, -2.38085442, -2.27102682, -2.37691925, -2.38827973],
       [ 1.09063191,  1.14472314,  0.8193359 ,  1.26847401,  1.31869259],
       [-0.37754734, -0.58179802, -0.17389808, -0.07183039, -0.01697333],
       [-1.15839843, -1.44510925, -1.07922454, -0.80156566, -0.8877792 ]]), -0.9287991111776871), (array([[-2.38085442, -2.27102682, -2.37691925, -2.38827973, -2.27917923],
       [ 1.14472314,  0.8193359 ,  1.26847401,  1.31869259,  1.15058328],
       [-0.58179802, -0.17389808, -0.07183039, -0.01697333, -0.0089863 ],
       [-1.44510925, -1.07922454, -0.80156566, -0.8877792 , -1.32551492]]), -0.8286428098941336), (array([[-2.27102682, -2.37691925, -2.38827973, -2.27917923, -2.5307467 ],
       [ 0.8193359 ,  1.26847401,  1.31869259,  1.15058328,  0.82866684],
       [-0.17389808, -0.07183039, -0.01697333, -0.0089863 ,  0.1792676 ],
       [-1.07922454, -0.80156566, -0.8877792 , -1.32551492, -1.54828832]]), -0.6115089573678338), (array([[-2.37691925, -2.38827973, -2.27917923, -2.5307467 , -2.95776103],
       [ 1.26847401,  1.31869259,  1.15058328,  0.82866684,  0.9024912 ],
       [-0.07183039, -0.01697333, -0.0089863 ,  0.1792676 ,  0.65317235],
       [-0.80156566, -0.8877792 , -1.32551492, -1.54828832, -1.77507907]]), -0.6682081692808237), (array([[-2.38827973, -2.27917923, -2.5307467 , -2.95776103, -3.39996717],
       [ 1.31869259,  1.15058328,  0.82866684,  0.9024912 ,  0.91702958],
       [-0.01697333, -0.0089863 ,  0.1792676 ,  0.65317235,  1.03110193],
       [-0.8877792 , -1.32551492, -1.54828832, -1.77507907, -1.38749728]]), -1.0165441928769807), (array([[-2.27917923, -2.5307467 , -2.95776103, -3.39996717, -3.51095442],
       [ 1.15058328,  0.82866684,  0.9024912 ,  0.91702958,  0.81814304],
       [-0.0089863 ,  0.1792676 ,  0.65317235,  1.03110193,  0.53909375],
       [-1.32551492, -1.54828832, -1.77507907, -1.38749728, -1.79541231]]), -0.5232323105708253), (array([[-2.5307467 , -2.95776103, -3.39996717, -3.51095442, -3.72751132],
       [ 0.82866684,  0.9024912 ,  0.91702958,  0.81814304,  0.57772469],
       [ 0.1792676 ,  0.65317235,  1.03110193,  0.53909375,  0.16673675],
       [-1.54828832, -1.77507907, -1.38749728, -1.79541231, -2.25327969]]), -0.37896583298650377), (array([[-2.95776103, -3.39996717, -3.51095442, -3.72751132, -3.47871748],
       [ 0.9024912 ,  0.91702958,  0.81814304,  0.57772469,  1.03049024],
       [ 0.65317235,  1.03110193,  0.53909375,  0.16673675, -0.29347719],
       [-1.77507907, -1.38749728, -1.79541231, -2.25327969, -1.84152645]]), -0.7016693024321428), (array([[-3.39996717, -3.51095442, -3.72751132, -3.47871748, -3.69825446],
       [ 0.91702958,  0.81814304,  0.57772469,  1.03049024,  1.13503539],
       [ 1.03110193,  0.53909375,  0.16673675, -0.29347719, -0.48046902],
       [-1.38749728, -1.79541231, -2.25327969, -1.84152645, -1.75450316]]), -1.1528523067043932), (array([[-3.51095442, -3.72751132, -3.47871748, -3.69825446, -4.11421635],
       [ 0.81814304,  0.57772469,  1.03049024,  1.13503539,  1.61808725],
       [ 0.53909375,  0.16673675, -0.29347719, -0.48046902, -0.41883066],
       [-1.79541231, -2.25327969, -1.84152645, -1.75450316, -2.03460938]]), -1.0549605615517605), (array([[-3.72751132, -3.47871748, -3.69825446, -4.11421635, -4.5775786 ],
       [ 0.57772469,  1.03049024,  1.13503539,  1.61808725,  2.03438909],
       [ 0.16673675, -0.29347719, -0.48046902, -0.41883066, -0.90777955],
       [-2.25327969, -1.84152645, -1.75450316, -2.03460938, -1.63030793]]), -1.1363595524642731), (array([[-3.47871748, -3.69825446, -4.11421635, -4.5775786 , -4.92858636],
       [ 1.03049024,  1.13503539,  1.61808725,  2.03438909,  2.26717387],
       [-0.29347719, -0.48046902, -0.41883066, -0.90777955, -0.67982891],
       [-1.84152645, -1.75450316, -2.03460938, -1.63030793, -1.70426354]]), -0.6452043991225866), (array([[-3.69825446, -4.11421635, -4.5775786 , -4.92858636, -5.0718567 ],
       [ 1.13503539,  1.61808725,  2.03438909,  2.26717387,  2.50333801],
       [-0.48046902, -0.41883066, -0.90777955, -0.67982891, -0.55144242],
       [-1.75450316, -2.03460938, -1.63030793, -1.70426354, -1.82594182]]), -0.725390196790062), (array([[-4.11421635, -4.5775786 , -4.92858636, -5.0718567 , -5.10844665],
       [ 1.61808725,  2.03438909,  2.26717387,  2.50333801,  2.51214414],
       [-0.41883066, -0.90777955, -0.67982891, -0.55144242, -0.13711757],
       [-2.03460938, -1.63030793, -1.70426354, -1.82594182, -1.63129647]]), -0.42718366007893815), (array([[-4.5775786 , -4.92858636, -5.0718567 , -5.10844665, -5.1906104 ],
       [ 2.03438909,  2.26717387,  2.50333801,  2.51214414,  2.77479557],
       [-0.90777955, -0.67982891, -0.55144242, -0.13711757,  0.14087584],
       [-1.63030793, -1.70426354, -1.82594182, -1.63129647, -1.18491018]]), -0.6758109142368695), (array([[-4.92858636, -5.0718567 , -5.10844665, -5.1906104 , -5.67909181],
       [ 2.26717387,  2.50333801,  2.51214414,  2.77479557,  3.19589963],
       [-0.67982891, -0.55144242, -0.13711757,  0.14087584, -0.34652852],
       [-1.70426354, -1.82594182, -1.63129647, -1.18491018, -1.65269108]]), -0.633820099781011), (array([[-5.0718567 , -5.10844665, -5.1906104 , -5.67909181, -5.9591869 ],
       [ 2.50333801,  2.51214414,  2.77479557,  3.19589963,  3.00127217],
       [-0.55144242, -0.13711757,  0.14087584, -0.34652852,  0.01933569],
       [-1.82594182, -1.63129647, -1.18491018, -1.65269108, -1.32922198]]), -0.5697441418963027), (array([[-5.10844665, -5.1906104 , -5.67909181, -5.9591869 , -6.41513222],
       [ 2.51214414,  2.77479557,  3.19589963,  3.00127217,  2.90850937],
       [-0.13711757,  0.14087584, -0.34652852,  0.01933569, -0.47777894],
       [-1.63129647, -1.18491018, -1.65269108, -1.32922198, -1.37040595]]), -0.22682670456442566), (array([[-5.1906104 , -5.67909181, -5.9591869 , -6.41513222, -5.95793241],
       [ 2.77479557,  3.19589963,  3.00127217,  2.90850937,  3.24106598],
       [ 0.14087584, -0.34652852,  0.01933569, -0.47777894, -0.19295424],
       [-1.18491018, -1.65269108, -1.32922198, -1.37040595, -1.19996761]]), -0.25704388133721423)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>-0.343548</td>
      <td>-0.754765</td>
      <td>-0.990946</td>
      <td>-1.330506</td>
      <td>-1.412025</td>
      <td>-1.557422</td>
      <td>-1.962530</td>
      <td>-1.974792</td>
      <td>-2.435231</td>
      <td>-1.966618</td>
      <td>...</td>
      <td>-1.146415</td>
      <td>-0.760690</td>
      <td>-1.010391</td>
      <td>-0.905960</td>
      <td>-0.540040</td>
      <td>-0.400541</td>
      <td>-0.068145</td>
      <td>0.206179</td>
      <td>0.173962</td>
      <td>0.550026</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>0.163559</td>
      <td>-0.042791</td>
      <td>0.394476</td>
      <td>-0.008583</td>
      <td>0.128578</td>
      <td>0.230359</td>
      <td>-0.192737</td>
      <td>-0.159447</td>
      <td>0.218067</td>
      <td>0.692361</td>
      <td>...</td>
      <td>-0.016595</td>
      <td>-0.233715</td>
      <td>-0.061918</td>
      <td>-0.120639</td>
      <td>0.177181</td>
      <td>0.470482</td>
      <td>-0.009560</td>
      <td>0.444515</td>
      <td>0.835720</td>
      <td>1.314142</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>0.488855</td>
      <td>0.831578</td>
      <td>0.831415</td>
      <td>1.321958</td>
      <td>1.559043</td>
      <td>1.209686</td>
      <td>1.064485</td>
      <td>0.971634</td>
      <td>1.405403</td>
      <td>1.741849</td>
      <td>...</td>
      <td>4.693412</td>
      <td>4.672345</td>
      <td>4.826271</td>
      <td>4.658941</td>
      <td>4.350230</td>
      <td>4.142374</td>
      <td>3.662338</td>
      <td>3.821133</td>
      <td>3.402420</td>
      <td>2.989725</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.163761</td>
      <td>0.609859</td>
      <td>1.008952</td>
      <td>0.557750</td>
      <td>0.289636</td>
      <td>0.581143</td>
      <td>0.117276</td>
      <td>0.146402</td>
      <td>-0.334004</td>
      <td>-0.106966</td>
      <td>...</td>
      <td>-0.810066</td>
      <td>-0.507501</td>
      <td>-0.259201</td>
      <td>-0.652621</td>
      <td>-1.064247</td>
      <td>-0.790305</td>
      <td>-0.775600</td>
      <td>-0.456453</td>
      <td>-0.049381</td>
      <td>0.319582</td>
    </tr>
    <tr>
      <th>target</th>
      <td>0.355675</td>
      <td>0.774796</td>
      <td>1.060826</td>
      <td>0.635440</td>
      <td>0.528663</td>
      <td>0.621930</td>
      <td>0.603941</td>
      <td>0.953005</td>
      <td>0.968425</td>
      <td>1.250766</td>
      <td>...</td>
      <td>1.757453</td>
      <td>1.441932</td>
      <td>1.236830</td>
      <td>0.938502</td>
      <td>1.061722</td>
      <td>0.800560</td>
      <td>1.201657</td>
      <td>1.699309</td>
      <td>1.693872</td>
      <td>1.671725</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[-0.34354848, -0.75476456, -0.99094598, -1.33050602, -1.41202511],
       [ 0.16355906, -0.042791  ,  0.39447564, -0.00858334,  0.12857801],
       [ 0.48885544,  0.83157785,  0.83141529,  1.32195817,  1.55904275],
       [ 0.16376108,  0.60985929,  1.00895165,  0.55774989,  0.28963611]]), 0.5286631225577965), (array([[-1.55742186, -1.96253007, -1.97479218, -2.43523086, -1.96661814],
       [ 0.23035938, -0.19273734, -0.15944697,  0.21806681,  0.69236128],
       [ 1.2096861 ,  1.06448549,  0.97163411,  1.40540302,  1.74184867],
       [ 0.58114313,  0.11727605,  0.14640152, -0.33400436, -0.10696596]]), 1.2507660291470657), (array([[-1.89957568, -1.97830453, -2.24612054, -2.05179511, -2.10237234],
       [ 0.79614964,  0.7302139 ,  0.82274573,  0.96843145,  0.61991805],
       [ 1.97471643,  2.02888612,  1.81287209,  2.14053233,  1.77181774],
       [-0.22525866,  0.10437429,  0.42964644,  0.779213  ,  0.58849785]]), 1.6585670181632466), (array([[-1.7189568 , -1.84973452, -1.57365648, -1.93504635, -1.75832023],
       [ 0.60083966,  0.68603312,  0.60399581,  0.63795975,  0.14176845],
       [ 2.0200392 ,  1.64573583,  1.82820161,  1.32891824,  1.21083796],
       [ 0.14361036,  0.25675577, -0.14210578, -0.21857287, -0.66310264]]), 2.197097405107974), (array([[-2.1352913 , -2.04120476, -1.55222987, -1.2114518 , -1.60361971],
       [-0.18909226,  0.30662105,  0.13745953,  0.13291443,  0.47501071],
       [ 1.48133804,  1.16651096,  1.0606809 ,  1.19529225,  1.18271585],
       [-0.22908494, -0.65753747, -0.51549179, -0.13679966, -0.54558572]]), 2.138729053691339), (array([[-1.52200203, -2.01751335, -1.88543974, -2.28050729, -1.79537748],
       [ 0.88482375,  0.89000342,  0.78074162,  1.01503427,  1.00428866],
       [ 1.31120931,  1.75316678,  1.68160467,  1.86986393,  2.16284632],
       [-0.56668471, -0.92920571, -1.40596279, -1.76279358, -1.75638074]]), 2.1423584650630016), (array([[-1.33856157, -1.55366241, -1.73383139, -2.13673667, -1.87863644],
       [ 0.74289383,  1.12446788,  1.60921651,  1.90212562,  1.6453706 ],
       [ 2.55649947,  2.67909113,  3.17373772,  2.77419475,  2.96108078],
       [-2.21892828, -2.18419212, -1.7681726 , -1.8995664 , -2.11254771]]), 1.9067105429679982), (array([[-2.10582201, -2.1233105 , -1.83175886, -2.00674393, -1.75651733],
       [ 2.08898701,  1.67261649,  1.21948803,  1.45818546,  1.54740868],
       [ 2.78502984,  3.00118717,  3.29478823,  3.07412916,  2.60114361],
       [-2.30781353, -2.07066342, -2.45181313, -2.13080246, -1.7253709 ]]), 2.461484205992166), (array([[-1.56799036, -1.44195688, -1.39303906, -1.17242469, -0.84846247],
       [ 1.34940538,  1.24035007,  1.03735547,  0.65279926,  1.00736016],
       [ 2.62326826,  2.1351014 ,  2.10073558,  2.32880682,  2.60885779],
       [-1.96894309, -2.45562171, -2.71750654, -2.83042042, -2.33900672]]), 2.9090456889303216), (array([[-0.95594507, -1.13389073, -0.7439362 , -0.3890286 , -0.43547745],
       [ 0.82267787,  0.36281953,  0.48001229,  0.42900935,  0.75315977],
       [ 2.13619692,  2.24134642,  2.39680932,  2.59933441,  2.89680074],
       [-2.53758453, -2.65204376, -2.27411177, -2.37999164, -2.01043551]]), 2.05562080914175), (array([[-0.45679488, -0.5017248 , -0.01988429, -0.13894742, -0.4760443 ],
       [ 0.41291725,  0.3890175 ,  0.36828482,  0.28054102,  0.22992261],
       [ 2.91331293,  3.09635824,  2.80836396,  3.24468682,  3.00109521],
       [-1.82688115, -1.65818866, -1.39537856, -1.75292101, -1.28091917]]), 3.13156003077815), (array([[-0.82574592, -0.84280768, -1.15915733, -1.53556854, -1.38879538],
       [-0.24006431,  0.23564343,  0.47205298,  0.81447003,  0.57241303],
       [ 3.32653025,  3.75507871,  3.76024659,  4.23666236,  4.02716878],
       [-1.49026249, -1.74451081, -1.68502979, -1.85688272, -2.10039907]]), 2.8161705727219593), (array([[-1.31889293, -0.96233239, -0.83328383, -0.60189638, -0.43545513],
       [ 0.49355589,  0.21278926,  0.12746651, -0.35034459, -0.27134377],
       [ 4.01150715,  3.9890829 ,  3.69810489,  3.67366541,  3.59207491],
       [-2.07292351, -1.84823022, -1.7503184 , -1.65708092, -1.27043588]]), 3.6012147330226396), (array([[-0.73871239, -0.51276478, -0.79174569, -0.5569122 , -0.11950592],
       [-0.27324831, -0.31083632,  0.12175052, -0.03656603, -0.13745884],
       [ 3.94409292,  4.20127636,  4.36164419,  4.62773337,  4.20263473],
       [-0.8421095 , -1.02219258, -0.8165627 , -1.04311967, -0.91020114]]), 3.6564270653770836), (array([[-0.50016246, -0.51130784, -0.43133824, -0.65739903, -0.64169805],
       [-0.14993992,  0.10802612, -0.18144751, -0.31975965, -0.76349823],
       [ 4.49171451,  4.93379673,  5.19964446,  5.17485405,  5.62103764],
       [-1.28737388, -0.83902601, -0.45797673, -0.83517438, -0.38856226]]), 4.103734464347161), (array([[-0.83247568, -0.91116359, -0.68808672, -0.77721156, -1.18226012],
       [-0.58930681, -0.38613443, -0.58261133, -0.56386183, -0.3726557 ],
       [ 5.34786522,  4.85015291,  4.3944038 ,  4.39156974,  4.41903981],
       [-0.22433917,  0.11823601,  0.13353686, -0.16278213, -0.38035404]]), 3.017994280482504), (array([[-0.88317776, -1.21681875, -1.67954259, -1.57503572, -1.54889911],
       [-0.15090151, -0.22634853, -0.41393171, -0.84533948, -1.04851193],
       [ 4.28231458,  4.08668614,  4.33951249,  4.46981109,  4.13674849],
       [-0.1037014 ,  0.1411723 ,  0.44603011, -0.03528542, -0.45543899]]), 3.030530827403906), (array([[-1.35073886, -1.30286226, -1.13728743, -1.14221391, -1.23027008],
       [-1.32511162, -1.12611181, -0.86281101, -0.80643159, -0.46622249],
       [ 4.27353776,  4.02949802,  4.52576573,  4.54324832,  4.45195327],
       [-0.35389204, -0.34664468, -0.75132737, -0.65311763, -0.58973627]]), 1.6925859595326238), (array([[-1.14641504, -0.76069031, -1.01039077, -0.90596034, -0.54004027],
       [-0.01659461, -0.23371454, -0.06191824, -0.12063887,  0.17718137],
       [ 4.69341232,  4.67234547,  4.82627062,  4.65894074,  4.35022954],
       [-0.81006588, -0.50750063, -0.25920068, -0.65262098, -1.06424667]]), 1.0617219236032183), (array([[-0.40054105, -0.06814548,  0.20617901,  0.17396168,  0.55002612],
       [ 0.47048236, -0.0095603 ,  0.44451535,  0.83572015,  1.31414235],
       [ 4.14237364,  3.66233778,  3.82113311,  3.40241962,  2.98972519],
       [-0.79030504, -0.77559983, -0.45645341, -0.04938066,  0.31958168]]), 1.6717247737931205)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TrainValidTestSplitter</span><span class="p">(</span><span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.014859</td>
      <td>0.417285</td>
      <td>-0.056309</td>
      <td>-0.242727</td>
      <td>0.166490</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.243699</td>
      <td>0.834754</td>
      <td>0.177594</td>
      <td>-0.273107</td>
      <td>-0.053451</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.395490</td>
      <td>1.111600</td>
      <td>0.466471</td>
      <td>-0.184783</td>
      <td>0.206307</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.115607</td>
      <td>1.319305</td>
      <td>0.090760</td>
      <td>-0.320072</td>
      <td>0.518329</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.182939</td>
      <td>1.168774</td>
      <td>0.402266</td>
      <td>-0.740028</td>
      <td>0.131642</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1.911218</td>
      <td>6.747716</td>
      <td>5.645412</td>
      <td>-6.009719</td>
      <td>-1.049908</td>
    </tr>
    <tr>
      <th>96</th>
      <td>2.246228</td>
      <td>6.328891</td>
      <td>5.327188</td>
      <td>-6.063094</td>
      <td>-1.052925</td>
    </tr>
    <tr>
      <th>97</th>
      <td>2.296534</td>
      <td>6.342581</td>
      <td>5.067742</td>
      <td>-6.317340</td>
      <td>-0.867247</td>
    </tr>
    <tr>
      <th>98</th>
      <td>2.144480</td>
      <td>6.435208</td>
      <td>4.672590</td>
      <td>-6.524465</td>
      <td>-0.980075</td>
    </tr>
    <tr>
      <th>99</th>
      <td>1.839816</td>
      <td>6.507752</td>
      <td>4.476993</td>
      <td>-6.312033</td>
      <td>-0.630620</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((96, 4, 5),
 (96,),
 (#2) [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76],[77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

