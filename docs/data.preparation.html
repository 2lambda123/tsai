---

title: Data preparation


keywords: fastai
sidebar: home_sidebar

summary: "Functions required to prepare X (and y) from a pandas dataframe."
description: "Functions required to prepare X (and y) from a pandas dataframe."
nb_path: "nbs/000c_data.preparation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/000c_data.preparation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2xy" class="doc_header"><code>df2xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2xy</code>(<strong><code>df</code></strong>, <strong><code>feat_col</code></strong>=<em><code>None</code></em>, <strong><code>target_col</code></strong>=<em><code>None</code></em>, <strong><code>data_cols</code></strong>=<em><code>None</code></em>, <strong><code>to3d</code></strong>=<em><code>True</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>This function allows you to transform a pandas dataframe into X and y numpy arrays that can be used to craete a TSDataset.
feat_col: used for multivariate datasets. It indicates which is the column that indicates the feature by row.
target_col: indicates the column/s where the target is.
data_col: indicates where the data is located. If None, it means all columns (excpet the target)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_xy" class="doc_header"><code>split_xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_xy</code>(<strong><code>X</code></strong>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindow" class="doc_header"><code>SlidingWindow</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L57" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindow</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a 1d or 2d input (np.ndarray, torch.Tensor or pd.DataFrame)</p>
<p>Args:
    window_len      = length of lookback window
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5) [(array([[0, 1, 2, 3, 4]]),),(array([[1, 2, 3, 4, 5]]),),(array([[2, 3, 4, 5, 6]]),),(array([[3, 4, 5, 6, 7]]),),(array([[4, 5, 6, 7, 8]]),)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[3, 4, 5, 6, 7]]), 8)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
[(array([[3, 4, 5, 6, 7]]), 8), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[13, 14, 15, 16, 17]]), 18)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9), (array([[5, 6, 7, 8, 9]]), 10), (array([[ 6,  7,  8,  9, 10]]), 11), (array([[ 7,  8,  9, 10, 11]]), 12), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[ 9, 10, 11, 12, 13]]), 14), (array([[10, 11, 12, 13, 14]]), 15), (array([[11, 12, 13, 14, 15]]), 16), (array([[12, 13, 14, 15, 16]]), 17), (array([[13, 14, 15, 16, 17]]), 18), (array([[14, 15, 16, 17, 18]]), 19)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), array([  5,  50, 500])), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), array([  6,  60, 600])), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), array([  7,  70, 700])), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), array([  8,  80, 800])), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), array([  9,  90, 900]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), 5), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), 6), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), 7), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), 8), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0,  1,  2,  3,  4],
       [ 0, 10, 20, 30, 40]]), 500), (array([[ 1,  2,  3,  4,  5],
       [10, 20, 30, 40, 50]]), 600), (array([[ 2,  3,  4,  5,  6],
       [20, 30, 40, 50, 60]]), 700), (array([[ 3,  4,  5,  6,  7],
       [30, 40, 50, 60, 70]]), 800), (array([[ 4,  5,  6,  7,  8],
       [40, 50, 60, 70, 80]]), 900)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1000, 3)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(200, 2, 5) (200,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 3)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.029776</td>
      <td>-0.281398</td>
      <td>0.322126</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.116643</td>
      <td>0.216603</td>
      <td>0.515513</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.611688</td>
      <td>0.134343</td>
      <td>0.524650</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.352755</td>
      <td>-0.142178</td>
      <td>0.858897</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.362180</td>
      <td>-0.489662</td>
      <td>1.038174</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>4.895111</td>
      <td>-0.105752</td>
      <td>-4.863242</td>
    </tr>
    <tr>
      <th>96</th>
      <td>4.953744</td>
      <td>-0.501587</td>
      <td>-5.212310</td>
    </tr>
    <tr>
      <th>97</th>
      <td>4.792221</td>
      <td>-0.992550</td>
      <td>-5.076905</td>
    </tr>
    <tr>
      <th>98</th>
      <td>4.621897</td>
      <td>-1.146397</td>
      <td>-5.330098</td>
    </tr>
    <tr>
      <th>99</th>
      <td>4.614357</td>
      <td>-0.739124</td>
      <td>-5.781600</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 3 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 2, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.239797</td>
      <td>-0.129864</td>
      <td>0.195506</td>
      <td>0.264663</td>
      <td>0.045329</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.318406</td>
      <td>0.059941</td>
      <td>0.679942</td>
      <td>0.746396</td>
      <td>-0.199413</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.398272</td>
      <td>0.240758</td>
      <td>0.871253</td>
      <td>0.882071</td>
      <td>0.097306</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.054506</td>
      <td>0.394661</td>
      <td>1.364456</td>
      <td>0.846861</td>
      <td>-0.252694</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.332333</td>
      <td>0.584105</td>
      <td>1.716370</td>
      <td>0.455408</td>
      <td>-0.534200</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-3.068178</td>
      <td>-3.564382</td>
      <td>-0.313436</td>
      <td>-0.648686</td>
      <td>-0.760783</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-3.193162</td>
      <td>-3.303104</td>
      <td>-0.051597</td>
      <td>-0.779927</td>
      <td>-0.625620</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-3.686377</td>
      <td>-3.466915</td>
      <td>0.081543</td>
      <td>-1.137965</td>
      <td>-0.324505</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-3.995085</td>
      <td>-3.199100</td>
      <td>0.412080</td>
      <td>-1.086118</td>
      <td>-0.412311</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-3.663787</td>
      <td>-3.187245</td>
      <td>0.240894</td>
      <td>-0.672689</td>
      <td>-0.456074</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>0.360357</td>
      <td>0.048620</td>
      <td>0.413451</td>
      <td>0.099719</td>
      <td>-0.360537</td>
      <td>-0.440102</td>
      <td>-0.302473</td>
      <td>0.111343</td>
      <td>-0.286050</td>
      <td>-0.616943</td>
      <td>...</td>
      <td>3.148811</td>
      <td>3.044680</td>
      <td>2.597495</td>
      <td>2.271566</td>
      <td>2.177474</td>
      <td>2.220105</td>
      <td>2.356764</td>
      <td>2.608960</td>
      <td>2.663523</td>
      <td>2.754237</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.196197</td>
      <td>-0.314788</td>
      <td>-0.712418</td>
      <td>-1.022799</td>
      <td>-1.477619</td>
      <td>-1.663958</td>
      <td>-2.131056</td>
      <td>-2.224946</td>
      <td>-2.126429</td>
      <td>-2.289807</td>
      <td>...</td>
      <td>-6.556139</td>
      <td>-6.895965</td>
      <td>-6.879850</td>
      <td>-6.656325</td>
      <td>-6.923106</td>
      <td>-6.455349</td>
      <td>-6.509174</td>
      <td>-6.480582</td>
      <td>-6.252296</td>
      <td>-5.871198</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.042275</td>
      <td>-0.118983</td>
      <td>0.194791</td>
      <td>-0.089968</td>
      <td>-0.254794</td>
      <td>-0.723888</td>
      <td>-1.145995</td>
      <td>-1.607368</td>
      <td>-1.378133</td>
      <td>-1.182850</td>
      <td>...</td>
      <td>-4.887090</td>
      <td>-4.390666</td>
      <td>-4.169196</td>
      <td>-4.412006</td>
      <td>-4.032416</td>
      <td>-3.634720</td>
      <td>-3.498063</td>
      <td>-3.046012</td>
      <td>-3.390690</td>
      <td>-2.967178</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.298427</td>
      <td>0.081641</td>
      <td>0.379784</td>
      <td>0.850299</td>
      <td>1.204950</td>
      <td>0.715222</td>
      <td>0.543036</td>
      <td>0.071033</td>
      <td>-0.366391</td>
      <td>0.065321</td>
      <td>...</td>
      <td>4.705937</td>
      <td>5.200781</td>
      <td>5.596277</td>
      <td>5.897672</td>
      <td>5.712352</td>
      <td>5.295565</td>
      <td>4.819670</td>
      <td>4.969794</td>
      <td>4.878464</td>
      <td>4.883550</td>
    </tr>
    <tr>
      <th>target</th>
      <td>-0.000707</td>
      <td>0.265945</td>
      <td>0.391243</td>
      <td>0.380577</td>
      <td>-0.016931</td>
      <td>-0.369030</td>
      <td>-0.699432</td>
      <td>-1.070594</td>
      <td>-0.934723</td>
      <td>-1.074331</td>
      <td>...</td>
      <td>2.507043</td>
      <td>2.240616</td>
      <td>2.063752</td>
      <td>1.800654</td>
      <td>2.204464</td>
      <td>2.076473</td>
      <td>2.392694</td>
      <td>2.748649</td>
      <td>2.599692</td>
      <td>2.927662</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>-0.307891</td>
      <td>-0.680691</td>
      <td>-0.971275</td>
      <td>-0.903366</td>
      <td>-0.880269</td>
      <td>-0.578758</td>
      <td>-0.354677</td>
      <td>0.037448</td>
      <td>0.225161</td>
      <td>0.303751</td>
      <td>...</td>
      <td>1.130736</td>
      <td>1.226246</td>
      <td>1.008410</td>
      <td>1.127815</td>
      <td>1.198307</td>
      <td>1.406106</td>
      <td>1.480793</td>
      <td>1.465019</td>
      <td>1.740241</td>
      <td>1.531030</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>0.496693</td>
      <td>0.728292</td>
      <td>0.252945</td>
      <td>0.194296</td>
      <td>0.326399</td>
      <td>0.819258</td>
      <td>0.983751</td>
      <td>1.217982</td>
      <td>1.670058</td>
      <td>2.022660</td>
      <td>...</td>
      <td>-1.553760</td>
      <td>-1.231457</td>
      <td>-1.687037</td>
      <td>-1.635894</td>
      <td>-1.221475</td>
      <td>-0.996024</td>
      <td>-0.728344</td>
      <td>-0.433682</td>
      <td>-0.277160</td>
      <td>-0.016137</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.140909</td>
      <td>0.016685</td>
      <td>0.092374</td>
      <td>-0.342866</td>
      <td>-0.039320</td>
      <td>0.305188</td>
      <td>0.355112</td>
      <td>0.687258</td>
      <td>1.051752</td>
      <td>0.869136</td>
      <td>...</td>
      <td>5.157599</td>
      <td>5.463519</td>
      <td>5.765616</td>
      <td>5.282730</td>
      <td>5.643863</td>
      <td>5.485500</td>
      <td>5.845027</td>
      <td>6.107019</td>
      <td>6.291865</td>
      <td>6.559871</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.076288</td>
      <td>0.137703</td>
      <td>0.308522</td>
      <td>0.454071</td>
      <td>0.163490</td>
      <td>0.064716</td>
      <td>0.339743</td>
      <td>0.720224</td>
      <td>0.864307</td>
      <td>0.553046</td>
      <td>...</td>
      <td>1.515663</td>
      <td>1.344528</td>
      <td>0.889313</td>
      <td>0.717487</td>
      <td>0.790441</td>
      <td>0.891341</td>
      <td>1.025512</td>
      <td>1.407364</td>
      <td>1.873164</td>
      <td>2.131167</td>
    </tr>
    <tr>
      <th>target</th>
      <td>-0.083911</td>
      <td>-0.353171</td>
      <td>-0.504475</td>
      <td>-0.808014</td>
      <td>-1.044764</td>
      <td>-0.703799</td>
      <td>-1.128885</td>
      <td>-1.540526</td>
      <td>-1.402961</td>
      <td>-1.709990</td>
      <td>...</td>
      <td>-2.266192</td>
      <td>-2.636896</td>
      <td>-2.474454</td>
      <td>-2.818294</td>
      <td>-2.662756</td>
      <td>-2.359277</td>
      <td>-2.440492</td>
      <td>-2.098450</td>
      <td>-1.826978</td>
      <td>-1.948909</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(20, 4, 5) (20,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TrainValidTestSplitter</span><span class="p">(</span><span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.151412</td>
      <td>0.326668</td>
      <td>-0.384813</td>
      <td>0.051406</td>
      <td>0.374783</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.163064</td>
      <td>0.457503</td>
      <td>-0.713830</td>
      <td>-0.224829</td>
      <td>-0.117548</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.009085</td>
      <td>0.606809</td>
      <td>-0.331780</td>
      <td>-0.060382</td>
      <td>-0.203062</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.466919</td>
      <td>1.073044</td>
      <td>-0.068486</td>
      <td>-0.371251</td>
      <td>-0.580316</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.862583</td>
      <td>0.687384</td>
      <td>0.266228</td>
      <td>-0.464771</td>
      <td>-0.167245</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1.219218</td>
      <td>-1.304008</td>
      <td>1.266419</td>
      <td>4.450500</td>
      <td>-2.714188</td>
    </tr>
    <tr>
      <th>96</th>
      <td>1.105176</td>
      <td>-1.081294</td>
      <td>0.945156</td>
      <td>4.882208</td>
      <td>-2.903320</td>
    </tr>
    <tr>
      <th>97</th>
      <td>1.553123</td>
      <td>-1.394615</td>
      <td>1.220843</td>
      <td>4.382732</td>
      <td>-2.502012</td>
    </tr>
    <tr>
      <th>98</th>
      <td>1.897070</td>
      <td>-1.417215</td>
      <td>1.571459</td>
      <td>4.348431</td>
      <td>-2.607927</td>
    </tr>
    <tr>
      <th>99</th>
      <td>2.282245</td>
      <td>-1.250333</td>
      <td>1.682933</td>
      <td>4.153020</td>
      <td>-2.173120</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((96, 4, 5),
 (96,),
 ((#77) [0,1,2,3,4,5,6,7,8,9...], (#19) [77,78,79,80,81,82,83,84,85,86...]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindowPanel" class="doc_header"><code>SlidingWindowPanel</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L136" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindowPanel</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>unique_id_cols</code></strong>:<code>list</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>return_key</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a pd.DataFrame.</p>
<p>Args:
    window_len      = length of lookback window
    unique_id_cols  = pd.DataFrame columns that will be used to identify a time series for each entity.
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y
return_key      = when True, the key corresponsing to unique_id_cols for each sample is returned


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var_0&#39;</span><span class="p">,</span> <span class="s1">&#39;var_1&#39;</span><span class="p">,</span> <span class="s1">&#39;var_2&#39;</span><span class="p">,</span> <span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>var_4</th>
      <th>var_5</th>
      <th>var_6</th>
      <th>var_7</th>
      <th>var_8</th>
      <th>var_9</th>
      <th>time</th>
      <th>device</th>
      <th>target</th>
      <th>region</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>74444</td>
      <td>744422</td>
      <td>7444202</td>
      <td>74442000</td>
      <td>744420000</td>
      <td>7444200000</td>
      <td>74442000000</td>
      <td>744420000000</td>
      <td>7444200000000</td>
      <td>74442000000000</td>
      <td>74442</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>174446</td>
    </tr>
    <tr>
      <th>1</th>
      <td>66184</td>
      <td>661822</td>
      <td>6618202</td>
      <td>66182000</td>
      <td>661820000</td>
      <td>6618200000</td>
      <td>66182000000</td>
      <td>661820000000</td>
      <td>6618200000000</td>
      <td>66182000000000</td>
      <td>66182</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>166186</td>
    </tr>
    <tr>
      <th>2</th>
      <td>87489</td>
      <td>874872</td>
      <td>8748702</td>
      <td>87487000</td>
      <td>874870000</td>
      <td>8748700000</td>
      <td>87487000000</td>
      <td>874870000000</td>
      <td>8748700000000</td>
      <td>87487000000000</td>
      <td>87487</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>187491</td>
    </tr>
    <tr>
      <th>3</th>
      <td>91832</td>
      <td>918320</td>
      <td>9183200</td>
      <td>91832000</td>
      <td>918320000</td>
      <td>9183200000</td>
      <td>91832000000</td>
      <td>918320000000</td>
      <td>9183200000000</td>
      <td>91832000000000</td>
      <td>91832</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>91832</td>
    </tr>
    <tr>
      <th>4</th>
      <td>73250</td>
      <td>732500</td>
      <td>7325000</td>
      <td>73250000</td>
      <td>732500000</td>
      <td>7325000000</td>
      <td>73250000000</td>
      <td>732500000000</td>
      <td>7325000000000</td>
      <td>73250000000000</td>
      <td>73250</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>73250</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(200004, 15)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                               <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_max</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">y_func</span><span class="o">=</span><span class="n">y_max</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199982, 10, 5), (199982,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

