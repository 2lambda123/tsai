---

title: Data preparation


keywords: fastai
sidebar: home_sidebar

summary: "Functions required to prepare X (and y) from a pandas dataframe."
description: "Functions required to prepare X (and y) from a pandas dataframe."
nb_path: "nbs/000c_data.preparation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/000c_data.preparation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2Xy" class="doc_header"><code>df2Xy</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2Xy</code>(<strong><code>df</code></strong>, <strong><code>sample_col</code></strong>=<em><code>None</code></em>, <strong><code>feat_col</code></strong>=<em><code>None</code></em>, <strong><code>data_cols</code></strong>=<em><code>None</code></em>, <strong><code>target_col</code></strong>=<em><code>None</code></em>, <strong><code>to3d</code></strong>=<em><code>True</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>, <strong><code>sort_by</code></strong>=<em><code>None</code></em>, <strong><code>ascending</code></strong>=<em><code>True</code></em>, <strong><code>y_func</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>This function allows you to transform a pandas dataframe into X and y numpy arrays that can be used to craete a TSDataset.
sample_col: column that uniquely identifies each sample.
feat_col: used for multivariate datasets. It indicates which is the column that indicates the feature by row.
data_col: indicates ths column/s where the data is located. If None, it means all columns (except the sample_col, feat_col, and target_col)
target_col: indicates the column/s where the target is.
to3d: turns X to 3d (including univariate time series)
sort_by: used to indicate how to sort the dataframe.
y_func: function used to calculate y for each sample (and target_col)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_Xy" class="doc_header"><code>split_Xy</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_Xy</code>(<strong><code>X</code></strong>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1_000</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="mi">10_000</span>

<span class="n">sample_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n_rows</span><span class="o">//</span><span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">feat_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_rows</span> <span class="o">//</span> <span class="n">n_samples</span><span class="p">),</span> <span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ind_cat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])[</span><span class="n">ind_cat</span><span class="p">]</span>
<span class="n">ind_cat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">target2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])[</span><span class="n">ind_cat2</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">sample_ids</span><span class="p">,</span> <span class="n">feat_ids</span><span class="p">,</span> <span class="n">cont</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target2&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">new_dtypes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sample_id&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">new_dtypes</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>feat_id</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>target</th>
      <th>target2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>915</td>
      <td>4</td>
      <td>-1.360003</td>
      <td>1.498529</td>
      <td>0.483889</td>
      <td>0.076380</td>
      <td>1.313898</td>
      <td>1.209177</td>
      <td>c</td>
      <td>c</td>
    </tr>
    <tr>
      <th>1</th>
      <td>54</td>
      <td>8</td>
      <td>-2.170919</td>
      <td>0.619842</td>
      <td>1.230493</td>
      <td>0.732896</td>
      <td>0.452333</td>
      <td>2.977231</td>
      <td>c</td>
      <td>c</td>
    </tr>
    <tr>
      <th>2</th>
      <td>803</td>
      <td>8</td>
      <td>-1.626732</td>
      <td>0.934001</td>
      <td>-1.262737</td>
      <td>0.107555</td>
      <td>0.448379</td>
      <td>1.605305</td>
      <td>c</td>
      <td>c</td>
    </tr>
    <tr>
      <th>3</th>
      <td>747</td>
      <td>9</td>
      <td>0.527584</td>
      <td>-1.586991</td>
      <td>-0.994099</td>
      <td>-1.551326</td>
      <td>-0.235878</td>
      <td>0.010780</td>
      <td>c</td>
      <td>c</td>
    </tr>
    <tr>
      <th>4</th>
      <td>542</td>
      <td>2</td>
      <td>-0.121319</td>
      <td>-1.267815</td>
      <td>-2.692272</td>
      <td>0.426934</td>
      <td>-0.142434</td>
      <td>0.318301</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>113</td>
      <td>5</td>
      <td>-0.068309</td>
      <td>1.469781</td>
      <td>2.608069</td>
      <td>-0.077965</td>
      <td>-0.810713</td>
      <td>0.548156</td>
      <td>c</td>
      <td>c</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>70</td>
      <td>4</td>
      <td>-1.687354</td>
      <td>-1.539154</td>
      <td>-0.350997</td>
      <td>-0.051386</td>
      <td>-0.307650</td>
      <td>-0.378541</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>432</td>
      <td>6</td>
      <td>-0.416184</td>
      <td>-1.015158</td>
      <td>0.165251</td>
      <td>0.365006</td>
      <td>0.315408</td>
      <td>-2.881720</td>
      <td>c</td>
      <td>c</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>617</td>
      <td>4</td>
      <td>1.082779</td>
      <td>-3.020131</td>
      <td>-0.369546</td>
      <td>-0.549992</td>
      <td>0.281327</td>
      <td>0.032137</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>656</td>
      <td>2</td>
      <td>0.430396</td>
      <td>0.493882</td>
      <td>1.156652</td>
      <td>0.255476</td>
      <td>-1.032389</td>
      <td>-0.359738</td>
      <td>b</td>
      <td>b</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 10 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;feat_id&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">],</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">rand_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sample_id</span><span class="p">))</span>
<span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">],</span> <span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;target&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span><span class="p">),</span> <span class="n">y</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;feat_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">rand_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sample_id</span><span class="p">))</span>
<span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">],</span> <span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span><span class="p">),</span> <span class="n">y</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;value_0;value_1;target</span>
<span class="s2">    rob;2;3;hot</span>
<span class="s2">    alice;6;7;lukewarm</span>
<span class="s2">    eve;11;12;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2Xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eve</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[[ 6,  7]],
 
        [[11, 12]],
 
        [[ 2,  3]]]),
 array([&#39;lukewarm&#39;, &#39;cold&#39;, &#39;hot&#39;], dtype=object))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;timestep;values;target</span>
<span class="s2">    rob;1;2;hot</span>
<span class="s2">    alice;1;6;lukewarm</span>
<span class="s2">    eve;1;11;cold</span>
<span class="s2">    </span>
<span class="s2">    rob;2;3;hot</span>
<span class="s2">    alice;2;7;lukewarm</span>
<span class="s2">    eve;2;12;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">to3d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>timestep</th>
      <th>values</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>1</td>
      <td>2</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>1</td>
      <td>6</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eve</td>
      <td>1</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>2</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>eve</td>
      <td>2</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 6 11]]

 [[ 2  7]]

 [[12  3]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target</span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;3;4;hot</span>
<span class="s2">    rob;blue;4;5;hot</span>
<span class="s2">    rob;red;5;6;hot</span>
<span class="s2">    alice;green;6;7;lukewarm</span>
<span class="s2">    alice;yellow;7;8;lukewarm</span>
<span class="s2">    alice;blue;8;9;lukewarm</span>
<span class="s2">    alice;red;9;10;lukewarm</span>
<span class="s2">    eve;yellow;11;12;cold</span>
<span class="s2">    eve;green;10;11;cold</span>
<span class="s2">    eve;blue;12;12;cold</span>
<span class="s2">    eve;red;13;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target1;target2</span>
<span class="s2">    rob;green;2;3;hot;good</span>
<span class="s2">    rob;yellow;3;4;hot;good</span>
<span class="s2">    rob;blue;4;5;hot;good</span>
<span class="s2">    rob;red;5;6;hot;good</span>
<span class="s2">    alice;green;6;7;lukewarm;good</span>
<span class="s2">    alice;yellow;7;8;lukewarm;good</span>
<span class="s2">    alice;blue;8;9;lukewarm;good</span>
<span class="s2">    alice;red;9;10;lukewarm;good</span>
<span class="s2">    eve;yellow;11;12;cold;bad</span>
<span class="s2">    eve;green;10;11;cold;bad</span>
<span class="s2">    eve;blue;12;12;cold;bad</span>
<span class="s2">    eve;red;13;14;cold;bad</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target1&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">],</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target1</th>
      <th>target2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] [[&#39;lukewarm&#39; &#39;good&#39;]
 [&#39;cold&#39; &#39;bad&#39;]
 [&#39;hot&#39; &#39;good&#39;]]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target</span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;3;4;hot</span>
<span class="s2">    rob;blue;4;5;hot</span>
<span class="s2">    rob;red;5;6;hot</span>
<span class="s2">    alice;green;6;7;lukewarm</span>
<span class="s2">    alice;yellow;7;8;lukewarm</span>
<span class="s2">    alice;blue;8;9;lukewarm</span>
<span class="s2">    alice;red;9;10;lukewarm</span>
<span class="s2">    eve;yellow;11;12;cold</span>
<span class="s2">    eve;green;10;11;cold</span>
<span class="s2">    eve;blue;12;12;cold</span>
<span class="s2">    eve;red;13;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;timestep;values;target</span>
<span class="s2">    rob;green;1;2;hot</span>
<span class="s2">    rob;yellow;1;3;hot</span>
<span class="s2">    rob;blue;1;4;hot</span>
<span class="s2">    rob;red;1;5;hot</span>
<span class="s2">    alice;green;1;6;lukewarm</span>
<span class="s2">    alice;yellow;1;7;lukewarm</span>
<span class="s2">    alice;blue;1;8;lukewarm</span>
<span class="s2">    alice;red;1;9;lukewarm</span>
<span class="s2">    eve;yellow;1;11;cold</span>
<span class="s2">    eve;green;1;10;cold</span>
<span class="s2">    eve;blue;1;12;cold</span>
<span class="s2">    eve;red;1;13;cold</span>
<span class="s2">    </span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;2;4;hot</span>
<span class="s2">    rob;blue;2;5;hot</span>
<span class="s2">    rob;red;2;6;hot</span>
<span class="s2">    alice;green;2;7;lukewarm</span>
<span class="s2">    alice;yellow;2;8;lukewarm</span>
<span class="s2">    alice;blue;2;9;lukewarm</span>
<span class="s2">    alice;red;2;10;lukewarm</span>
<span class="s2">    eve;yellow;2;12;cold</span>
<span class="s2">    eve;green;2;11;cold</span>
<span class="s2">    eve;blue;2;13;cold</span>
<span class="s2">    eve;red;2;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>timestep</th>
      <th>values</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>1</td>
      <td>2</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>1</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>1</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>1</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>1</td>
      <td>6</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>1</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>1</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>1</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>1</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>1</td>
      <td>10</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>1</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>1</td>
      <td>13</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>12</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>13</th>
      <td>rob</td>
      <td>yellow</td>
      <td>2</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>14</th>
      <td>rob</td>
      <td>blue</td>
      <td>2</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>15</th>
      <td>rob</td>
      <td>red</td>
      <td>2</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>16</th>
      <td>alice</td>
      <td>green</td>
      <td>2</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>17</th>
      <td>alice</td>
      <td>yellow</td>
      <td>2</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>18</th>
      <td>alice</td>
      <td>blue</td>
      <td>2</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>19</th>
      <td>alice</td>
      <td>red</td>
      <td>2</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>20</th>
      <td>eve</td>
      <td>yellow</td>
      <td>2</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>21</th>
      <td>eve</td>
      <td>green</td>
      <td>2</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>22</th>
      <td>eve</td>
      <td>blue</td>
      <td>2</td>
      <td>13</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>23</th>
      <td>eve</td>
      <td>red</td>
      <td>2</td>
      <td>14</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  6]
  [ 9  7]
  [12 10]
  [13 11]]

 [[ 4  2]
  [ 5  3]
  [ 9  7]
  [10  8]]

 [[13 11]
  [14 12]
  [ 5  3]
  [ 6  4]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindow" class="doc_header"><code>SlidingWindow</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindow</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a 1d or 2d input (np.ndarray, torch.Tensor or pd.DataFrame)</p>
<p>Args:
    window_len      = length of lookback window
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5) [(array([[0, 1, 2, 3, 4]]),),(array([[1, 2, 3, 4, 5]]),),(array([[2, 3, 4, 5, 6]]),),(array([[3, 4, 5, 6, 7]]),),(array([[4, 5, 6, 7, 8]]),)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[3, 4, 5, 6, 7]]), 8)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
[(array([[3, 4, 5, 6, 7]]), 8), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[13, 14, 15, 16, 17]]), 18)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9), (array([[5, 6, 7, 8, 9]]), 10), (array([[ 6,  7,  8,  9, 10]]), 11), (array([[ 7,  8,  9, 10, 11]]), 12), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[ 9, 10, 11, 12, 13]]), 14), (array([[10, 11, 12, 13, 14]]), 15), (array([[11, 12, 13, 14, 15]]), 16), (array([[12, 13, 14, 15, 16]]), 17), (array([[13, 14, 15, 16, 17]]), 18), (array([[14, 15, 16, 17, 18]]), 19)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), array([  5,  50, 500])), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), array([  6,  60, 600])), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), array([  7,  70, 700])), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), array([  8,  80, 800])), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), array([  9,  90, 900]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), 5), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), 6), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), 7), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), 8), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0,  1,  2,  3,  4],
       [ 0, 10, 20, 30, 40]]), 500), (array([[ 1,  2,  3,  4,  5],
       [10, 20, 30, 40, 50]]), 600), (array([[ 2,  3,  4,  5,  6],
       [20, 30, 40, 50, 60]]), 700), (array([[ 3,  4,  5,  6,  7],
       [30, 40, 50, 60, 70]]), 800), (array([[ 4,  5,  6,  7,  8],
       [40, 50, 60, 70, 80]]), 900)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1000, 3)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(200, 2, 5) (200,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 3)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.168604</td>
      <td>-0.292870</td>
      <td>-0.219704</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.127781</td>
      <td>-0.128664</td>
      <td>-0.552743</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.369524</td>
      <td>-0.119114</td>
      <td>-0.661182</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.119771</td>
      <td>-0.289242</td>
      <td>-0.477067</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.315121</td>
      <td>-0.303987</td>
      <td>-0.289793</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-3.196447</td>
      <td>0.257805</td>
      <td>-2.061063</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-3.546856</td>
      <td>-0.163573</td>
      <td>-2.171426</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-3.584363</td>
      <td>-0.333693</td>
      <td>-2.351322</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-3.271379</td>
      <td>0.107681</td>
      <td>-2.824138</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-3.383776</td>
      <td>-0.269589</td>
      <td>-2.500860</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 3 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 2, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.057746</td>
      <td>-0.354464</td>
      <td>0.061742</td>
      <td>-0.118709</td>
      <td>0.245443</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.046304</td>
      <td>-0.289984</td>
      <td>-0.244740</td>
      <td>-0.188395</td>
      <td>0.571270</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.269671</td>
      <td>-0.167975</td>
      <td>-0.024407</td>
      <td>-0.128858</td>
      <td>0.971963</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.754259</td>
      <td>0.312774</td>
      <td>0.412286</td>
      <td>0.057649</td>
      <td>0.537707</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.503030</td>
      <td>0.325545</td>
      <td>0.090706</td>
      <td>0.379620</td>
      <td>0.357708</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-1.161957</td>
      <td>-2.636681</td>
      <td>-0.827354</td>
      <td>4.437652</td>
      <td>3.767772</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-1.100255</td>
      <td>-2.371551</td>
      <td>-0.493757</td>
      <td>4.424497</td>
      <td>3.280065</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-1.266990</td>
      <td>-1.896142</td>
      <td>-0.239235</td>
      <td>4.895432</td>
      <td>3.420379</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-1.185967</td>
      <td>-1.675167</td>
      <td>0.009557</td>
      <td>5.250313</td>
      <td>3.741320</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-1.270622</td>
      <td>-1.828706</td>
      <td>0.164803</td>
      <td>5.495078</td>
      <td>3.809129</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>0.357131</td>
      <td>0.492757</td>
      <td>0.077248</td>
      <td>0.193362</td>
      <td>0.108471</td>
      <td>-0.280517</td>
      <td>-0.763136</td>
      <td>-0.290041</td>
      <td>-0.403134</td>
      <td>-0.061722</td>
      <td>...</td>
      <td>-3.134886</td>
      <td>-2.649196</td>
      <td>-2.457620</td>
      <td>-2.954514</td>
      <td>-2.526086</td>
      <td>-2.144844</td>
      <td>-2.001167</td>
      <td>-2.201601</td>
      <td>-2.398691</td>
      <td>-2.635932</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>0.126680</td>
      <td>0.146486</td>
      <td>0.525572</td>
      <td>0.545216</td>
      <td>0.384825</td>
      <td>0.127631</td>
      <td>0.212632</td>
      <td>-0.108968</td>
      <td>-0.113096</td>
      <td>0.361375</td>
      <td>...</td>
      <td>0.911728</td>
      <td>1.243118</td>
      <td>1.304361</td>
      <td>0.891710</td>
      <td>0.901517</td>
      <td>0.790340</td>
      <td>0.745191</td>
      <td>0.570683</td>
      <td>0.456578</td>
      <td>0.757432</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.175457</td>
      <td>-0.422187</td>
      <td>-0.833298</td>
      <td>-1.211828</td>
      <td>-0.805879</td>
      <td>-1.121671</td>
      <td>-1.057414</td>
      <td>-0.630042</td>
      <td>-0.790550</td>
      <td>-0.564707</td>
      <td>...</td>
      <td>-0.770841</td>
      <td>-0.723181</td>
      <td>-1.174982</td>
      <td>-0.693505</td>
      <td>-0.730083</td>
      <td>-0.420611</td>
      <td>-0.233384</td>
      <td>-0.452970</td>
      <td>-0.014997</td>
      <td>0.407039</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.310122</td>
      <td>0.486644</td>
      <td>0.197630</td>
      <td>0.623839</td>
      <td>0.645002</td>
      <td>0.903100</td>
      <td>0.883720</td>
      <td>0.602154</td>
      <td>0.243068</td>
      <td>-0.012639</td>
      <td>...</td>
      <td>-2.065302</td>
      <td>-2.248877</td>
      <td>-2.550166</td>
      <td>-2.248985</td>
      <td>-2.349621</td>
      <td>-2.422059</td>
      <td>-2.124309</td>
      <td>-2.408846</td>
      <td>-2.608735</td>
      <td>-3.095807</td>
    </tr>
    <tr>
      <th>target</th>
      <td>0.387990</td>
      <td>0.501087</td>
      <td>0.427327</td>
      <td>0.174248</td>
      <td>0.445185</td>
      <td>0.523096</td>
      <td>0.611663</td>
      <td>0.418600</td>
      <td>0.179848</td>
      <td>0.488403</td>
      <td>...</td>
      <td>-0.844968</td>
      <td>-0.625673</td>
      <td>-1.001761</td>
      <td>-0.969121</td>
      <td>-0.471283</td>
      <td>-0.921803</td>
      <td>-0.783457</td>
      <td>-0.867590</td>
      <td>-1.336067</td>
      <td>-1.292791</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>-0.369425</td>
      <td>-0.859884</td>
      <td>-0.695823</td>
      <td>-0.977110</td>
      <td>-1.472718</td>
      <td>-1.827641</td>
      <td>-1.874827</td>
      <td>-2.167275</td>
      <td>-2.646087</td>
      <td>-2.541494</td>
      <td>...</td>
      <td>-2.770353</td>
      <td>-3.007735</td>
      <td>-2.939322</td>
      <td>-3.045583</td>
      <td>-2.685953</td>
      <td>-2.326734</td>
      <td>-2.756966</td>
      <td>-2.831114</td>
      <td>-2.468636</td>
      <td>-2.745919</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.106685</td>
      <td>-0.333770</td>
      <td>-0.368654</td>
      <td>-0.858194</td>
      <td>-0.969232</td>
      <td>-0.832526</td>
      <td>-1.049308</td>
      <td>-0.677339</td>
      <td>-1.053321</td>
      <td>-0.748887</td>
      <td>...</td>
      <td>-1.097914</td>
      <td>-1.387713</td>
      <td>-1.194675</td>
      <td>-1.471622</td>
      <td>-1.008692</td>
      <td>-0.947027</td>
      <td>-0.818683</td>
      <td>-0.760231</td>
      <td>-0.604215</td>
      <td>-0.584232</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.470244</td>
      <td>-0.609173</td>
      <td>-0.657073</td>
      <td>-0.932563</td>
      <td>-0.639290</td>
      <td>-0.323522</td>
      <td>-0.438760</td>
      <td>-0.593512</td>
      <td>-0.568116</td>
      <td>-0.340168</td>
      <td>...</td>
      <td>0.986673</td>
      <td>0.921600</td>
      <td>1.043679</td>
      <td>0.702681</td>
      <td>0.378758</td>
      <td>0.800665</td>
      <td>0.797671</td>
      <td>0.525319</td>
      <td>0.391468</td>
      <td>0.012323</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>-0.080724</td>
      <td>0.263277</td>
      <td>0.323080</td>
      <td>0.659323</td>
      <td>1.147208</td>
      <td>1.376134</td>
      <td>1.332292</td>
      <td>1.220342</td>
      <td>1.067038</td>
      <td>1.536942</td>
      <td>...</td>
      <td>-2.255563</td>
      <td>-2.461494</td>
      <td>-2.904639</td>
      <td>-3.355843</td>
      <td>-3.146533</td>
      <td>-2.695644</td>
      <td>-2.455526</td>
      <td>-2.010123</td>
      <td>-1.974566</td>
      <td>-2.187884</td>
    </tr>
    <tr>
      <th>target</th>
      <td>-0.464664</td>
      <td>-0.685932</td>
      <td>-0.232545</td>
      <td>-0.068022</td>
      <td>0.330551</td>
      <td>0.732091</td>
      <td>0.352976</td>
      <td>-0.066516</td>
      <td>0.052011</td>
      <td>-0.159056</td>
      <td>...</td>
      <td>-1.081015</td>
      <td>-1.370162</td>
      <td>-1.776511</td>
      <td>-1.743151</td>
      <td>-1.803415</td>
      <td>-1.772434</td>
      <td>-2.114774</td>
      <td>-2.415698</td>
      <td>-2.009574</td>
      <td>-2.357681</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(20, 4, 5) (20,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TrainValidTestSplitter</span><span class="p">(</span><span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.082335</td>
      <td>-0.336678</td>
      <td>0.316473</td>
      <td>0.333184</td>
      <td>-0.417955</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.263403</td>
      <td>-0.238452</td>
      <td>0.259514</td>
      <td>0.488270</td>
      <td>-0.645819</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.185497</td>
      <td>0.168950</td>
      <td>-0.142845</td>
      <td>0.729862</td>
      <td>-0.250218</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.627045</td>
      <td>0.341772</td>
      <td>-0.534462</td>
      <td>0.847278</td>
      <td>0.232249</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.777145</td>
      <td>0.181826</td>
      <td>-0.527025</td>
      <td>1.228615</td>
      <td>0.685599</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-0.210707</td>
      <td>-0.876872</td>
      <td>-1.763892</td>
      <td>4.460263</td>
      <td>0.477580</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-0.484621</td>
      <td>-0.842980</td>
      <td>-1.898047</td>
      <td>4.959487</td>
      <td>0.254949</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-0.615424</td>
      <td>-1.163492</td>
      <td>-2.255340</td>
      <td>5.243048</td>
      <td>0.270977</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-0.515153</td>
      <td>-1.124679</td>
      <td>-2.289444</td>
      <td>5.119720</td>
      <td>0.465985</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-0.271150</td>
      <td>-1.298890</td>
      <td>-1.939760</td>
      <td>5.335952</td>
      <td>0.202469</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((96, 4, 5),
 (96,),
 ((#77) [0,1,2,3,4,5,6,7,8,9...], (#19) [77,78,79,80,81,82,83,84,85,86...]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindowPanel" class="doc_header"><code>SlidingWindowPanel</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L194" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindowPanel</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>unique_id_cols</code></strong>:<code>list</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>return_key</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a pd.DataFrame.</p>
<p>Args:
    window_len      = length of lookback window
    unique_id_cols  = pd.DataFrame columns that will be used to identify a time series for each entity.
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y
return_key      = when True, the key corresponsing to unique_id_cols for each sample is returned


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var_0&#39;</span><span class="p">,</span> <span class="s1">&#39;var_1&#39;</span><span class="p">,</span> <span class="s1">&#39;var_2&#39;</span><span class="p">,</span> <span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>var_4</th>
      <th>var_5</th>
      <th>var_6</th>
      <th>var_7</th>
      <th>var_8</th>
      <th>var_9</th>
      <th>time</th>
      <th>device</th>
      <th>target</th>
      <th>region</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1299</td>
      <td>12990</td>
      <td>129900</td>
      <td>1299000</td>
      <td>12990000</td>
      <td>129900000</td>
      <td>1299000000</td>
      <td>12990000000</td>
      <td>129900000000</td>
      <td>1299000000000</td>
      <td>1299</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>1299</td>
    </tr>
    <tr>
      <th>1</th>
      <td>27187</td>
      <td>271870</td>
      <td>2718700</td>
      <td>27187000</td>
      <td>271870000</td>
      <td>2718700000</td>
      <td>27187000000</td>
      <td>271870000000</td>
      <td>2718700000000</td>
      <td>27187000000000</td>
      <td>27187</td>
      <td>0</td>
      <td>0</td>
      <td>A</td>
      <td>27187</td>
    </tr>
    <tr>
      <th>2</th>
      <td>79121</td>
      <td>791192</td>
      <td>7911902</td>
      <td>79119000</td>
      <td>791190000</td>
      <td>7911900000</td>
      <td>79119000000</td>
      <td>791190000000</td>
      <td>7911900000000</td>
      <td>79119000000000</td>
      <td>79119</td>
      <td>2</td>
      <td>2</td>
      <td>B</td>
      <td>179123</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7569</td>
      <td>75672</td>
      <td>756702</td>
      <td>7567000</td>
      <td>75670000</td>
      <td>756700000</td>
      <td>7567000000</td>
      <td>75670000000</td>
      <td>756700000000</td>
      <td>7567000000000</td>
      <td>7567</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>107571</td>
    </tr>
    <tr>
      <th>4</th>
      <td>33691</td>
      <td>336892</td>
      <td>3368902</td>
      <td>33689000</td>
      <td>336890000</td>
      <td>3368900000</td>
      <td>33689000000</td>
      <td>336890000000</td>
      <td>3368900000000</td>
      <td>33689000000000</td>
      <td>33689</td>
      <td>2</td>
      <td>2</td>
      <td>B</td>
      <td>133693</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(200004, 15)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                               <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_max</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">y_func</span><span class="o">=</span><span class="n">y_max</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199982, 10, 5), (199982,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

