---

title: Data preparation


keywords: fastai
sidebar: home_sidebar

summary: "Functions required to prepare X (and y) from a pandas dataframe."
description: "Functions required to prepare X (and y) from a pandas dataframe."
nb_path: "nbs/000c_data.preparation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/000c_data.preparation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2xy" class="doc_header"><code>df2xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2xy</code>(<strong><code>df</code></strong>, <strong><code>sample_col</code></strong>=<em><code>[]</code></em>, <strong><code>feat_col</code></strong>=<em><code>[]</code></em>, <strong><code>step_col</code></strong>=<em><code>[]</code></em>, <strong><code>data_cols</code></strong>=<em><code>[]</code></em>, <strong><code>target_col</code></strong>=<em><code>[]</code></em>, <strong><code>to3d</code></strong>=<em><code>True</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>, <strong><code>sort</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>This function allows you to transform a pandas dataframe into X and y numpy arrays that can be used to craete a TSDataset.
sample_col: column that uniquely identifies each sample.
feat_col: used for multivariate datasets. It indicates which is the column that indicates the feature by row.
step_col: used to indicate the order of the (time)steps when indicated in a column. It's only used to order data.
data_col: indicates where the data is located. If None, it means all columns (except the sample_col, feat_col, step_col and target_col)
target_col: indicates the column/s where the target is.
to3d: turns X to 3d (including univariate time series)
sort: indicates whether the df needs to be sorted or not. If sorted, it will use sample col first, and feat_col second. For more complex sorting
      you'll need to pass a pre-sorted dataframe.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_xy" class="doc_header"><code>split_xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_xy</code>(<strong><code>X</code></strong>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;value_0;value_1;target</span>
<span class="s2">    rob;2;3;hot</span>
<span class="s2">    alice;6;7;lukewarm</span>
<span class="s2">    eve;11;12;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eve</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;timestep;values;target</span>
<span class="s2">    rob;1;2;hot</span>
<span class="s2">    alice;1;6;lukewarm</span>
<span class="s2">    eve;1;11;cold</span>
<span class="s2">    </span>
<span class="s2">    rob;2;3;hot</span>
<span class="s2">    alice;2;7;lukewarm</span>
<span class="s2">    eve;2;12;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">step_col</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>timestep</th>
      <th>values</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>1</td>
      <td>2</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>1</td>
      <td>6</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eve</td>
      <td>1</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>2</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>eve</td>
      <td>2</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target</span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;3;4;hot</span>
<span class="s2">    rob;blue;4;5;hot</span>
<span class="s2">    rob;red;5;6;hot</span>
<span class="s2">    alice;green;6;7;lukewarm</span>
<span class="s2">    alice;yellow;7;8;lukewarm</span>
<span class="s2">    alice;blue;8;9;lukewarm</span>
<span class="s2">    alice;red;9;10;lukewarm</span>
<span class="s2">    eve;yellow;11;12;cold</span>
<span class="s2">    eve;green;10;11;cold</span>
<span class="s2">    eve;blue;12;12;cold</span>
<span class="s2">    eve;red;13;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target1;target2</span>
<span class="s2">    rob;green;2;3;hot;good</span>
<span class="s2">    rob;yellow;3;4;hot;good</span>
<span class="s2">    rob;blue;4;5;hot;good</span>
<span class="s2">    rob;red;5;6;hot;good</span>
<span class="s2">    alice;green;6;7;lukewarm;good</span>
<span class="s2">    alice;yellow;7;8;lukewarm;good</span>
<span class="s2">    alice;blue;8;9;lukewarm;good</span>
<span class="s2">    alice;red;9;10;lukewarm;good</span>
<span class="s2">    eve;yellow;11;12;cold;bad</span>
<span class="s2">    eve;green;10;11;cold;bad</span>
<span class="s2">    eve;blue;12;12;cold;bad</span>
<span class="s2">    eve;red;13;14;cold;bad</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target1&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">],</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target1</th>
      <th>target2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target</span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;3;4;hot</span>
<span class="s2">    rob;blue;4;5;hot</span>
<span class="s2">    rob;red;5;6;hot</span>
<span class="s2">    alice;green;6;7;lukewarm</span>
<span class="s2">    alice;yellow;7;8;lukewarm</span>
<span class="s2">    alice;blue;8;9;lukewarm</span>
<span class="s2">    alice;red;9;10;lukewarm</span>
<span class="s2">    eve;yellow;11;12;cold</span>
<span class="s2">    eve;green;10;11;cold</span>
<span class="s2">    eve;blue;12;12;cold</span>
<span class="s2">    eve;red;13;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;timestep;values;target</span>
<span class="s2">    rob;green;1;2;hot</span>
<span class="s2">    rob;yellow;1;3;hot</span>
<span class="s2">    rob;blue;1;4;hot</span>
<span class="s2">    rob;red;1;5;hot</span>
<span class="s2">    alice;green;1;6;lukewarm</span>
<span class="s2">    alice;yellow;1;7;lukewarm</span>
<span class="s2">    alice;blue;1;8;lukewarm</span>
<span class="s2">    alice;red;1;9;lukewarm</span>
<span class="s2">    eve;yellow;1;11;cold</span>
<span class="s2">    eve;green;1;10;cold</span>
<span class="s2">    eve;blue;1;12;cold</span>
<span class="s2">    eve;red;1;13;cold</span>
<span class="s2">    </span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;2;4;hot</span>
<span class="s2">    rob;blue;2;5;hot</span>
<span class="s2">    rob;red;2;6;hot</span>
<span class="s2">    alice;green;2;7;lukewarm</span>
<span class="s2">    alice;yellow;2;8;lukewarm</span>
<span class="s2">    alice;blue;2;9;lukewarm</span>
<span class="s2">    alice;red;2;10;lukewarm</span>
<span class="s2">    eve;yellow;2;12;cold</span>
<span class="s2">    eve;green;2;11;cold</span>
<span class="s2">    eve;blue;2;13;cold</span>
<span class="s2">    eve;red;2;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">step_col</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>timestep</th>
      <th>values</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>1</td>
      <td>2</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>1</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>1</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>1</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>1</td>
      <td>6</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>1</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>1</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>1</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>1</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>1</td>
      <td>10</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>1</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>1</td>
      <td>13</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>12</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>13</th>
      <td>rob</td>
      <td>yellow</td>
      <td>2</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>14</th>
      <td>rob</td>
      <td>blue</td>
      <td>2</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>15</th>
      <td>rob</td>
      <td>red</td>
      <td>2</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>16</th>
      <td>alice</td>
      <td>green</td>
      <td>2</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>17</th>
      <td>alice</td>
      <td>yellow</td>
      <td>2</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>18</th>
      <td>alice</td>
      <td>blue</td>
      <td>2</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>19</th>
      <td>alice</td>
      <td>red</td>
      <td>2</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>20</th>
      <td>eve</td>
      <td>yellow</td>
      <td>2</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>21</th>
      <td>eve</td>
      <td>green</td>
      <td>2</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>22</th>
      <td>eve</td>
      <td>blue</td>
      <td>2</td>
      <td>13</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>23</th>
      <td>eve</td>
      <td>red</td>
      <td>2</td>
      <td>14</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindow" class="doc_header"><code>SlidingWindow</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindow</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a 1d or 2d input (np.ndarray, torch.Tensor or pd.DataFrame)</p>
<p>Args:
    window_len      = length of lookback window
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5) [(array([[0, 1, 2, 3, 4]]),),(array([[1, 2, 3, 4, 5]]),),(array([[2, 3, 4, 5, 6]]),),(array([[3, 4, 5, 6, 7]]),),(array([[4, 5, 6, 7, 8]]),)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[3, 4, 5, 6, 7]]), 8)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
[(array([[3, 4, 5, 6, 7]]), 8), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[13, 14, 15, 16, 17]]), 18)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9), (array([[5, 6, 7, 8, 9]]), 10), (array([[ 6,  7,  8,  9, 10]]), 11), (array([[ 7,  8,  9, 10, 11]]), 12), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[ 9, 10, 11, 12, 13]]), 14), (array([[10, 11, 12, 13, 14]]), 15), (array([[11, 12, 13, 14, 15]]), 16), (array([[12, 13, 14, 15, 16]]), 17), (array([[13, 14, 15, 16, 17]]), 18), (array([[14, 15, 16, 17, 18]]), 19)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), array([  5,  50, 500])), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), array([  6,  60, 600])), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), array([  7,  70, 700])), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), array([  8,  80, 800])), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), array([  9,  90, 900]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), 5), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), 6), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), 7), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), 8), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0,  1,  2,  3,  4],
       [ 0, 10, 20, 30, 40]]), 500), (array([[ 1,  2,  3,  4,  5],
       [10, 20, 30, 40, 50]]), 600), (array([[ 2,  3,  4,  5,  6],
       [20, 30, 40, 50, 60]]), 700), (array([[ 3,  4,  5,  6,  7],
       [30, 40, 50, 60, 70]]), 800), (array([[ 4,  5,  6,  7,  8],
       [40, 50, 60, 70, 80]]), 900)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1000, 3)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(200, 2, 5) (200,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 3)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.064029</td>
      <td>-0.187251</td>
      <td>0.303678</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.103333</td>
      <td>0.049159</td>
      <td>0.108442</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.249687</td>
      <td>0.340957</td>
      <td>-0.306920</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.015855</td>
      <td>0.431674</td>
      <td>0.178829</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.053624</td>
      <td>-0.022890</td>
      <td>0.003834</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-0.501659</td>
      <td>-3.899030</td>
      <td>4.202362</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-0.382458</td>
      <td>-3.430652</td>
      <td>4.138802</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-0.594034</td>
      <td>-3.259342</td>
      <td>3.869929</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-0.592312</td>
      <td>-3.736122</td>
      <td>3.754584</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-1.051117</td>
      <td>-3.636491</td>
      <td>3.287707</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 3 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 2, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.225443</td>
      <td>0.495079</td>
      <td>0.266888</td>
      <td>0.237845</td>
      <td>-0.135376</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.235111</td>
      <td>0.715260</td>
      <td>0.404169</td>
      <td>0.247040</td>
      <td>-0.231563</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.121572</td>
      <td>0.848589</td>
      <td>0.011476</td>
      <td>0.409661</td>
      <td>-0.125579</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.052092</td>
      <td>0.946320</td>
      <td>-0.175079</td>
      <td>0.331730</td>
      <td>-0.081897</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.377631</td>
      <td>1.133316</td>
      <td>-0.170696</td>
      <td>0.504423</td>
      <td>-0.302148</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>4.430912</td>
      <td>-1.651682</td>
      <td>4.294701</td>
      <td>-1.119894</td>
      <td>0.535001</td>
    </tr>
    <tr>
      <th>96</th>
      <td>3.978308</td>
      <td>-1.506054</td>
      <td>4.059265</td>
      <td>-1.242032</td>
      <td>0.986208</td>
    </tr>
    <tr>
      <th>97</th>
      <td>3.659264</td>
      <td>-1.911232</td>
      <td>3.916644</td>
      <td>-0.933860</td>
      <td>1.263304</td>
    </tr>
    <tr>
      <th>98</th>
      <td>3.695991</td>
      <td>-1.521448</td>
      <td>3.888495</td>
      <td>-0.647393</td>
      <td>1.537150</td>
    </tr>
    <tr>
      <th>99</th>
      <td>3.410106</td>
      <td>-1.978976</td>
      <td>4.041448</td>
      <td>-0.996885</td>
      <td>1.164767</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>0.167169</td>
      <td>-0.122440</td>
      <td>-0.020672</td>
      <td>-0.370989</td>
      <td>-0.620207</td>
      <td>-0.632628</td>
      <td>-0.215316</td>
      <td>-0.518089</td>
      <td>-0.257057</td>
      <td>-0.273039</td>
      <td>...</td>
      <td>1.079513</td>
      <td>1.147076</td>
      <td>1.276095</td>
      <td>1.577499</td>
      <td>1.376832</td>
      <td>1.514807</td>
      <td>1.503482</td>
      <td>1.484534</td>
      <td>1.915935</td>
      <td>2.391730</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>0.175078</td>
      <td>0.043210</td>
      <td>0.207709</td>
      <td>0.347164</td>
      <td>0.787345</td>
      <td>0.304263</td>
      <td>0.435274</td>
      <td>0.261070</td>
      <td>0.573473</td>
      <td>0.447817</td>
      <td>...</td>
      <td>-0.300461</td>
      <td>-0.617851</td>
      <td>-1.060647</td>
      <td>-0.738743</td>
      <td>-1.064719</td>
      <td>-1.311932</td>
      <td>-1.715648</td>
      <td>-1.976918</td>
      <td>-1.901620</td>
      <td>-1.624876</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>0.391622</td>
      <td>0.155040</td>
      <td>0.575412</td>
      <td>0.223710</td>
      <td>0.066955</td>
      <td>-0.260790</td>
      <td>-0.495199</td>
      <td>-0.004071</td>
      <td>-0.384896</td>
      <td>-0.051205</td>
      <td>...</td>
      <td>-1.050112</td>
      <td>-0.853730</td>
      <td>-1.075730</td>
      <td>-0.627827</td>
      <td>-0.435007</td>
      <td>-0.693213</td>
      <td>-0.264761</td>
      <td>-0.448998</td>
      <td>-0.259671</td>
      <td>-0.568783</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.310898</td>
      <td>0.568155</td>
      <td>0.406690</td>
      <td>0.461446</td>
      <td>0.637029</td>
      <td>0.387925</td>
      <td>-0.096049</td>
      <td>-0.240817</td>
      <td>-0.373891</td>
      <td>-0.082941</td>
      <td>...</td>
      <td>1.247941</td>
      <td>1.597064</td>
      <td>1.721077</td>
      <td>1.613965</td>
      <td>1.366677</td>
      <td>1.075763</td>
      <td>1.290754</td>
      <td>1.256037</td>
      <td>1.310644</td>
      <td>1.766944</td>
    </tr>
    <tr>
      <th>target</th>
      <td>0.054497</td>
      <td>0.490115</td>
      <td>0.436116</td>
      <td>0.728922</td>
      <td>0.319069</td>
      <td>0.528908</td>
      <td>0.614870</td>
      <td>1.045902</td>
      <td>0.654789</td>
      <td>0.952380</td>
      <td>...</td>
      <td>2.983811</td>
      <td>3.461328</td>
      <td>3.849457</td>
      <td>4.077245</td>
      <td>4.288832</td>
      <td>4.438861</td>
      <td>4.041723</td>
      <td>4.168998</td>
      <td>3.700079</td>
      <td>3.830120</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>-0.046010</td>
      <td>-0.062262</td>
      <td>-0.107600</td>
      <td>0.307901</td>
      <td>0.296288</td>
      <td>0.478333</td>
      <td>0.865263</td>
      <td>0.372890</td>
      <td>0.165179</td>
      <td>0.517620</td>
      <td>...</td>
      <td>-3.484731</td>
      <td>-3.038657</td>
      <td>-3.217017</td>
      <td>-3.116842</td>
      <td>-3.084037</td>
      <td>-2.833809</td>
      <td>-3.195348</td>
      <td>-3.538249</td>
      <td>-3.684178</td>
      <td>-3.414439</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.035898</td>
      <td>0.262409</td>
      <td>0.010344</td>
      <td>-0.248266</td>
      <td>-0.717571</td>
      <td>-0.873287</td>
      <td>-1.047832</td>
      <td>-1.113964</td>
      <td>-0.933831</td>
      <td>-1.014337</td>
      <td>...</td>
      <td>-3.550881</td>
      <td>-3.249723</td>
      <td>-2.893326</td>
      <td>-2.818922</td>
      <td>-2.604356</td>
      <td>-2.639393</td>
      <td>-2.209845</td>
      <td>-2.519616</td>
      <td>-2.115066</td>
      <td>-1.905204</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>0.254736</td>
      <td>0.071666</td>
      <td>0.100163</td>
      <td>0.224841</td>
      <td>0.474766</td>
      <td>0.415278</td>
      <td>0.165137</td>
      <td>0.220558</td>
      <td>0.089717</td>
      <td>0.436308</td>
      <td>...</td>
      <td>-1.339996</td>
      <td>-0.907272</td>
      <td>-0.714625</td>
      <td>-0.380746</td>
      <td>0.060768</td>
      <td>-0.154989</td>
      <td>0.208046</td>
      <td>-0.105995</td>
      <td>0.335746</td>
      <td>-0.146861</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.074094</td>
      <td>-0.371418</td>
      <td>0.122476</td>
      <td>0.308150</td>
      <td>0.378970</td>
      <td>0.857746</td>
      <td>0.458172</td>
      <td>0.573585</td>
      <td>0.563356</td>
      <td>0.266324</td>
      <td>...</td>
      <td>-1.024972</td>
      <td>-1.352298</td>
      <td>-1.622417</td>
      <td>-2.059975</td>
      <td>-2.233862</td>
      <td>-2.063522</td>
      <td>-1.728895</td>
      <td>-2.213718</td>
      <td>-2.496252</td>
      <td>-2.485221</td>
    </tr>
    <tr>
      <th>target</th>
      <td>-0.047225</td>
      <td>-0.433698</td>
      <td>-0.280648</td>
      <td>0.067745</td>
      <td>-0.197009</td>
      <td>-0.659489</td>
      <td>-0.771335</td>
      <td>-1.109240</td>
      <td>-0.637453</td>
      <td>-1.101549</td>
      <td>...</td>
      <td>-1.801978</td>
      <td>-1.787870</td>
      <td>-2.228421</td>
      <td>-2.651321</td>
      <td>-3.137533</td>
      <td>-3.557810</td>
      <td>-3.453665</td>
      <td>-3.105976</td>
      <td>-3.581055</td>
      <td>-3.714588</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(20, 4, 5) (20,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TrainValidTestSplitter</span><span class="p">(</span><span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.474264</td>
      <td>0.149802</td>
      <td>-0.224433</td>
      <td>0.327208</td>
      <td>-0.050385</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.577398</td>
      <td>0.541168</td>
      <td>0.114492</td>
      <td>0.390015</td>
      <td>0.424128</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.980854</td>
      <td>0.558159</td>
      <td>-0.236266</td>
      <td>0.011408</td>
      <td>0.426545</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.549804</td>
      <td>0.189537</td>
      <td>0.081759</td>
      <td>-0.242543</td>
      <td>0.331732</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.207806</td>
      <td>-0.272613</td>
      <td>-0.341573</td>
      <td>-0.725975</td>
      <td>0.589744</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-1.854666</td>
      <td>1.942374</td>
      <td>-2.553894</td>
      <td>-3.893777</td>
      <td>-3.359449</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-1.915801</td>
      <td>2.410578</td>
      <td>-2.873610</td>
      <td>-4.319009</td>
      <td>-3.556577</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-1.486889</td>
      <td>2.224744</td>
      <td>-2.833786</td>
      <td>-4.767698</td>
      <td>-3.407741</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-1.856582</td>
      <td>2.272610</td>
      <td>-2.873159</td>
      <td>-4.838606</td>
      <td>-3.491254</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-2.023916</td>
      <td>2.723856</td>
      <td>-2.662514</td>
      <td>-4.526008</td>
      <td>-3.683505</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((96, 4, 5),
 (96,),
 ((#77) [0,1,2,3,4,5,6,7,8,9...], (#19) [77,78,79,80,81,82,83,84,85,86...]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindowPanel" class="doc_header"><code>SlidingWindowPanel</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L154" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindowPanel</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>unique_id_cols</code></strong>:<code>list</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>return_key</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a pd.DataFrame.</p>
<p>Args:
    window_len      = length of lookback window
    unique_id_cols  = pd.DataFrame columns that will be used to identify a time series for each entity.
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y
return_key      = when True, the key corresponsing to unique_id_cols for each sample is returned


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var_0&#39;</span><span class="p">,</span> <span class="s1">&#39;var_1&#39;</span><span class="p">,</span> <span class="s1">&#39;var_2&#39;</span><span class="p">,</span> <span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>var_4</th>
      <th>var_5</th>
      <th>var_6</th>
      <th>var_7</th>
      <th>var_8</th>
      <th>var_9</th>
      <th>time</th>
      <th>device</th>
      <th>target</th>
      <th>region</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>42553</td>
      <td>425512</td>
      <td>4255102</td>
      <td>42551000</td>
      <td>425510000</td>
      <td>4255100000</td>
      <td>42551000000</td>
      <td>425510000000</td>
      <td>4255100000000</td>
      <td>42551000000000</td>
      <td>42551</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>142555</td>
    </tr>
    <tr>
      <th>1</th>
      <td>25629</td>
      <td>256290</td>
      <td>2562900</td>
      <td>25629000</td>
      <td>256290000</td>
      <td>2562900000</td>
      <td>25629000000</td>
      <td>256290000000</td>
      <td>2562900000000</td>
      <td>25629000000000</td>
      <td>25629</td>
      <td>0</td>
      <td>0</td>
      <td>A</td>
      <td>25629</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26655</td>
      <td>266550</td>
      <td>2665500</td>
      <td>26655000</td>
      <td>266550000</td>
      <td>2665500000</td>
      <td>26655000000</td>
      <td>266550000000</td>
      <td>2665500000000</td>
      <td>26655000000000</td>
      <td>26655</td>
      <td>0</td>
      <td>0</td>
      <td>A</td>
      <td>26655</td>
    </tr>
    <tr>
      <th>3</th>
      <td>49164</td>
      <td>491640</td>
      <td>4916400</td>
      <td>49164000</td>
      <td>491640000</td>
      <td>4916400000</td>
      <td>49164000000</td>
      <td>491640000000</td>
      <td>4916400000000</td>
      <td>49164000000000</td>
      <td>49164</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>49164</td>
    </tr>
    <tr>
      <th>4</th>
      <td>39196</td>
      <td>391960</td>
      <td>3919600</td>
      <td>39196000</td>
      <td>391960000</td>
      <td>3919600000</td>
      <td>39196000000</td>
      <td>391960000000</td>
      <td>3919600000000</td>
      <td>39196000000000</td>
      <td>39196</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>39196</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(200004, 15)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                               <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_max</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">y_func</span><span class="o">=</span><span class="n">y_max</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199982, 10, 5), (199982,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

