---

title: Data preparation


keywords: fastai
sidebar: home_sidebar

summary: "Functions required to prepare X (and y) from a pandas dataframe."
description: "Functions required to prepare X (and y) from a pandas dataframe."
nb_path: "nbs/000c_data.preparation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/000c_data.preparation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2Xy" class="doc_header"><code>df2Xy</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2Xy</code>(<strong><code>df</code></strong>, <strong><code>sample_col</code></strong>=<em><code>None</code></em>, <strong><code>feat_col</code></strong>=<em><code>None</code></em>, <strong><code>data_cols</code></strong>=<em><code>None</code></em>, <strong><code>target_col</code></strong>=<em><code>None</code></em>, <strong><code>to3d</code></strong>=<em><code>True</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>, <strong><code>sort_by</code></strong>=<em><code>None</code></em>, <strong><code>ascending</code></strong>=<em><code>True</code></em>, <strong><code>y_func</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>This function allows you to transform a pandas dataframe into X and y numpy arrays that can be used to craete a TSDataset.
sample_col: column that uniquely identifies each sample.
feat_col: used for multivariate datasets. It indicates which is the column that indicates the feature by row.
data_col: indicates ths column/s where the data is located. If None, it means all columns (except the sample_col, feat_col, and target_col)
target_col: indicates the column/s where the target is.
to3d: turns X to 3d (including univariate time series)
sort_by: used to indicate how to sort the dataframe.
y_func: function used to calculate y for each sample (and target_col)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_Xy" class="doc_header"><code>split_Xy</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_Xy</code>(<strong><code>X</code></strong>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1_000</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="mi">10_000</span>

<span class="n">sample_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n_rows</span><span class="o">//</span><span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">feat_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_rows</span> <span class="o">//</span> <span class="n">n_samples</span><span class="p">),</span> <span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ind_cat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])[</span><span class="n">ind_cat</span><span class="p">]</span>
<span class="n">ind_cat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">target2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])[</span><span class="n">ind_cat2</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">sample_ids</span><span class="p">,</span> <span class="n">feat_ids</span><span class="p">,</span> <span class="n">cont</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target2&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">new_dtypes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sample_id&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">new_dtypes</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>feat_id</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>target</th>
      <th>target2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>844</td>
      <td>7</td>
      <td>0.105961</td>
      <td>0.656512</td>
      <td>-0.732958</td>
      <td>-0.378170</td>
      <td>-2.194837</td>
      <td>0.417476</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>228</td>
      <td>9</td>
      <td>0.383861</td>
      <td>-1.361381</td>
      <td>0.241933</td>
      <td>1.779829</td>
      <td>0.798907</td>
      <td>-0.579518</td>
      <td>c</td>
      <td>c</td>
    </tr>
    <tr>
      <th>2</th>
      <td>803</td>
      <td>1</td>
      <td>0.934218</td>
      <td>-1.195467</td>
      <td>-1.806817</td>
      <td>-0.273698</td>
      <td>-0.680246</td>
      <td>0.116293</td>
      <td>c</td>
      <td>c</td>
    </tr>
    <tr>
      <th>3</th>
      <td>353</td>
      <td>6</td>
      <td>-0.525785</td>
      <td>-1.394574</td>
      <td>0.730440</td>
      <td>-0.343563</td>
      <td>-0.970926</td>
      <td>-0.411756</td>
      <td>c</td>
      <td>c</td>
    </tr>
    <tr>
      <th>4</th>
      <td>233</td>
      <td>2</td>
      <td>-1.483770</td>
      <td>-0.552077</td>
      <td>-0.906894</td>
      <td>-0.393994</td>
      <td>0.388829</td>
      <td>0.574629</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>682</td>
      <td>6</td>
      <td>0.967295</td>
      <td>-0.627394</td>
      <td>0.635325</td>
      <td>-0.455409</td>
      <td>0.942425</td>
      <td>2.296223</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>503</td>
      <td>6</td>
      <td>0.983209</td>
      <td>1.732644</td>
      <td>-1.165706</td>
      <td>0.517855</td>
      <td>-0.480920</td>
      <td>0.365074</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>490</td>
      <td>5</td>
      <td>0.042418</td>
      <td>-0.322782</td>
      <td>-1.131399</td>
      <td>0.285757</td>
      <td>0.675743</td>
      <td>0.616170</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>556</td>
      <td>0</td>
      <td>0.107184</td>
      <td>2.518891</td>
      <td>0.075367</td>
      <td>0.052334</td>
      <td>1.589005</td>
      <td>-0.987767</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>594</td>
      <td>4</td>
      <td>0.085060</td>
      <td>0.279900</td>
      <td>1.259890</td>
      <td>-0.356446</td>
      <td>-0.840084</td>
      <td>-1.140239</td>
      <td>c</td>
      <td>c</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 10 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;feat_id&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">],</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">rand_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sample_id</span><span class="p">))</span>
<span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">],</span> <span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;target&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span><span class="p">),</span> <span class="n">y</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;feat_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">rand_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sample_id</span><span class="p">))</span>
<span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">],</span> <span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span><span class="p">),</span> <span class="n">y</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;value_0;value_1;target</span>
<span class="s2">    rob;2;3;hot</span>
<span class="s2">    alice;6;7;lukewarm</span>
<span class="s2">    eve;11;12;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2Xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eve</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[[ 6,  7]],
 
        [[11, 12]],
 
        [[ 2,  3]]]),
 array([&#39;lukewarm&#39;, &#39;cold&#39;, &#39;hot&#39;], dtype=object))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;timestep;values;target</span>
<span class="s2">    rob;1;2;hot</span>
<span class="s2">    alice;1;6;lukewarm</span>
<span class="s2">    eve;1;11;cold</span>
<span class="s2">    </span>
<span class="s2">    rob;2;3;hot</span>
<span class="s2">    alice;2;7;lukewarm</span>
<span class="s2">    eve;2;12;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">to3d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>timestep</th>
      <th>values</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>1</td>
      <td>2</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>1</td>
      <td>6</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eve</td>
      <td>1</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>2</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>eve</td>
      <td>2</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 6 11]]

 [[ 2  7]]

 [[12  3]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target</span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;3;4;hot</span>
<span class="s2">    rob;blue;4;5;hot</span>
<span class="s2">    rob;red;5;6;hot</span>
<span class="s2">    alice;green;6;7;lukewarm</span>
<span class="s2">    alice;yellow;7;8;lukewarm</span>
<span class="s2">    alice;blue;8;9;lukewarm</span>
<span class="s2">    alice;red;9;10;lukewarm</span>
<span class="s2">    eve;yellow;11;12;cold</span>
<span class="s2">    eve;green;10;11;cold</span>
<span class="s2">    eve;blue;12;12;cold</span>
<span class="s2">    eve;red;13;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target1;target2</span>
<span class="s2">    rob;green;2;3;hot;good</span>
<span class="s2">    rob;yellow;3;4;hot;good</span>
<span class="s2">    rob;blue;4;5;hot;good</span>
<span class="s2">    rob;red;5;6;hot;good</span>
<span class="s2">    alice;green;6;7;lukewarm;good</span>
<span class="s2">    alice;yellow;7;8;lukewarm;good</span>
<span class="s2">    alice;blue;8;9;lukewarm;good</span>
<span class="s2">    alice;red;9;10;lukewarm;good</span>
<span class="s2">    eve;yellow;11;12;cold;bad</span>
<span class="s2">    eve;green;10;11;cold;bad</span>
<span class="s2">    eve;blue;12;12;cold;bad</span>
<span class="s2">    eve;red;13;14;cold;bad</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target1&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">],</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target1</th>
      <th>target2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] [[&#39;lukewarm&#39; &#39;good&#39;]
 [&#39;cold&#39; &#39;bad&#39;]
 [&#39;hot&#39; &#39;good&#39;]]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target</span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;3;4;hot</span>
<span class="s2">    rob;blue;4;5;hot</span>
<span class="s2">    rob;red;5;6;hot</span>
<span class="s2">    alice;green;6;7;lukewarm</span>
<span class="s2">    alice;yellow;7;8;lukewarm</span>
<span class="s2">    alice;blue;8;9;lukewarm</span>
<span class="s2">    alice;red;9;10;lukewarm</span>
<span class="s2">    eve;yellow;11;12;cold</span>
<span class="s2">    eve;green;10;11;cold</span>
<span class="s2">    eve;blue;12;12;cold</span>
<span class="s2">    eve;red;13;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;timestep;values;target</span>
<span class="s2">    rob;green;1;2;hot</span>
<span class="s2">    rob;yellow;1;3;hot</span>
<span class="s2">    rob;blue;1;4;hot</span>
<span class="s2">    rob;red;1;5;hot</span>
<span class="s2">    alice;green;1;6;lukewarm</span>
<span class="s2">    alice;yellow;1;7;lukewarm</span>
<span class="s2">    alice;blue;1;8;lukewarm</span>
<span class="s2">    alice;red;1;9;lukewarm</span>
<span class="s2">    eve;yellow;1;11;cold</span>
<span class="s2">    eve;green;1;10;cold</span>
<span class="s2">    eve;blue;1;12;cold</span>
<span class="s2">    eve;red;1;13;cold</span>
<span class="s2">    </span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;2;4;hot</span>
<span class="s2">    rob;blue;2;5;hot</span>
<span class="s2">    rob;red;2;6;hot</span>
<span class="s2">    alice;green;2;7;lukewarm</span>
<span class="s2">    alice;yellow;2;8;lukewarm</span>
<span class="s2">    alice;blue;2;9;lukewarm</span>
<span class="s2">    alice;red;2;10;lukewarm</span>
<span class="s2">    eve;yellow;2;12;cold</span>
<span class="s2">    eve;green;2;11;cold</span>
<span class="s2">    eve;blue;2;13;cold</span>
<span class="s2">    eve;red;2;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>timestep</th>
      <th>values</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>1</td>
      <td>2</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>1</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>1</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>1</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>1</td>
      <td>6</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>1</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>1</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>1</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>1</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>1</td>
      <td>10</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>1</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>1</td>
      <td>13</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>12</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>13</th>
      <td>rob</td>
      <td>yellow</td>
      <td>2</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>14</th>
      <td>rob</td>
      <td>blue</td>
      <td>2</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>15</th>
      <td>rob</td>
      <td>red</td>
      <td>2</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>16</th>
      <td>alice</td>
      <td>green</td>
      <td>2</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>17</th>
      <td>alice</td>
      <td>yellow</td>
      <td>2</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>18</th>
      <td>alice</td>
      <td>blue</td>
      <td>2</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>19</th>
      <td>alice</td>
      <td>red</td>
      <td>2</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>20</th>
      <td>eve</td>
      <td>yellow</td>
      <td>2</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>21</th>
      <td>eve</td>
      <td>green</td>
      <td>2</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>22</th>
      <td>eve</td>
      <td>blue</td>
      <td>2</td>
      <td>13</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>23</th>
      <td>eve</td>
      <td>red</td>
      <td>2</td>
      <td>14</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  6]
  [ 9  7]
  [12 10]
  [13 11]]

 [[ 4  2]
  [ 5  3]
  [ 9  7]
  [10  8]]

 [[13 11]
  [14 12]
  [ 5  3]
  [ 6  4]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2np3d" class="doc_header"><code>df2np3d</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L109" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2np3d</code>(<strong><code>df</code></strong>, <strong><code>groupby</code></strong>, <strong><code>data_cols</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Transforms a df with the same mber of rows per group in groupby to a 2d ndarray</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">user</span><span class="p">,</span> <span class="n">val</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">df2np3d</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindow" class="doc_header"><code>SlidingWindow</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L119" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindow</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a 1d or 2d input (np.ndarray, torch.Tensor or pd.DataFrame)</p>
<p>Args:
    window_len      = length of lookback window
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5) [(array([[0, 1, 2, 3, 4]]),),(array([[1, 2, 3, 4, 5]]),),(array([[2, 3, 4, 5, 6]]),),(array([[3, 4, 5, 6, 7]]),),(array([[4, 5, 6, 7, 8]]),)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[3, 4, 5, 6, 7]]), 8)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
[(array([[3, 4, 5, 6, 7]]), 8), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[13, 14, 15, 16, 17]]), 18)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9), (array([[5, 6, 7, 8, 9]]), 10), (array([[ 6,  7,  8,  9, 10]]), 11), (array([[ 7,  8,  9, 10, 11]]), 12), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[ 9, 10, 11, 12, 13]]), 14), (array([[10, 11, 12, 13, 14]]), 15), (array([[11, 12, 13, 14, 15]]), 16), (array([[12, 13, 14, 15, 16]]), 17), (array([[13, 14, 15, 16, 17]]), 18), (array([[14, 15, 16, 17, 18]]), 19)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), array([  5,  50, 500])), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), array([  6,  60, 600])), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), array([  7,  70, 700])), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), array([  8,  80, 800])), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), array([  9,  90, 900]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), 5), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), 6), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), 7), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), 8), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0,  1,  2,  3,  4],
       [ 0, 10, 20, 30, 40]]), 500), (array([[ 1,  2,  3,  4,  5],
       [10, 20, 30, 40, 50]]), 600), (array([[ 2,  3,  4,  5,  6],
       [20, 30, 40, 50, 60]]), 700), (array([[ 3,  4,  5,  6,  7],
       [30, 40, 50, 60, 70]]), 800), (array([[ 4,  5,  6,  7,  8],
       [40, 50, 60, 70, 80]]), 900)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1000, 3)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(200, 2, 5) (200,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 3)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.243680</td>
      <td>-0.070451</td>
      <td>0.299154</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.693495</td>
      <td>-0.175321</td>
      <td>0.482805</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.468065</td>
      <td>0.211203</td>
      <td>0.358853</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.078628</td>
      <td>0.344656</td>
      <td>0.637103</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.207001</td>
      <td>0.442138</td>
      <td>0.379058</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1.060816</td>
      <td>2.021925</td>
      <td>-1.756835</td>
    </tr>
    <tr>
      <th>96</th>
      <td>0.941093</td>
      <td>1.994243</td>
      <td>-1.930763</td>
    </tr>
    <tr>
      <th>97</th>
      <td>1.123880</td>
      <td>2.200781</td>
      <td>-2.190658</td>
    </tr>
    <tr>
      <th>98</th>
      <td>1.376583</td>
      <td>1.972694</td>
      <td>-2.261083</td>
    </tr>
    <tr>
      <th>99</th>
      <td>1.872192</td>
      <td>2.041679</td>
      <td>-2.268451</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 3 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 2, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.413849</td>
      <td>-0.257378</td>
      <td>0.188469</td>
      <td>-0.150112</td>
      <td>0.153474</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.143432</td>
      <td>-0.578458</td>
      <td>-0.104268</td>
      <td>-0.344688</td>
      <td>-0.013338</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.351735</td>
      <td>-0.955305</td>
      <td>0.225372</td>
      <td>-0.383458</td>
      <td>-0.370451</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.364166</td>
      <td>-0.748285</td>
      <td>-0.158886</td>
      <td>-0.482434</td>
      <td>-0.817680</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.660753</td>
      <td>-0.868011</td>
      <td>-0.351681</td>
      <td>-0.496087</td>
      <td>-0.988746</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-0.216686</td>
      <td>-0.132821</td>
      <td>2.156290</td>
      <td>-2.515176</td>
      <td>-2.355705</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-0.501657</td>
      <td>-0.329206</td>
      <td>2.455175</td>
      <td>-2.754853</td>
      <td>-2.172578</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-0.825223</td>
      <td>0.072063</td>
      <td>2.823051</td>
      <td>-2.462910</td>
      <td>-1.748423</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-1.012461</td>
      <td>0.130128</td>
      <td>3.004180</td>
      <td>-2.085222</td>
      <td>-2.014497</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-1.060623</td>
      <td>-0.272539</td>
      <td>3.150301</td>
      <td>-2.196013</td>
      <td>-1.902421</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>-0.481388</td>
      <td>-0.929909</td>
      <td>-1.317046</td>
      <td>-1.260371</td>
      <td>-1.240825</td>
      <td>-1.590979</td>
      <td>-1.273275</td>
      <td>-1.241482</td>
      <td>-1.272761</td>
      <td>-1.256387</td>
      <td>...</td>
      <td>-0.323540</td>
      <td>0.004876</td>
      <td>0.277987</td>
      <td>-0.016908</td>
      <td>0.224403</td>
      <td>0.128959</td>
      <td>0.203896</td>
      <td>0.209690</td>
      <td>0.376378</td>
      <td>0.371243</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>0.397096</td>
      <td>0.291363</td>
      <td>0.537106</td>
      <td>0.985536</td>
      <td>0.664691</td>
      <td>0.394068</td>
      <td>0.347349</td>
      <td>0.264257</td>
      <td>0.188414</td>
      <td>0.089814</td>
      <td>...</td>
      <td>-1.483004</td>
      <td>-1.350170</td>
      <td>-0.899654</td>
      <td>-0.532868</td>
      <td>-1.030893</td>
      <td>-1.425108</td>
      <td>-1.010761</td>
      <td>-0.971115</td>
      <td>-1.318429</td>
      <td>-1.387153</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.137383</td>
      <td>-0.538417</td>
      <td>-0.645877</td>
      <td>-1.044061</td>
      <td>-0.810797</td>
      <td>-1.218967</td>
      <td>-1.206834</td>
      <td>-1.192149</td>
      <td>-0.807588</td>
      <td>-0.358597</td>
      <td>...</td>
      <td>-1.163015</td>
      <td>-0.750262</td>
      <td>-1.032231</td>
      <td>-1.439325</td>
      <td>-1.146134</td>
      <td>-1.643077</td>
      <td>-1.988083</td>
      <td>-2.216394</td>
      <td>-2.110567</td>
      <td>-2.584084</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.393035</td>
      <td>0.216034</td>
      <td>-0.005888</td>
      <td>-0.148814</td>
      <td>0.212773</td>
      <td>0.184867</td>
      <td>-0.131010</td>
      <td>-0.050478</td>
      <td>0.256011</td>
      <td>-0.159837</td>
      <td>...</td>
      <td>-1.605885</td>
      <td>-1.341053</td>
      <td>-1.263366</td>
      <td>-1.059418</td>
      <td>-1.166027</td>
      <td>-1.308037</td>
      <td>-1.528426</td>
      <td>-1.445772</td>
      <td>-1.104624</td>
      <td>-0.794474</td>
    </tr>
    <tr>
      <th>target</th>
      <td>0.109352</td>
      <td>-0.143035</td>
      <td>-0.628930</td>
      <td>-0.609610</td>
      <td>-1.098891</td>
      <td>-1.466923</td>
      <td>-1.727404</td>
      <td>-2.153768</td>
      <td>-2.527479</td>
      <td>-2.767420</td>
      <td>...</td>
      <td>-1.476767</td>
      <td>-1.170114</td>
      <td>-0.678455</td>
      <td>-0.296051</td>
      <td>-0.700232</td>
      <td>-0.782839</td>
      <td>-1.267469</td>
      <td>-1.184778</td>
      <td>-1.394744</td>
      <td>-1.533743</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>0.112758</td>
      <td>-0.309733</td>
      <td>-0.186195</td>
      <td>-0.288413</td>
      <td>-0.427534</td>
      <td>-0.227850</td>
      <td>0.052525</td>
      <td>-0.123521</td>
      <td>-0.415011</td>
      <td>-0.641198</td>
      <td>...</td>
      <td>-1.535410</td>
      <td>-1.905045</td>
      <td>-1.999587</td>
      <td>-2.031057</td>
      <td>-2.372547</td>
      <td>-2.777203</td>
      <td>-2.818233</td>
      <td>-2.673986</td>
      <td>-2.976074</td>
      <td>-2.536163</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.337576</td>
      <td>-0.419777</td>
      <td>-0.567859</td>
      <td>-0.395375</td>
      <td>-0.816669</td>
      <td>-0.432236</td>
      <td>-0.212436</td>
      <td>-0.712302</td>
      <td>-0.935715</td>
      <td>-0.841333</td>
      <td>...</td>
      <td>4.030538</td>
      <td>3.921029</td>
      <td>3.899370</td>
      <td>4.371014</td>
      <td>4.220388</td>
      <td>3.986258</td>
      <td>4.359879</td>
      <td>4.461693</td>
      <td>4.202821</td>
      <td>4.266627</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>0.196198</td>
      <td>0.470196</td>
      <td>0.717621</td>
      <td>0.805684</td>
      <td>0.883236</td>
      <td>0.697620</td>
      <td>0.281361</td>
      <td>-0.110195</td>
      <td>-0.326950</td>
      <td>-0.028837</td>
      <td>...</td>
      <td>-0.519398</td>
      <td>-0.743676</td>
      <td>-0.520487</td>
      <td>-0.963134</td>
      <td>-1.292777</td>
      <td>-1.280070</td>
      <td>-0.914655</td>
      <td>-1.067960</td>
      <td>-1.036791</td>
      <td>-1.052033</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>-0.297884</td>
      <td>0.167907</td>
      <td>0.220667</td>
      <td>0.269056</td>
      <td>0.331544</td>
      <td>0.428455</td>
      <td>0.455631</td>
      <td>0.609527</td>
      <td>0.940128</td>
      <td>0.525665</td>
      <td>...</td>
      <td>0.517853</td>
      <td>0.579000</td>
      <td>0.714431</td>
      <td>1.033415</td>
      <td>1.419698</td>
      <td>1.740224</td>
      <td>1.596505</td>
      <td>1.650479</td>
      <td>2.063619</td>
      <td>2.438834</td>
    </tr>
    <tr>
      <th>target</th>
      <td>-0.305357</td>
      <td>-0.714273</td>
      <td>-0.723915</td>
      <td>-0.655996</td>
      <td>-0.287311</td>
      <td>-0.311166</td>
      <td>0.183982</td>
      <td>-0.051158</td>
      <td>0.384636</td>
      <td>0.765822</td>
      <td>...</td>
      <td>4.353908</td>
      <td>4.475685</td>
      <td>4.146845</td>
      <td>4.551948</td>
      <td>5.008868</td>
      <td>5.473696</td>
      <td>5.870941</td>
      <td>5.887056</td>
      <td>6.245316</td>
      <td>6.630855</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(20, 4, 5) (20,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TrainValidTestSplitter</span><span class="p">(</span><span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.398706</td>
      <td>0.235978</td>
      <td>0.088917</td>
      <td>-0.483964</td>
      <td>-0.423318</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.099083</td>
      <td>0.181341</td>
      <td>-0.097725</td>
      <td>-0.579473</td>
      <td>-0.333872</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.160938</td>
      <td>0.624532</td>
      <td>-0.213207</td>
      <td>-0.448655</td>
      <td>-0.801993</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.201668</td>
      <td>0.808162</td>
      <td>-0.605807</td>
      <td>-0.090569</td>
      <td>-0.309823</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.612911</td>
      <td>0.828442</td>
      <td>-0.639412</td>
      <td>-0.155014</td>
      <td>-0.753877</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>4.566985</td>
      <td>1.421045</td>
      <td>-2.461289</td>
      <td>-3.669134</td>
      <td>-6.811319</td>
    </tr>
    <tr>
      <th>96</th>
      <td>4.829195</td>
      <td>1.102888</td>
      <td>-2.526298</td>
      <td>-3.877212</td>
      <td>-7.278729</td>
    </tr>
    <tr>
      <th>97</th>
      <td>4.829628</td>
      <td>1.487792</td>
      <td>-2.370272</td>
      <td>-3.402273</td>
      <td>-6.983872</td>
    </tr>
    <tr>
      <th>98</th>
      <td>4.930263</td>
      <td>1.737293</td>
      <td>-2.400428</td>
      <td>-3.818022</td>
      <td>-6.555862</td>
    </tr>
    <tr>
      <th>99</th>
      <td>5.405161</td>
      <td>1.395655</td>
      <td>-2.884282</td>
      <td>-3.894424</td>
      <td>-6.614394</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((96, 4, 5),
 (96,),
 ((#77) [0,1,2,3,4,5,6,7,8,9...], (#19) [77,78,79,80,81,82,83,84,85,86...]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindowPanel" class="doc_header"><code>SlidingWindowPanel</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L200" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindowPanel</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>unique_id_cols</code></strong>:<code>list</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>return_key</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a pd.DataFrame.</p>
<p>Args:
    window_len      = length of lookback window
    unique_id_cols  = pd.DataFrame columns that will be used to identify a time series for each entity.
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y
return_key      = when True, the key corresponsing to unique_id_cols for each sample is returned


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var_0&#39;</span><span class="p">,</span> <span class="s1">&#39;var_1&#39;</span><span class="p">,</span> <span class="s1">&#39;var_2&#39;</span><span class="p">,</span> <span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>var_4</th>
      <th>var_5</th>
      <th>var_6</th>
      <th>var_7</th>
      <th>var_8</th>
      <th>var_9</th>
      <th>time</th>
      <th>device</th>
      <th>target</th>
      <th>region</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>44371</td>
      <td>443692</td>
      <td>4436902</td>
      <td>44369000</td>
      <td>443690000</td>
      <td>4436900000</td>
      <td>44369000000</td>
      <td>443690000000</td>
      <td>4436900000000</td>
      <td>44369000000000</td>
      <td>44369</td>
      <td>2</td>
      <td>2</td>
      <td>B</td>
      <td>144373</td>
    </tr>
    <tr>
      <th>1</th>
      <td>82812</td>
      <td>828102</td>
      <td>8281002</td>
      <td>82810000</td>
      <td>828100000</td>
      <td>8281000000</td>
      <td>82810000000</td>
      <td>828100000000</td>
      <td>8281000000000</td>
      <td>82810000000000</td>
      <td>82810</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>182814</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13429</td>
      <td>134290</td>
      <td>1342900</td>
      <td>13429000</td>
      <td>134290000</td>
      <td>1342900000</td>
      <td>13429000000</td>
      <td>134290000000</td>
      <td>1342900000000</td>
      <td>13429000000000</td>
      <td>13429</td>
      <td>0</td>
      <td>0</td>
      <td>A</td>
      <td>13429</td>
    </tr>
    <tr>
      <th>3</th>
      <td>56008</td>
      <td>560062</td>
      <td>5600602</td>
      <td>56006000</td>
      <td>560060000</td>
      <td>5600600000</td>
      <td>56006000000</td>
      <td>560060000000</td>
      <td>5600600000000</td>
      <td>56006000000000</td>
      <td>56006</td>
      <td>2</td>
      <td>2</td>
      <td>B</td>
      <td>156010</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3316</td>
      <td>33142</td>
      <td>331402</td>
      <td>3314000</td>
      <td>33140000</td>
      <td>331400000</td>
      <td>3314000000</td>
      <td>33140000000</td>
      <td>331400000000</td>
      <td>3314000000000</td>
      <td>3314</td>
      <td>2</td>
      <td>2</td>
      <td>B</td>
      <td>103318</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(200004, 15)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                               <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_max</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">y_func</span><span class="o">=</span><span class="n">y_max</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199982, 10, 5), (199982,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

